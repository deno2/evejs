!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("amqp")):"function"==typeof define&&define.amd?define(["amqp"],e):"object"==typeof exports?exports.eve=e(require("amqp")):t.eve=e(t.amqp)}(this,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){e.Agent=n(1),e.ServiceManager=n(2),e.TransportManager=n(3),e.module={BabbleModule:n(5),PatternModule:n(6),RequestModule:n(7),RPCModule:n(8)},e.transport={Transport:n(9),AMQPTransport:n(11),DistribusTransport:n(13),HTTPTransport:n(15),LocalTransport:n(17),PubNubTransport:n(19),WebSocketTransport:n(21),connection:{Connection:n(10),AMQPConnection:n(12),DistribusConnection:n(14),HTTPConnection:n(16),LocalConnection:n(18),PubNubConnection:n(20),WebSocketConnection:n(22)}},e.hypertimer=n(24),e.util=n(4),e.Agent.registerModule(e.module.BabbleModule),e.Agent.registerModule(e.module.PatternModule),e.Agent.registerModule(e.module.RequestModule),e.Agent.registerModule(e.module.RPCModule),e.TransportManager.registerType(e.transport.AMQPTransport),e.TransportManager.registerType(e.transport.DistribusTransport),e.TransportManager.registerType(e.transport.HTTPTransport),e.TransportManager.registerType(e.transport.LocalTransport),e.TransportManager.registerType(e.transport.PubNubTransport),e.TransportManager.registerType(e.transport.WebSocketTransport),e.system=new e.ServiceManager,e.system.transports.add(new e.transport.LocalTransport),e.Agent.getTransportById=function(t){return e.system.transports.get(t)}},function(t,e,n){"use strict";function r(t){this.id=t?t.toString():s(),this.connections=[],this.defaultConnection=null,this.ready=o.resolve([])}function i(t){var e=r.modules[t];if(!e)throw new Error('Unknown module "'+t+'". Choose from: '+Object.keys(r.modules).map(JSON.stringify).join(", "));return e}var o=n(26),s=n(25),a=n(4);r.modules={},r.registerModule=function(t){var e=t.prototype.type;if("function"!=typeof t)throw new Error("Constructor function expected");if(!e)throw new Error('Field "prototype.type" missing in transport constructor');if(e in r.modules&&r.modules[e]!==t)throw new Error('Module of type "'+e+'" already exists');r.modules[e]=t},r.getTransportById=function(t){throw new Error('Transport with id "'+t+'" not found')},r.prototype.extend=function(t,e){if(Array.isArray(t)){var n=[].concat(t);n.sort(function(t,e){return"pattern"==t?-1:"pattern"==e?1:0});for(var r=0;r<n.length;r++)this.extend(n[r],e)}else{var o=i(t),s=new o(this,e),a=s.mixin(),c=this;Object.keys(a).forEach(function(t){if(void 0!==c[t]&&"_receive"!==t)throw new Error('Conflict: agent already has a property "'+prop+'"')}),Object.keys(a).forEach(function(t){c[t]=a[t]})}return this},r.prototype.loadModule=function(t,e){var n=void 0!==e?Object.create(e):{};n.extend=!1;var r=i(t),o=new r(this,e),s=o.mixin();return this._receive=s._receive,o},r.prototype.send=function(t,e){var n=t.indexOf("://");if(-1!==n){var r=a.parseUrl(t);return"http"==r.protocol||"ws"==r.protocol||"https"==r.protocol?this._sendByProtocol(r.protocol,t,e):this._sendByNetworkId(r.domain,r.path,e)}var i=t.indexOf("@");if(-1!=i){var s=t.substring(0,i),c=t.substring(i+1);return this._sendByTransportId(c,s,e)}var u=this.defaultConnection;return u?u.send(t,e):o.reject(new Error("No transport found"))},r.prototype._sendByNetworkId=function(t,e,n){for(var r=0;r<this.connections.length;r++){var i=this.connections[r];if(i.transport.networkId==t)return i.send(e,n)}return o.reject(new Error('No transport found with networkId "'+t+'"'))},r.prototype._sendByProtocol=function(t,e,n){for(var r=0;r<this.connections.length;r++){var i=this.connections[r];if(i.transport.type==t)return i.send(e,n)}return o.reject(new Error('No transport found for protocol "'+t+'"'))},r.prototype._sendByTransportId=function(t,e,n){for(var r=0;r<this.connections.length;r++){var i=this.connections[r];if(i.transport.id==t)return i.send(e,n)}return o.reject(new Error('No transport found with id "'+t+'"'))},r.prototype.receive=function(){},r.prototype._receive=function(t,e){return this.receive(t,e)},r.prototype.connect=function(t,e){if(Array.isArray(t)){var n=this;return t.map(function(t){return n._connect(t,e)})}return"string"==typeof t?this._connect(r.getTransportById(t),e):this._connect(t,e)},r.prototype._connect=function(t,e){var n=this,r=function(t,e){return n._receive(t,e)},i=t.connect(e||this.id,r);if(this.connections.push(i),this.defaultConnection){if(t["default"]){if(this.defaultConnection["default"])throw new Error("Cannot connect to a second default transport");this.defaultConnection=i}}else this.defaultConnection=i;return this._updateReady(),i},r.prototype.disconnect=function(t){var e,n;if(t){if(Array.isArray(t))for(e=0;e<this.connections.length;)n=this.connections[e],-1!==t.indexOf(n.transport)?this._disconnect(n):e++;else if("string"==typeof t)this.disconnect(r.getTransportById(t));else for(e=0;e<this.connections.length;e++)if(n=this.connections[e],n.transport===t){this._disconnect(n);break}}else for(;n=this.connections[0];)this._disconnect(n)},r.prototype._disconnect=function(t){var e=this.connections.indexOf(t);-1!==e&&(t.close(),this.connections.splice(e,1),this.defaultConnection===t&&(this.defaultConnection=this.connections[this.connections.length-1]||null)),this._updateReady()},r.prototype._updateReady=function(){this.ready=o.all(this.connections.map(function(t){return t.ready}))},t.exports=r},function(t,e,n){"use strict";function r(t){this.transports=new s,this.timer=o(),this.random=Math.random,this.init(t)}var i=n(27),o=n(24),s=n(3),a={transports:!0,timer:!0,random:!0};r.prototype.init=function(t){if(this.transports.clear(),t){if(t.transports&&this.transports.load(t.transports),t.timer&&this.timer.config(t.timer),t.random)if(t.random.deterministic){var e=t.random.seed||"random seed";this.random=i(e,t.random)}else this.random=Math.random;for(var n in t)t.hasOwnProperty(n)&&!a[n]&&console.log('WARNING: Unknown configuration option "'+n+'"')}},r.prototype.clear=function(){this.transports.clear()},t.exports=r},function(t){"use strict";function e(t){this.transports=[],t&&this.load(t)}e.types={},e.registerType=function(t){var n=t.prototype.type;if("function"!=typeof t)throw new Error("Constructor function expected");if(!n)throw new Error('Field "prototype.type" missing in transport constructor');if(n in e.types&&e.types[n]!==t)throw new Error('Transport type "'+n+'" already exists');e.types[n]=t},e.prototype.add=function(t){return this.transports.push(t),t},e.prototype.load=function(t){if(Array.isArray(t))return t.map(this.load.bind(this));var n=t.type;if(!n)throw new Error('Property "type" missing');var r=e.types[n];if(!r)throw new Error('Unknown type of transport "'+n+'". Choose from: '+Object.keys(e.types).join(","));var i=new r(t);return this.transports.push(i),i},e.prototype.unload=function(t){var e;if("string"==typeof t)e=this.get(t);else if(Array.isArray(t))for(var n=0;n<t.length;n++)this.unload(t[n]);else e=t;if(e){e.close();var r=this.transports.indexOf(e);-1!==r&&this.transports.splice(r,1)}},e.prototype.get=function(t){for(var e=0;e<this.transports.length;e++){var n=this.transports[e];if(n.id===t)return n}throw new Error('Transport with id "'+t+'" not found')},e.prototype.getAll=function(){return this.transports.concat([])},e.prototype.getByType=function(t){if(t){if(!(t in e.types))throw new Error('Unknown type of transport "'+t+'". Choose from: '+Object.keys(e.types).join(","));return this.transports.filter(function(e){return e.type===t})}return[].concat(this.transports)},e.prototype.clear=function(){this.transports.forEach(function(t){t.close()}),this.transports=[]},t.exports=e},function(t,e){"use strict";e.isPromise=function(t){return t&&"function"==typeof t.then&&"function"==typeof t["catch"]},e.parseUrl=function(t){var e=/^([A-z]+):\/\/([^\/]+)(\/(.*)$|$)/.exec(t);return e?{protocol:e[1],domain:e[2],path:e[4]}:null},e.normalizeURL=function(t){return"/"==t[t.length-1]?t.substring(0,t.length-1):t}},function(t,e,n){"use strict";function r(t){var e=i.babbler(t.id);e.connect({connect:function(){},disconnect:function(){},send:function(e,n){t.send(e,n)}}),this.babbler=e;var n=t._receive;this._receive=function(r,i){return e._receive(i),n.call(t,r,i)}}var i=n(30);r.prototype.type="babble",r.prototype.mixin=function(){var t=this.babbler;return{_receive:this._receive,ask:t.ask.bind(t),tell:t.tell.bind(t),listen:t.listen.bind(t),listenOnce:t.listenOnce.bind(t)}},t.exports=r},function(t){"use strict";function e(t,e){this.agent=t,this.stopPropagation=e&&e.stopPropagation||!1,this.receiveOriginal=t._receive,this.listeners=[]}e.prototype.type="pattern",e.prototype.receive=function(t,e){for(var n,r=[],i=0,o=this.listeners.length;o>i;i++){var s=this.listeners[i],a=s.pattern,c=a instanceof Function&&a(e)||a instanceof RegExp&&a.test(e)||a==e;if(c&&(n=s.callback.call(this.agent,t,e),r.push(n),this.stopPropagation))return r[0]}return n=this.receiveOriginal.call(this.agent,t,e),r.push(n),r[0]},e.prototype.listen=function(t,e){this.listeners.push({pattern:t,callback:e})},e.prototype.unlisten=function(t,e){for(var n=0,r=this.listeners.length;r>n;n++){var i=this.listeners[n];if(i.pattern===t&&i.callback===e){this.listeners.splice(n,1);break}}},e.prototype.mixin=function(){return{_receive:this.receive.bind(this),listen:this.listen.bind(this),unlisten:this.unlisten.bind(this)}},t.exports=e},function(t,e,n){"use strict";function r(t,e){this.agent=t,this.receiveOriginal=t._receive,this.timeout=e&&e.timeout||a,this.queue=[]}var i=n(25),o=n(26),s=n(4),a=6e4;r.prototype.type="request",r.prototype.receive=function(t,e){var n=this.agent;if("object"==typeof e){var r=e,i=this.queue[r.id];if(i)return clearTimeout(i.timeout),delete this.queue[r.id],r.error?i.reject(new Error(r.error)):i.resolve(r.message),!0;if("request"==e.type)try{var o=this.receiveOriginal.call(n,t,e.message);s.isPromise(o)?o.then(function(r){n.send(t,{type:"request",id:e.id,message:r})}).catch(function(r){n.send(t,{type:"request",id:e.id,error:r.message||r.toString()})}):n.send(t,{type:"request",id:e.id,message:o})}catch(a){n.send(t,{type:"request",id:e.id,error:a.message||a.toString()})}}else this.receiveOriginal&&this.receiveOriginal.call(n,t,e)},r.prototype.request=function(t,e){var n=this;return new o(function(r,o){var s=i(),a={type:"request",id:s,message:e};n.queue[s]={resolve:r,reject:o,timeout:setTimeout(function(){delete n.queue[s],o(new Error("Timeout"))},n.timeout)},n.agent.send(t,a).catch(function(t){o(t)})})},r.prototype.mixin=function(){return{_receive:this.receive.bind(this),request:this.request.bind(this)}},t.exports=r},function(t,e,n){"use strict";function r(t,e){this.agent=t,this.receiveOriginal=t._receive,this.queue={},this.promiseTimeout=1500,e instanceof Array?this.functionsFromArray(e):e instanceof Object?this.availableFunctions=e:console.log("cannot use RPC with the supplied functions",e)}var i=n(25),o=n(26),s=n(4);r.prototype.type="rpc",r.prototype.functionsFromArray=function(t){this.availableFunctions={};for(var e=0;e<t.length;e++){var n=t[e];this.availableFunctions[n]=this.agent[n]}},r.prototype.request=function(t,e){var n=this;return new o(function(r,o){"object"!=typeof e&&o(new TypeError("Message must be an object")),"2.0"!==e.jsonrpc&&(e.jsonrpc="2.0"),void 0===e.id&&(e.id=i()),void 0===e.method&&o(new Error('Property "method" expected')),void 0===e.params&&(e.params={}),n.queue[e.id]={resolve:r,reject:o,timeout:setTimeout(function(){delete n.queue[e.id],o("Timeout")},n.promiseTimeout)};var a=n.agent.send(t,e);1==s.isPromise(a)&&a.catch(function(t){o(t)})})},r.prototype.receive=function(t,e){"object"==typeof e&&"2.0"==e.jsonrpc?this._receive(t,e):this.receiveOriginal.call(this.agent,t,e)},r.prototype._receive=function(t,e){var n={jsonrpc:"2.0",id:e.id};if(void 0!==e.method){var r=this.availableFunctions[e.method];if(void 0!==r){var i=r.call(this.agent,e.params,t)||null;if(s.isPromise(i)){var o=this;i.then(function(e){n.result=e,o.agent.send(t,n)}).catch(function(e){n.error=e.message||e.toString(),o.agent.send(t,n)})}else n.result=i,this.agent.send(t,n)}else{var a=new Error("Cannot find function: "+e.method);n.error=a.message||a.toString(),this.agent.send(t,n)}}else if(void 0!==e.result||void 0!==e.error){var c=this.queue[e.id];void 0!==c&&(void 0!=e.error?c.reject(e.error):c.resolve(e.result))}else{var a=new Error("No method or result defined. Message:"+JSON.stringify(e));n.error=a.message||a.toString(),this.agent.send(t,n)}},r.prototype.mixin=function(){return{_receive:this.receive.bind(this),request:this.request.bind(this)}},t.exports=r},function(t){"use strict";function e(t){this.id=t&&t.id||null,this["default"]=t&&t["default"]||!1}e.prototype.type=null,e.prototype.connect=function(){throw new Error('Cannot invoke abstract function "connect"')},e.prototype.close=function(){throw new Error('Cannot invoke abstract function "close"')},t.exports=e},function(t,e,n){"use strict";function r(){throw new Error("Cannot create an abstract Connection")}var i=n(26);r.prototype.ready=i.reject(new Error("Cannot get abstract property ready")),r.prototype.send=function(){throw new Error("Cannot call abstract function send")},r.prototype.close=function(){throw new Error('Cannot call abstract function "close"')},t.exports=r},function(t,e,n){"use strict";function r(t){this.id=t.id||null,this.networkId=t.url||t.host||null,this["default"]=t["default"]||!1,this.config=t,this.connection=null,this.exchange=null,this.subscriptions=[]}var i=n(26),o=n(9),s=n(12);r.prototype=new o,r.prototype.type="amqp",r.prototype.connect=function(t,e){return new s(this,t,e)},r.prototype._getConnection=function(t){var e=this;if(this.connection)t(this.connection);else if(this._onConnected)this._onConnected.push(t);else{this._onConnected=[t];var r=n(23),i=r.createConnection(this.config);i.on("ready",function(){var t=i.exchange("",{confirm:!0},function(){var n=e._onConnected;delete e._onConnected,e.connection=i,e.exchange=t,n.forEach(function(t){t(e.connection)})})})}},r.prototype._connect=function(t,e){var n=this;return new i(function(r){function i(i){var o=i.queue(t,{},function(){o.subscribe(function(t){var n=t.body;e(n.from,n.message)}).addCallback(function(e){n.subscriptions.push({id:t,consumerTag:e.consumerTag}),r(n)})})}n._getConnection(i)})},r.prototype._close=function(t){for(var e=0;e<this.subscriptions.length;){var n=this.subscriptions[e];n.id==t?this.subscriptions.splice(e,1):e++}0==this.subscriptions.length&&(this.exchange.destroy(),this.connection.disconnect(),this.connection=null,this.exchange=null)},r.prototype.close=function(){this.connection.destroy(),this.connection=null},t.exports=r},function(t,e,n){"use strict";function r(t,e,n){this.transport=t,this.id=e,this.ready=this.transport._connect(e,n)}{var i=n(26);n(10)}r.prototype.send=function(t,e){var n=this;return new i(function(r){var i={body:{from:n.id,to:t,message:e}},o={};n.transport.exchange.publish(t,i,o,function(){}),r()})},r.prototype.close=function(){this.transport._close(this.id)},t.exports=r},function(t,e,n){"use strict";function r(t){this.id=t&&t.id||null,this["default"]=t&&t["default"]||!1,this.host=t&&t.host||new i.Host(t),this.networkId=this.host.networkId}var i=n(29),o=n(9),s=n(14);r.prototype=new o,r.prototype.type="distribus",r.prototype.connect=function(t,e){return new s(this,t,e)},r.prototype.close=function(){this.host.close(),this.host=null},t.exports=r},function(t,e,n){"use strict";function r(t,e,n){this.transport=t,this.id=e;var r=this.transport.host.create(e);r.on("message",n),this.ready=i.resolve(this)}{var i=n(26);n(10)}r.prototype.send=function(t,e){return this.transport.host.send(this.id,t,e)},r.prototype.close=function(){this.transport.host.remove(this.id)},t.exports=r},function(t,e,n){"use strict";function r(t){this.id=t&&t.id||null,this.networkId=null,this.agents={},this.outstandingRequests={},this.outstandingMessages={},this.url=t&&t.url||"http://127.0.0.1:3000/agents/:id",this.remoteUrl=t&&t.remoteUrl,this.localShortcut=t&&t.localShortcut===!1?!1:!0,this.httpTimeout=t&&t.httpTimeout||2e3,this.httpResponseTimeout=t&&t.httpResponseTimeout||200,this.regexHosts=/[http]{4}s?:\/\/([a-z\-\.A-Z0-9]*):?([0-9]*)(\/[a-z\/:A-Z0-9._\-% \\\(\)\*\+\.\^\$]*)/,this.urlHostData=this.regexHosts.exec(this.url),this.regexPath=this.getRegEx(this.urlHostData[3]),this.port=t&&t.port||this.urlHostData[2]||3e3,this.path=this.urlHostData[3].replace(":id",""),"undefined"!=typeof window&&(this.send=this.webSend)}var i=n(31),o=n(26),s=n(9),a=n(16),c=n(25);r.prototype=new s,r.prototype.type="http",r.prototype.getRegEx=function(t){return new RegExp(t.replace(/[\\\(\)\*\+\.\^\$]/g,function(t){return"\\"+t}).replace(":id","([:a-zA-Z_0-9]*)"))},r.prototype.connect=function(t,e){return void 0===this.server&&"undefined"==typeof window&&this.initiateServer(),this.outstandingRequests[t]={},this.outstandingMessages[t]={},new a(this,t,e)},r.prototype.send=function(t,e,n){var r=this;return new o(function(o,s){var a=r.regexHosts.exec(e),u=r.regexPath.exec(t),h=u[1],f=c();if(1==r.localShortcut){var l=r.regexPath.exec(e),p=l[1],d=a[3].replace(p,"");if(("127.0.0.1"==a[1]&&a[2]==r.urlHostData[2]&&d==r.path||r.urlHostData[1]==a[1]&&a[2]==r.urlHostData[2]&&d==r.path)&&void 0!==r.agents[p])return r.agents[p](h,n),void o()}if("object"==typeof n){var v=r.outstandingRequests[h];if(void 0!==v[n.id]){var y=v[n.id];return y.response.end(JSON.stringify(n)),clearTimeout(y.timeout),delete v[n.id],void o()}n=JSON.stringify(n)}var g={host:a[1],port:a[2],path:a[3],method:"POST",headers:{"x-eve-senderurl":t,"Content-type":"text/plain"}},m=i.request(g,function(t){t.setEncoding("utf8"),clearTimeout(r.outstandingMessages[h][f].timeout),t.on("data",function(t){var n;try{n=JSON.parse(t)}catch(i){n=t}return"object"==typeof n&&void 0!==n.__httpError__?void s(new Error(n.__httpError__)):(r.agents[h](e,n),void o())})});r.outstandingMessages[h][f]={timeout:setTimeout(function(){m.abort(),s(new Error("Cannot connect to "+e))},r.httpTimeout),reject:s},m.on("error",function(t){s(t)}),m.write(n),m.end()})},r.prototype.webSend=function(t,e,n){var r=this;return new o(function(i,o){"object"==typeof n&&(n=JSON.stringify(n));var s=r.regexPath.exec(t),a=s[1],c=new XMLHttpRequest;c.onreadystatechange=function(){if(4==c.readyState&&200==c.status){var t="";c.responseText.length>0&&(t=JSON.parse(c.responseText)),r.agents[a](e,t),i()}else 4==c.readyState&&o(new Error("http.status:"+c.status))},c.open("POST",e,!0),c.setRequestHeader("Content-Type","text/plain"),c.send(n)})},r.prototype.processRequest=function(t,e){var n=t.url,r={};r["Access-Control-Allow-Origin"]="*",r["Access-Control-Allow-Credentials"]=!0,r["Content-Type"]="text/plain";var i=this.regexPath.exec(n);if(null!==i){var o=i[1],s="unknown";void 0!==t.headers["x-eve-senderurl"]&&(s=t.headers["x-eve-senderurl"]);var a="";t.on("data",function(e){a+=e,a.length>1e6&&t.connection.destroy()});var c=this;t.on("end",function(){var t,n=!1;try{t=JSON.parse(a)}catch(i){t=a}n=t.jsonrpc&&"2.0"==t.jsonrpc||n,n=t.type&&"request"==t.type||n,e.writeHead(200,r);var u=c.agents[o];if(void 0===u){var h=new Error('Agent: "'+o+'" does not exist.');e.end(JSON.stringify({__httpError__:h.message||h.toString()}))}else 1==n?(c.outstandingRequests[o][t.id]={response:e,timeout:setTimeout(function(){e.end("timeout"),delete c.outstandingRequests[o][t.id]},c.httpResponseTimeout)},u(s,t)):(e.end(""),void 0!==u&&u(s,t))})}},r.prototype.initiateServer=function(){if(void 0===this.server){var t=this;this.server=i.createServer(function(e,n){if("OPTIONS"==e.method){var r={};r["Access-Control-Allow-Origin"]="*",r["Access-Control-Allow-Methods"]="POST, OPTIONS",r["Access-Control-Allow-Credentials"]=!0,r["Access-Control-Max-Age"]="86400",r["Access-Control-Allow-Headers"]="X-Requested-With, Access-Control-Allow-Origin, X-HTTP-Method-Override, Content-Type, Authorization, Accept",n.writeHead(200,r),n.end()}else"POST"==e.method&&t.processRequest(e,n)}),this.server.on("error",function(e){throw new Error("EADDRINUSE"==e.code?"ERROR: Could not start HTTP server. Port "+t.port+" is occupied.":e)}),this.server.listen(this.port,function(){console.log("Server listening at ",t.url)})}else this.server.close(),this.server=void 0,this.initiateServer()},r.prototype.close=function(){for(var t in this.outstandingRequests)if(this.outstandingRequests.hasOwnProperty(t)){var e=this.outstandingRequests[t];for(var n in e)if(e.hasOwnProperty(n)){var r=e[n],i=new Error("Server shutting down.");r.response.end(JSON.stringify({__httpError__:i.message||i.toString()}))}}this.server&&this.server.close(),this.server=null},t.exports=r},function(t,e,n){"use strict";function r(t,e,n){if(this.transport=t,this.id=e,this.id in this.transport.agents)throw new Error("Agent with id "+e+" already exists");this.transport.agents[this.id]=n,this.ready=i.resolve(this)}{var i=n(26);n(10)}r.prototype.send=function(t,e){var n,r=this.transport.url.replace(":id",this.id),i=-1!==t.indexOf("://");return i?n=t:void 0!==this.transport.remoteUrl?n=this.transport.remoteUrl.replace(":id",t):console.log("ERROR: no remote URL specified. Cannot send over HTTP.",t),this.transport.send(r,n,e)},r.prototype.close=function(){delete this.transport.agents[this.id]},t.exports=r},function(t,e,n){"use strict";function r(t){this.id=t&&t.id||null,this.networkId=this.id||null,this["default"]=t&&t["default"]||!1,this.agents={}}var i=n(9),o=n(18);r.prototype=new i,r.prototype.type="local",r.prototype.connect=function(t,e){return new o(this,t,e)},r.prototype.close=function(){this.agents={}},t.exports=r},function(t,e,n){"use strict";function r(t,e,n){if(this.transport=t,this.id=e,this.id in this.transport.agents)throw new Error("Agent with id "+e+" already exists");this.transport.agents[this.id]=n,this.ready=i.resolve(this)}{var i=n(26);n(10)}r.prototype.send=function(t,e){var n=this.transport.agents[t];if(!n)throw new Error("Agent with id "+t+" not found");return n(this.id,e),i.resolve()},r.prototype.close=function(){delete this.transport.agents[this.id]},t.exports=r},function(t,e,n){"use strict";function r(t){this.id=t.id||null,this.networkId=t.publish_key||null,this["default"]=t["default"]||!1,this.pubnub=i().init(t)}function i(){if("undefined"!=typeof window){if("undefined"==typeof window.PUBNUB)throw new Error("Please load pubnub first in the browser");return window.PUBNUB}return n(33)}var o=n(9),s=n(20);r.prototype=new o,r.prototype.type="pubnub",r.prototype.connect=function(t,e){return new s(this,t,e)},r.prototype.close=function(){this.pubnub=null},t.exports=r},function(t,e,n){"use strict";function r(t,e,n){this.id=e,this.transport=t;var r=this;this.ready=new i(function(i){t.pubnub.subscribe({channel:e,message:function(t){n(t.from,t.message)},connect:function(){i(r)}})})}{var i=n(26);n(10)}r.prototype.send=function(t,e){var n=this;return new i(function(r,i){n.transport.pubnub.publish({channel:t,message:{from:n.id,to:t,message:e},callback:r,error:i})})},r.prototype.close=function(){this.transport.pubnub.unsubscribe({channel:this.id})},t.exports=r},function(t,e,n){"use strict";function r(t){if(this.id=t&&t.id||null,this.networkId=this.id||null,this["default"]=t&&t["default"]||!1,this.localShortcut=t&&t.localShortcut===!1?!1:!0,this.reconnectDelay=t&&t.reconnectDelay||1e4,this.url=t&&t.url||null,this.server=null,null!=this.url){var e=i.parse(this.url);if("ws:"!=e.protocol)throw new Error('Invalid protocol, "ws:" expected');if(-1==this.url.indexOf(":id"))throw new Error('":id" placeholder missing in url');this.address=e.protocol+"//"+e.host,this.ready=this._initServer(this.url)}else this.address=null,this.ready=s.resolve(this);this.agents={}}var i=n(28),o=n(25),s=n(26),a=n(32).Server,c=n(4),u=n(9),h=n(22);r.prototype=new u,r.prototype.type="ws",r.prototype.getUrl=function(t){return this.url?this.url.replace(":id",t):null},r.prototype._initServer=function(t){var e=i.parse(t),n=e.port||80,r=this;return new s(function(t,e){r.server=new a({port:n},function(){t(r)}),r.server.on("connection",r._onConnection.bind(r)),r.server.on("error",function(t){e(t)})})},r.prototype._onConnection=function(t){var e=t.upgradeReq.url,n=i.parse(e,!0),r=n.pathname,s=c.normalizeURL(this.address+r),a=n.query,u=a.id||o(),h=this.agents[s];h?h._onConnection(u,t):t.close()},r.prototype.connect=function(t,e){var n=-1!==t.indexOf("://"),r=n?t:this.getUrl(t)||t;if(r&&(r=c.normalizeURL(r)),this.agents[r])throw new Error("Agent with id "+this.id+" already exists");var i=new h(this,r,e);return this.agents[i.url]=i,i},r.prototype.close=function(){for(var t in this.agents)this.agents.hasOwnProperty(t)&&this.agents[t].close();this.agents={},this.server&&this.server.close()},t.exports=r},function(t,e,n){"use strict";function r(t,e,n){this.transport=t,this.url=e?a.normalizeURL(e):i(),this.receive=n,this.sockets={},this.closed=!1,this.reconnectTimers={},this.ready=o.resolve(this)}{var i=n(25),o=n(26),s="undefined"!=typeof window&&"undefined"!=typeof window.WebSocket?window.WebSocket:n(32),a=n(4);n(10)}r.prototype.send=function(t,e){if(this.transport.localShortcut){var n=this.transport.agents[t];if(n)try{return n.receive(this.url,e),o.resolve()}catch(r){return o.reject(r)}}var i=this.sockets[t];if(i)try{if(i.readyState==i.CONNECTING)return new o(function(t){i.onopen.callbacks.push(function(){i.send(JSON.stringify(e)),t()})});if(i.readyState==i.OPEN)return i.send(JSON.stringify(e)),o.resolve();i=null}catch(r){return o.reject(r)}if(!i){var s=this;return new o(function(n,r){s._connect(t,function(t){t.send(JSON.stringify(e)),n()},function(){r(new Error('Failed to connect to agent "'+t+'"'))})})}},r.prototype.connect=function(t){var e=this;return new o(function(n,r){e._connect(t,function(){n(e)},r)})},r.prototype._connect=function(t,e,n,r){var i=this,o=new s(t+"?id="+this.url);return i.sockets[t]=o,o.onopen=function(){r=!0,o.onopen.callbacks.forEach(function(t){t(o)}),o.onopen.callbacks=[]},o.onopen.callbacks=e?[e]:[],o.onmessage=function(e){i.receive(t,JSON.parse(e.data))},o.onclose=function(){delete i.sockets[t],r&&i._reconnect(t)},o.onerror=function(e){delete i.sockets[t],n&&n(e)},o},r.prototype._reconnect=function(t){var e=this,n=!0;0==e.closed&&null==e.reconnectTimers[t]&&(e.reconnectTimers[t]=setTimeout(function(){delete e.reconnectTimers[t],e._connect(t,null,null,n)},e.transport.reconnectDelay))},r.prototype._onConnection=function(t,e){var n=this;return e.onmessage=function(e){n.receive(t,JSON.parse(e.data))},e.onclose=function(){delete n.sockets[t]},e.onerror=function(){delete n.sockets[t]},this.sockets[t]&&this.sockets[t].close(),this.sockets[t]=e,e},r.prototype.list=function(){return Object.keys(this.sockets)},r.prototype.close=function(){this.closed=!0;for(var t in this.sockets)this.sockets.hasOwnProperty(t)&&this.sockets[t].close();this.sockets={},delete this.transport.agents[this.url]},t.exports=r},function(e){e.exports=t},function(t,e,n){t.exports=n(34)},function(t,e){e=t.exports=function(){for(var t,n="",r=0;32>r;r++)t=16*e.random()|0,r>4&&21>r&&!(r%4)&&(n+="-"),n+=(12===r?4:16===r?3&t|8:t).toString(16);return n};var n=/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/;e.isUUID=function(t){return n.test(t)},e.random=function(){return Math.random()}},function(t,e,n){"use strict";t.exports=n(35),n(36),n(38),n(37)},function(t,e){(function(e){"use strict";function n(t){var e,n=t.length,r=this,i=0,o=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);a>i;)s[i]=i++;for(i=0;a>i;i++)s[i]=s[o=v&o+t[i%n]+(e=s[i])],s[o]=e;(r.g=function(t){for(var e,n=0,i=r.i,o=r.j,s=r.S;t--;)e=s[i=v&i+1],n=n*a+s[v&(s[i]=s[o=v&o+e])+(s[o]=e)];return r.i=i,r.j=o,n})(a)}function r(t,e){var n,i=[],o=(typeof t)[0];if(e&&"o"==o)for(n in t)try{i.push(r(t[n],e-1))}catch(s){}return i.length?i:"s"==o?t:t+"\x00"}function i(t,e){for(var n,r=t+"",i=0;i<r.length;)e[v&i]=v&(n^=19*e[v&i])+r.charCodeAt(i++);return s(e)}function o(t){try{return f.crypto.getRandomValues(t=new Uint8Array(a)),s(t)}catch(e){return[+new Date,f,f.navigator&&f.navigator.plugins,f.screen,s(h)]}}function s(t){return String.fromCharCode.apply(0,t)}var a=256,c=6,u=52,h=[],f="undefined"==typeof e?window:e,l=Math.pow(a,c),p=Math.pow(2,u),d=2*p,v=a-1,y=Math.random;t.exports=function(e,u){if(u&&u.global===!0)return u.global=!1,Math.random=t.exports(e,u),u.global=!0,Math.random;var f=u&&u.entropy||!1,v=[],y=(i(r(f?[e,s(h)]:0 in arguments?e:o(),3),v),new n(v));return i(s(y.S),h),function(){for(var t=y.g(c),e=l,n=0;p>t;)t=(t+n)*a,e*=a,n=y.g(1);for(;t>=d;)t/=2,e/=2,n>>>=1;return(t+n)/e}},t.exports.resetGlobal=function(){Math.random=y},i(Math.random(),h)}).call(e,function(){return this}())},function(t,e,n){function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function i(t,e,n){if(t&&u(t)&&t instanceof r)return t;var i=new r;return i.parse(t,e,n),i}function o(t){return c(t)&&(t=i(t)),t instanceof r?t.format():r.prototype.format.call(t)}function s(t,e){return i(t,!1,!0).resolve(e)}function a(t,e){return t?i(t,!1,!0).resolveObject(e):e}function c(t){return"string"==typeof t}function u(t){return"object"==typeof t&&null!==t}function h(t){return null===t}function f(t){return null==t}var l=n(61);e.parse=i,e.resolve=s,e.resolveObject=a,e.format=o,e.Url=r;var p=/^([a-z0-9.+-]+:)/i,d=/:[0-9]*$/,v=["<",">",'"',"`"," ","\r","\n","	"],y=["{","}","|","\\","^","`"].concat(v),g=["'"].concat(y),m=["%","/","?",";","#"].concat(g),_=["/","?","#"],b=255,w=/^[a-z0-9A-Z_-]{0,63}$/,k=/^([a-z0-9A-Z_-]{0,63})(.*)$/,x={javascript:!0,"javascript:":!0},E={javascript:!0,"javascript:":!0},S={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},T=n(47);r.prototype.parse=function(t,e,n){if(!c(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var r=t;r=r.trim();var i=p.exec(r);if(i){i=i[0];var o=i.toLowerCase();this.protocol=o,r=r.substr(i.length)}if(n||i||r.match(/^\/\/[^@\/]+@[^@\/]+/)){var s="//"===r.substr(0,2);!s||i&&E[i]||(r=r.substr(2),this.slashes=!0)}if(!E[i]&&(s||i&&!S[i])){for(var a=-1,u=0;u<_.length;u++){var h=r.indexOf(_[u]);-1!==h&&(-1===a||a>h)&&(a=h)}var f,d;d=-1===a?r.lastIndexOf("@"):r.lastIndexOf("@",a),-1!==d&&(f=r.slice(0,d),r=r.slice(d+1),this.auth=decodeURIComponent(f)),a=-1;for(var u=0;u<m.length;u++){var h=r.indexOf(m[u]);-1!==h&&(-1===a||a>h)&&(a=h)}-1===a&&(a=r.length),this.host=r.slice(0,a),r=r.slice(a),this.parseHost(),this.hostname=this.hostname||"";var v="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!v)for(var y=this.hostname.split(/\./),u=0,A=y.length;A>u;u++){var j=y[u];if(j&&!j.match(w)){for(var P="",C=0,O=j.length;O>C;C++)P+=j.charCodeAt(C)>127?"x":j[C];if(!P.match(w)){var R=y.slice(0,u),M=y.slice(u+1),F=j.match(k);F&&(R.push(F[1]),M.unshift(F[2])),M.length&&(r="/"+M.join(".")+r),this.hostname=R.join(".");break}}}if(this.hostname=this.hostname.length>b?"":this.hostname.toLowerCase(),!v){for(var B=this.hostname.split("."),I=[],u=0;u<B.length;++u){var U=B[u];I.push(U.match(/[^A-Za-z0-9_-]/)?"xn--"+l.encode(U):U)}this.hostname=I.join(".")}var N=this.port?":"+this.port:"",L=this.hostname||"";this.host=L+N,this.href+=this.host,v&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==r[0]&&(r="/"+r))}if(!x[o])for(var u=0,A=g.length;A>u;u++){var q=g[u],D=encodeURIComponent(q);D===q&&(D=escape(q)),r=r.split(q).join(D)}var H=r.indexOf("#");-1!==H&&(this.hash=r.substr(H),r=r.slice(0,H));var z=r.indexOf("?");if(-1!==z?(this.search=r.substr(z),this.query=r.substr(z+1),e&&(this.query=T.parse(this.query)),r=r.slice(0,z)):e&&(this.search="",this.query={}),r&&(this.pathname=r),S[o]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var N=this.pathname||"",U=this.search||"";this.path=N+U}return this.href=this.format(),this},r.prototype.format=function(){var t=this.auth||"";
t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,o="";this.host?i=t+this.host:this.hostname&&(i=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&u(this.query)&&Object.keys(this.query).length&&(o=T.stringify(this.query));var s=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||S[e])&&i!==!1?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),n=n.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),s=s.replace("#","%23"),e+i+n+s+r},r.prototype.resolve=function(t){return this.resolveObject(i(t,!1,!0)).format()},r.prototype.resolveObject=function(t){if(c(t)){var e=new r;e.parse(t,!1,!0),t=e}var n=new r;if(Object.keys(this).forEach(function(t){n[t]=this[t]},this),n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol)return Object.keys(t).forEach(function(e){"protocol"!==e&&(n[e]=t[e])}),S[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n;if(t.protocol&&t.protocol!==n.protocol){if(!S[t.protocol])return Object.keys(t).forEach(function(e){n[e]=t[e]}),n.href=n.format(),n;if(n.protocol=t.protocol,t.host||E[t.protocol])n.pathname=t.pathname;else{for(var i=(t.pathname||"").split("/");i.length&&!(t.host=i.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==i[0]&&i.unshift(""),i.length<2&&i.unshift(""),n.pathname=i.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var o=n.pathname||"",s=n.search||"";n.path=o+s}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var a=n.pathname&&"/"===n.pathname.charAt(0),u=t.host||t.pathname&&"/"===t.pathname.charAt(0),l=u||a||n.host&&t.pathname,p=l,d=n.pathname&&n.pathname.split("/")||[],i=t.pathname&&t.pathname.split("/")||[],v=n.protocol&&!S[n.protocol];if(v&&(n.hostname="",n.port=null,n.host&&(""===d[0]?d[0]=n.host:d.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===i[0]?i[0]=t.host:i.unshift(t.host)),t.host=null),l=l&&(""===i[0]||""===d[0])),u)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,d=i;else if(i.length)d||(d=[]),d.pop(),d=d.concat(i),n.search=t.search,n.query=t.query;else if(!f(t.search)){if(v){n.hostname=n.host=d.shift();var y=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;y&&(n.auth=y.shift(),n.host=n.hostname=y.shift())}return n.search=t.search,n.query=t.query,h(n.pathname)&&h(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!d.length)return n.pathname=null,n.path=n.search?"/"+n.search:null,n.href=n.format(),n;for(var g=d.slice(-1)[0],m=(n.host||t.host)&&("."===g||".."===g)||""===g,_=0,b=d.length;b>=0;b--)g=d[b],"."==g?d.splice(b,1):".."===g?(d.splice(b,1),_++):_&&(d.splice(b,1),_--);if(!l&&!p)for(;_--;_)d.unshift("..");!l||""===d[0]||d[0]&&"/"===d[0].charAt(0)||d.unshift(""),m&&"/"!==d.join("/").substr(-1)&&d.push("");var w=""===d[0]||d[0]&&"/"===d[0].charAt(0);if(v){n.hostname=n.host=w?"":d.length?d.shift():"";var y=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;y&&(n.auth=y.shift(),n.host=n.hostname=y.shift())}return l=l||n.host&&d.length,l&&!w&&d.unshift(""),d.length?n.pathname=d.join("/"):(n.pathname=null,n.path=null),h(n.pathname)&&h(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var t=this.host,e=d.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,n){e.Host=n(40),e.Promise=n(39)},function(t,e,n){"use strict";t.exports=n(41)},function(t,e,n){var r=t.exports,i=(n(44).EventEmitter,n(42)),o=n(28);r.request=function(t,e){"string"==typeof t&&(t=o.parse(t)),t||(t={}),t.host||t.port||(t.port=parseInt(window.location.port,10)),!t.host&&t.hostname&&(t.host=t.hostname),t.protocol||(t.protocol=t.scheme?t.scheme+":":window.location.protocol),t.host||(t.host=window.location.hostname||window.location.host),/:/.test(t.host)&&(t.port||(t.port=t.host.split(":")[1]),t.host=t.host.split(":")[0]),t.port||(t.port="https:"==t.protocol?443:80);var n=new i(new s,t);return e&&n.on("response",e),n},r.get=function(t,e){t.method="GET";var n=r.request(t,e);return n.end(),n},r.Agent=function(){},r.Agent.defaultMaxSockets=4;var s=function(){if("undefined"==typeof window)throw new Error("no window object present");if(window.XMLHttpRequest)return window.XMLHttpRequest;if(window.ActiveXObject){for(var t=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"],e=0;e<t.length;e++)try{var n=new window.ActiveXObject(t[e]);return function(){if(n){var r=n;return n=null,r}return new window.ActiveXObject(t[e])}}catch(r){}throw new Error("ajax not supported in this browser")}throw new Error("ajax not supported in this browser")}();r.STATUS_CODES={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},function(t){function e(t,e){var n;return n=e?new r(t,e):new r(t)}var n=function(){return this}(),r=n.WebSocket||n.MozWebSocket;t.exports=r?e:null,r&&(e.prototype=r.prototype)},function(t,e,r){(function(e){function i(){return"x"+ ++A+ +new Date}function o(){return+new Date}function s(t,e){var n=t.join(I),r=[];return e?(p(e,function(t,e){var n="object"==typeof e?JSON.stringify(e):e;"undefined"!=typeof e&&null!=e&&v(n).length>0&&r.push(t+"="+v(n))}),n+="?"+r.join(U)):n}function a(t,e){var n,r=0,i=function(){r+e>o()?(clearTimeout(n),n=setTimeout(i,e)):(r=o(),t())};return i}function c(t,e){var n=[];return p(t||[],function(t){e(t)&&n.push(t)}),n}function u(t,e){return t.replace(D,function(t,n){return e[n]||t})}function h(t,e){return setTimeout(t,e)}function f(t){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)});return t&&t(e),e}function l(t){return!!t&&Array.isArray&&Array.isArray(t)}function p(t,e){if(t&&e)if(l(t))for(var n=0,r=t.length;r>n;)e.call(t[n],t[n],n++);else for(var n in t)t.hasOwnProperty&&t.hasOwnProperty(n)&&e.call(t[n],n,t[n])}function d(t,e){var n=[];return p(t||[],function(t,r){n.push(e(t,r))}),n}function v(t){return encodeURIComponent(t)}function y(t,e){var n=[];return p(t,function(t,r){e?t.search("-pnpres")<0&&r.subscribed&&n.push(t):r.subscribed&&n.push(t)}),n.sort()}function g(t,e){var n=[];return p(t,function(t,r){e?channel.search("-pnpres")<0&&r.subscribed&&n.push(t):r.subscribed&&n.push(t)}),n.sort()}function m(){h(function(){j||(j=1,p(P,function(t){t()}))},B)}function _(t){return msg=t||{apns:{}},msg.getPubnubMessage=function(){var t={};if(Object.keys(msg.apns).length){t.pn_apns={aps:{alert:msg.apns.alert,badge:msg.apns.badge}};for(var e in msg.apns)t.pn_apns[e]=msg.apns[e];var n=["badge","alert"];for(var e in n)delete t.pn_apns[n[e]]}msg.gcm&&(t.pn_gcm={data:msg.gcm});for(var e in msg)t[e]=msg[e];var r=["apns","gcm","publish","channel","callback","error"];for(var e in r)delete t[r[e]];return t},msg.publish=function(){var t=msg.getPubnubMessage();msg.pubnub&&msg.channel&&msg.pubnub.publish({message:t,channel:msg.channel,callback:msg.callback,error:msg.error})},msg}function b(t){function e(t){return t||(t={}),p(je,function(e,n){e in t||(t[e]=n)}),t}function r(t){var e=[];return p(t,function(t){e.push(t)}),e}function s(t){return r(t).sort()}function _(t){var e="",n=s(t);for(var r in n){var i=n[r];e+=i+"="+v(t[i]),r!=n.length-1&&(e+="&")}return e}function b(t,e,n){var r=!1;if("number"==typeof t)r=t>N||0==t?!1:!0;else{if("boolean"==typeof t)return t?L:0;r=!0}return r?(n&&n("Presence Heartbeat value invalid. Valid range ( x > "+N+" or x = 0). Current Value : "+(e||N)),e||N):t}function w(t,e){return Be.encrypt(t,e||Me)||t}function x(t,e){return Be.decrypt(t,e||Me)||Be.decrypt(t,Me)||t}function E(){return clearTimeout(we),!xe||xe>=500||1>xe||!y(me,!0).length?void(Ee=!1):(Ee=!0,void Ie.presence_heartbeat({callback:function(){we=h(E,xe*B)},error:function(t){Pe&&Pe("Presence Heartbeat unable to reach Pubnub servers."+JSON.stringify(t)),we=h(E,xe*B)}}))}function S(){!Ee&&E()}function T(t){if(Se){if(!ue.length)return}else{if(t&&(ue.sending=0),ue.sending||!ue.length)return;ue.sending=1}Ae(ue.shift())}function A(t){var e=0;return p(y(me),function(n){var r=me[n];r&&(e++,(t||function(){})(r))}),e}function R(t,e,n){if("object"==typeof t){if(t.error&&t.message&&t.payload)return void n({message:t.message,payload:t.payload});if(t.payload)return void e(t.payload)}e(t)}function I(t,e){e("object"==typeof t&&t.error&&t.message&&t.payload?{message:t.message,payload:t.payload}:t)}function U(t,n,r,i){var n=t.callback||n,o=t.error||Pe,s=Oe(),a=[se,"v1","channel-registration","sub-key",te];a.push.apply(a,r),Ae({callback:s,data:e(i),success:function(t){R(t,n,o)},fail:function(t){I(t,o)},url:a})}function D(){Ce()||V(1,{error:"Offline. Please check your network settings. "}),W&&clearTimeout(W),W=h(D,B)}function z(){Ie.time(function(t){K(function(){},t),t||V(1,{error:"Heartbeat failed to connect to Pubnub Servers.Please check your network settings."}),G&&clearTimeout(G),G=h(z,X)})}function V(t,e){de&&de(t,e),de=null,clearTimeout(W),clearTimeout(G)}function J(t){var e=o()-fe;return e-t/1e4}function K(t,e){function n(e){if(e){var n=e/1e4,i=(o()-r)/2;fe=o()-(n+i),t&&t(fe)}}var r=o();e&&n(e)||Ie.time(n)}var W,G,Y=+t.windowing||O,$=(+t.timeout||M)*B,X=(+t.keepalive||F)*B,Q=t.noleave||0,Z=t.publish_key||"demo",te=t.subscribe_key||"demo",ee=t.auth_key||"",ne=t.secret_key||"",re=t.hmac_SHA256,ie=t.ssl?"s":"",oe="http"+ie+"://"+(t.origin||"pubsub.pubnub.com"),se=H(oe),ae=H(oe),ce=function(){},ue=[],he=!0,fe=0,le=0,pe=0,de=0,ve=t.restore||0,ye=0,ge=!1,me={},_e={},be={},we=null,ke=b(t.heartbeat||t.pnexpires||0,t.error),xe=t.heartbeat_interval||ke-3,Ee=!1,Se=t.no_wait_for_pending,Te=t["compatible_3.5"]||!1,Ae=t.xdr,je=t.params||{},Pe=t.error||function(){},Ce=t._is_online||function(){return 1},Oe=t.jsonp_cb||function(){return 0},Re=t.db||{get:function(){},set:function(){}},Me=t.cipher_key,Fe=t.uuid||Re&&Re.get(te+"uuid")||"",Be=t.crypto_obj||{encrypt:function(t){return t},decrypt:function(t){return t}},Ie={LEAVE:function(t,n,r,i){var o={uuid:Fe,auth:ee},s=H(oe),r=r||function(){},a=i||function(){},c=Oe();if(t.indexOf(C)>0)return!0;if(Te){if(!ie)return!1;if("0"==c)return!1}return Q?!1:("0"!=c&&(o.callback=c),Ae({blocking:n||ie,timeout:2e3,callback:c,data:e(o),success:function(t){R(t,r,a)},fail:function(t){I(t,a)},url:[s,"v2","presence","sub_key",te,"channel",v(t),"leave"]}),!0)},set_resumed:function(t){ge=t},get_cipher_key:function(){return Me},set_cipher_key:function(t){Me=t},raw_encrypt:function(t,e){return w(t,e)},raw_decrypt:function(t,e){return x(t,e)},get_heartbeat:function(){return ke},set_heartbeat:function(t){ke=b(t,xe,Pe),xe=ke-3>=1?ke-3:1,ce(),E()},get_heartbeat_interval:function(){return xe},set_heartbeat_interval:function(t){xe=t,E()},get_version:function(){return q},getGcmMessageObject:function(t){return{data:t}},getApnsMessageObject:function(t){var e={aps:{badge:1,alert:""}};for(k in t)k[e]=t[k];return e},newPnMessage:function(){var t={};gcm&&(t.pn_gcm=gcm),apns&&(t.pn_apns=apns);for(k in n)t[k]=n[k];return t},_add_param:function(t,e){je[t]=e},channel_group:function(t,e){var n,r,i=t.channel_group,o=t.channels||t.channel,s=t.cloak,a=[],c={},u=t.mode||"add";if(i){var h=i.split(":");h.length>1?(n="*"===h[0]?null:h[0],r=h[1]):r=h[0]}n&&a.push("namespace")&&a.push(v(n)),a.push("channel-group"),r&&"*"!==r&&a.push(r),o?(l(o)&&(o=o.join(",")),c[u]=o,c.cloak=he?"true":"false"):"remove"===u&&a.push("remove"),"undefined"!=typeof s&&(c.cloak=s?"true":"false"),U(t,e,a,c)},channel_group_list_groups:function(t,e){var n;n=t.namespace||t.ns||t.channel_group||null,n&&(t.channel_group=n+":*"),Ie.channel_group(t,e)},channel_group_list_channels:function(t,e){return t.channel_group?void Ie.channel_group(t,e):Pe("Missing Channel Group")},channel_group_remove_channel:function(t,e){return t.channel_group?t.channel||t.channels?(t.mode="remove",void Ie.channel_group(t,e)):Pe("Missing Channel"):Pe("Missing Channel Group")},channel_group_remove_group:function(t,e){return t.channel_group?t.channel?Pe("Use channel_group_remove_channel if you want to remove a channel from a group."):(t.mode="remove",void Ie.channel_group(t,e)):Pe("Missing Channel Group")},channel_group_add_channel:function(t,e){return t.channel_group?t.channel||t.channels?void Ie.channel_group(t,e):Pe("Missing Channel"):Pe("Missing Channel Group")},channel_group_cloak:function(t,e){return"undefined"==typeof t.cloak?void e(he):(he=t.cloak,void Ie.channel_group(t,e))},channel_group_list_namespaces:function(t,e){var n=["namespace"];U(t,e,n)},channel_group_remove_namespace:function(t,e){var n=["namespace",t.namespace,"remove"];U(t,e,n)},history:function(t,n){var n=t.callback||n,r=t.count||t.limit||100,i=t.reverse||"false",o=t.error||function(){},s=t.auth_key||ee,a=t.cipher_key,c=t.channel,u=t.channel_group,h=t.start,f=t.end,l=t.include_token,p={},d=Oe();return c||u?n?te?(p.stringtoken="true",p.count=r,p.reverse=i,p.auth=s,u&&(p["channel-group"]=u,c||(c=",")),d&&(p.callback=d),h&&(p.start=h),f&&(p.end=f),l&&(p.include_token="true"),void Ae({callback:d,data:e(p),success:function(t){if("object"==typeof t&&t.error)return void o({message:t.message,payload:t.payload});for(var e=t[0],r=[],i=0;i<e.length;i++){var s=x(e[i],a);try{r.push(JSON.parse(s))}catch(c){r.push(s)}}n([r,t[1],t[2]])},fail:function(t){I(t,o)},url:[se,"v2","history","sub-key",te,"channel",v(c)]})):Pe("Missing Subscribe Key"):Pe("Missing Callback"):Pe("Missing Channel")},replay:function(t,n){var r,n=n||t.callback||function(){},i=t.auth_key||ee,o=t.source,s=t.destination,a=t.stop,c=t.start,u=t.end,h=t.reverse,f=t.limit,l=Oe(),p={};return o?s?Z?te?("0"!=l&&(p.callback=l),a&&(p.stop="all"),h&&(p.reverse="true"),c&&(p.start=c),u&&(p.end=u),f&&(p.count=f),p.auth=i,r=[se,"v1","replay",Z,te,o,s],void Ae({callback:l,success:function(t){R(t,n,err)},fail:function(){n([0,"Disconnected"])},url:r,data:e(p)})):Pe("Missing Subscribe Key"):Pe("Missing Publish Key"):Pe("Missing Destination Channel"):Pe("Missing Source Channel")},auth:function(t){ee=t,ce()},time:function(t){var n=Oe();Ae({callback:n,data:e({uuid:Fe,auth:ee}),timeout:5*B,url:[se,"time",n],success:function(e){t(e[0])},fail:function(){t(0)}})},publish:function(t,n){var r=t.message;if(!r)return Pe("Missing Message");var i,n=n||t.callback||r.callback||function(){},o=t.channel||r.channel,s=t.auth_key||ee,a=t.cipher_key,c=t.error||r.error||function(){},u=t.post||!1,h="store_in_history"in t?t.store_in_history:!0,f=Oe(),l="push";return t.prepend&&(l="unshift"),o?Z?te?(r.getPubnubMessage&&(r=r.getPubnubMessage()),r=JSON.stringify(w(r,a)),i=[se,"publish",Z,te,0,v(o),f,v(r)],je={uuid:Fe,auth:s},h||(je.store="0"),ue[l]({callback:f,timeout:5*B,url:i,data:e(je),fail:function(t){I(t,c),T(1)},success:function(t){R(t,n,c),T(1)},mode:u?"POST":"GET"}),void T()):Pe("Missing Subscribe Key"):Pe("Missing Publish Key"):Pe("Missing Channel")},unsubscribe:function(t,e){var n=t.channel,r=t.channel_group,e=e||t.callback||function(){},i=t.error||function(){};ye=0,n&&(n=d((n.join?n.join(","):""+n).split(","),function(t){return me[t]?t+","+t+C:void 0}).join(","),p(n.split(","),function(t){var n=!0;t&&(j&&(n=Ie.LEAVE(t,0,e,i)),n||e({action:"leave"}),me[t]=0,t in be&&delete be[t])})),r&&(r=d((r.join?r.join(","):""+r).split(","),function(t){return _e[t]?t+","+t+C:void 0}).join(","),p(r.split(","),function(){var t=!0;r&&(j&&(t=Ie.LEAVE(r,0,e,i)),t||e({action:"leave"}),_e[r]=0,r in be&&delete be[r])})),ce()},subscribe:function(t,n){function r(t){t?h(ce,B):(se=H(oe,1),ae=H(oe,1),h(function(){Ie.time(r)},B)),A(function(e){return t&&e.disconnected?(e.disconnected=0,e.reconnect(e.name)):void(t||e.disconnected||(e.disconnected=1,e.disconnect(e.name)))})}function i(){var t=Oe(),n=y(me).join(","),o=g(_e).join(",");if(n||o){n||(n=","),V();var s=e({uuid:Fe,auth:c});o&&(s["channel-group"]=o);var a=JSON.stringify(be);a.length>2&&(s.state=JSON.stringify(be)),ke&&(s.heartbeat=ke),S(),de=Ae({timeout:T,callback:t,fail:function(t){I(t,m),Ie.time(r)},data:e(s),url:[ae,"subscribe",te,v(n),t,ye],success:function(t){if(!t||"object"==typeof t&&"error"in t&&t.error)return m(t.error),h(ce,B);if(_(t[1]),ye=!ye&&ve&&Re.get(te)||t[1],A(function(t){t.connected||(t.connected=1,t.connect(t.name))}),ge&&!ve)return ye=0,ge=!1,Re.set(te,0),void h(i,O);k&&(ye=1e4,k=0),Re.set(te,t[1]);var e=function(){var e="";e=t.length>3?t[3]:t.length>2?t[2]:d(y(me),function(e){return d(Array(t[0].length).join(",").split(","),function(){return e})}).join(",");var n=e.split(",");return function(){var t=n.shift()||pe;return[(me[t]||{}).callback||le,t.split(C)[0]]}}(),n=J(+t[1]);p(t[0],function(r){var i=e(),o=x(r,me[i[1]]?me[i[1]].cipher_key:null);i[0](o,t,i[2]||i[1],n)}),h(i,O)}})}}var s=t.channel,a=t.channel_group,n=n||t.callback,n=n||t.message,c=t.auth_key||ee,u=t.connect||function(){},f=t.reconnect||function(){},l=t.disconnect||function(){},m=t.error||function(){},_=t.idle||function(){},b=t.presence||0,w=t.noheresync||0,k=t.backfill||0,E=t.timetoken||0,T=t.timeout||$,O=t.windowing||Y,R=t.state,M=t.heartbeat||t.pnexpires,F=t.restore||ve;return ve=F,ye=E,s||a?n?te?((M||0===M)&&Ie.set_heartbeat(M),s&&p((s.join?s.join(","):""+s).split(","),function(e){var r=me[e]||{};me[pe=e]={name:e,connected:r.connected,disconnected:r.disconnected,subscribed:1,callback:le=n,cipher_key:t.cipher_key,connect:u,disconnect:l,reconnect:f},R&&(be[e]=e in R?R[e]:R),b&&(Ie.subscribe({channel:e+C,callback:b,restore:F}),r.subscribed||w||Ie.here_now({channel:e,callback:function(t){p("uuids"in t?t.uuids:[],function(n){b({action:"join",uuid:n,timestamp:Math.floor(o()/1e3),occupancy:t.occupancy||1},t,e)})}}))}),a&&p((a.join?a.join(","):""+a).split(","),function(e){var r=_e[e]||{};_e[e]={name:e,connected:r.connected,disconnected:r.disconnected,subscribed:1,callback:le=n,cipher_key:t.cipher_key,connect:u,disconnect:l,reconnect:f},b&&(Ie.subscribe({channel_group:e+C,callback:b,restore:F}),r.subscribed||w||Ie.here_now({channel_group:e,callback:function(t){p("uuids"in t?t.uuids:[],function(n){b({action:"join",uuid:n,timestamp:Math.floor(o()/1e3),occupancy:t.occupancy||1},t,e)})}}))}),ce=function(){V(),h(i,O)},j?void ce():P.push(ce)):Pe("Missing Subscribe Key"):Pe("Missing Callback"):Pe("Missing Channel")},here_now:function(t,n){var n=t.callback||n,r=t.error||function(){},i=t.auth_key||ee,o=t.channel,s=t.channel_group,a=Oe(),c="uuids"in t?t.uuids:!0,u=t.state,h={uuid:Fe,auth:i};if(c||(h.disable_uuids=1),u&&(h.state=1),!n)return Pe("Missing Callback");if(!te)return Pe("Missing Subscribe Key");var f=[se,"v2","presence","sub_key",te];o&&f.push("channel")&&f.push(v(o)),"0"!=a&&(h.callback=a),s&&(h["channel-group"]=s,!o&&f.push("channel")&&f.push(",")),Ae({callback:a,data:e(h),success:function(t){R(t,n,r)},fail:function(t){I(t,r)},url:f})},where_now:function(t,n){var n=t.callback||n,r=t.error||function(){},i=t.auth_key||ee,o=Oe(),s=t.uuid||Fe,a={auth:i};return n?te?("0"!=o&&(a.callback=o),void Ae({callback:o,data:e(a),success:function(t){R(t,n,r)},fail:function(t){I(t,r)},url:[se,"v2","presence","sub_key",te,"uuid",v(s)]})):Pe("Missing Subscribe Key"):Pe("Missing Callback")},state:function(t,n){var r,n=t.callback||n||function(){},i=t.error||function(){},o=t.auth_key||ee,s=Oe(),a=t.state,c=t.uuid||Fe,u=t.channel,h=t.channel_group,f=e({auth:o});return te?c?u||h?("0"!=s&&(f.callback=s),"undefined"!=typeof u&&me[u]&&me[u].subscribed&&a&&(be[u]=a),"undefined"!=typeof h&&_e[h]&&_e[h].subscribed&&(a&&(be[h]=a),f["channel-group"]=h,u||(u=",")),f.state=JSON.stringify(a),r=a?[se,"v2","presence","sub-key",te,"channel",u,"uuid",c,"data"]:[se,"v2","presence","sub-key",te,"channel",u,"uuid",v(c)],void Ae({callback:s,data:e(f),success:function(t){R(t,n,i)},fail:function(t){I(t,i)},url:r})):Pe("Missing Channel"):Pe("Missing UUID"):Pe("Missing Subscribe Key")},grant:function(t,n){var n=t.callback||n,r=t.error||function(){},i=t.channel,o=t.channel_group,s=Oe(),a=t.ttl,c=t.read?"1":"0",u=t.write?"1":"0",h=t.manage?"1":"0",f=t.auth_key;if(!n)return Pe("Missing Callback");if(!te)return Pe("Missing Subscribe Key");if(!Z)return Pe("Missing Publish Key");if(!ne)return Pe("Missing Secret Key");var l=Math.floor((new Date).getTime()/1e3),p=te+"\n"+Z+"\ngrant\n",d={w:u,r:c,timestamp:l};t.manage&&(d.m=h),"undefined"!=typeof i&&null!=i&&i.length>0&&(d.channel=i),"undefined"!=typeof o&&null!=o&&o.length>0&&(d["channel-group"]=o),"0"!=s&&(d.callback=s),(a||0===a)&&(d.ttl=a),f&&(d.auth=f),d=e(d),f||delete d.auth,p+=_(d);var v=re(p,ne);v=v.replace(/\+/g,"-"),v=v.replace(/\//g,"_"),d.signature=v,Ae({callback:s,data:d,success:function(t){R(t,n,r)},fail:function(t){I(t,r)},url:[se,"v1","auth","grant","sub-key",te]})},audit:function(t,n){var n=t.callback||n,r=t.error||function(){},i=t.channel,o=t.channel_group,s=t.auth_key,a=Oe();if(!n)return Pe("Missing Callback");if(!te)return Pe("Missing Subscribe Key");if(!Z)return Pe("Missing Publish Key");if(!ne)return Pe("Missing Secret Key");var c=Math.floor((new Date).getTime()/1e3),u=te+"\n"+Z+"\naudit\n",h={timestamp:c};"0"!=a&&(h.callback=a),"undefined"!=typeof i&&null!=i&&i.length>0&&(h.channel=i),"undefined"!=typeof o&&null!=o&&o.length>0&&(h["channel-group"]=o),s&&(h.auth=s),h=e(h),s||delete h.auth,u+=_(h);var f=re(u,ne);f=f.replace(/\+/g,"-"),f=f.replace(/\//g,"_"),h.signature=f,Ae({callback:a,data:h,success:function(t){R(t,n,r)},fail:function(t){I(t,r)},url:[se,"v1","auth","audit","sub-key",te]})},revoke:function(t,e){t.read=!1,t.write=!1,Ie.grant(t,e)},set_uuid:function(t){Fe=t,ce()},get_uuid:function(){return Fe},presence_heartbeat:function(t){var n=t.callback||function(){},r=t.error||function(){},i=Oe(),o={uuid:Fe,auth:ee},s=JSON.stringify(be);s.length>2&&(o.state=JSON.stringify(be)),ke>0&&320>ke&&(o.heartbeat=ke),"0"!=i&&(o.callback=i);var a=v(y(me,!0).join(",")),c=g(_e,!0).join(",");a||(a=","),c&&(o["channel-group"]=c),Ae({callback:i,data:e(o),timeout:5*B,url:[se,"v2","presence","sub-key",te,"channel",a,"heartbeat"],success:function(t){R(t,n,r)},fail:function(t){I(t,r)}})},stop_timers:function(){clearTimeout(W),clearTimeout(G)},xdr:Ae,ready:m,db:Re,uuid:f,map:d,each:p,"each-channel":A,grep:c,offline:function(){V(1,{message:"Offline. Please check your network settings."})},supplant:u,now:o,unique:i,updater:a};return Fe||(Fe=Ie.uuid()),Re.set(te+"uuid",Fe),W=h(D,B),G=h(z,X),we=h(S,(xe-3)*B),K(),Ie}function w(t,n){return W.createHmac("sha256",new e(n,"utf8")).update(t).digest("base64")}function x(t){console.error(t)}function E(t){var e,n,i=t.success||function(){},o=t.fail||function(){},a=t.origin||"pubsub.pubnub.com",c=t.ssl,u=0,f=0,l=t.mode||"GET",p=t.data||{},d=t.timeout||R,v="",y=function(){if(!f){f=1,clearTimeout(m);try{n=JSON.parse(v)}catch(t){return g(1)}i(n)}},g=function(t,n){u||(u=1,clearTimeout(m),e&&(e.on("error",function(){}),e.on("data",function(){}),e.on("end",function(){}),e.abort&&e.abort(),e=null),t&&o(n))},m=h(function(){g(1)},d);p.pnsdk=K;var _={},b="";"POST"==l&&(b=decodeURIComponent(t.url.pop()));var w=s(t.url,p);c||(c="https"==w.split("://")[0]?!0:!1),w="/"+w.split("/").slice(3).join("/");var a=t.url[0].split("//")[1];_.hostname=G?G.hostname:t.url[0].split("//")[1],_.port=G?G.port:c?443:80,_.path=G?"http://"+a+w:w,_.headers=G?{Host:a}:null,_.method=l,_.keepAlive=!!J,_.body=b,r(31).globalAgent.maxSockets=1/0;try{e=(c?V:z).request(_,function(t){t.setEncoding("utf8"),t.on("error",function(){g(1,v||{error:"Network Connection Error"})}),t.on("abort",function(){g(1,v||{error:"Network Connection Error"})}),t.on("data",function(t){t&&(v+=t)}),t.on("end",function(){var e=t.statusCode;switch(e){case 401:case 402:case 403:try{t=JSON.parse(v),g(1,t)}catch(n){return g(1,v)}return}y()})}),e.timeout=d,e.on("error",function(){g(1,{error:"Network Connection Error"})}),"POST"==l&&e.write(b),e.end()}catch(k){return g(0),E(t)}return g}function S(){function t(t){return W.createHash("sha256").update(t).digest("hex").slice(0,32)}var e="0123456789012345";return{encrypt:function(n,r){if(!r)return n;var i=JSON.stringify(n),o=W.createCipheriv("aes-256-cbc",t(r),e),s=o.update(i,"utf8","base64")+o.final("base64");return s||n},decrypt:function(n,r){if(!r)return n;var i=W.createDecipheriv("aes-256-cbc",t(r),e);try{var o=i.update(n,"base64","utf8")+i.final("utf8")}catch(s){return null}return JSON.parse(o)}}}function T(){return"EventEmitter"in z.Agent.super_}var A=1,j=!1,P=[],C="-pnpres",O=10,R=1e4,M=310,F=60,B=1e3,I="/",U="&",N=5,L=30,q="3.7.0",D=/{([\w\-]+)}/g,H=function(){var t=20,e=Math.floor(Math.random()*t);return function(n,r){return n.indexOf("pubsub.")>0&&n.replace("pubsub","ps"+(r?f().split("-")[0]:++e<t?e:e=1))||n}}(),A=1,z=r(31),V=r(49),J=new(T()?z.Agent:r(53))({keepAlive:!0,keepAliveMsecs:3e5,maxSockets:5}),R=1e4,B=1e3,K="PubNub-JS-Nodejs/3.7.0",W=r(48),G=null,Y=function(){var t={};return{get:function(e){return t[e]},set:function(e,n){t[e]=n}}}(),$=function(t){G=t.proxy,t.xdr=E,t.db=Y,t.error=t.error||x,t.hmac_SHA256=w,t.crypto_obj=S(),t.params={pnsdk:K},t.keepAlive===!1&&(J=void 0),SELF=function(t){return $(t)};var e=b(t);for(var n in e)e.hasOwnProperty(n)&&(SELF[n]=e[n]);return SELF.init=SELF,SELF.secure=SELF,SELF.ready(),SELF};$.init=$,$.unique=i,$.secure=$,t.exports=$,t.exports.PNmessage=_}).call(e,r(50).Buffer)},function(t,e,n){function r(t){function e(t){if(p.length>0){for(var e=p.length-1;e>=0&&p[e].time>t.time;)e--;p.splice(e+1,0,t)}else p.push(t)}function n(t,n){function r(){t.type===o.INTERVAL&&d[t.id]&&(t.occurrence++,t.time=t.firstTime+t.occurrence*t.interval,e(t)),delete d[t.id],"function"==typeof n&&n()}d[t.id]=t;try{0==t.callback.length?(t.callback(),r()):t.callback(r)}catch(i){r()}}function r(t){for(var e=0;e<p.length&&(p[e].time<=t||!isFinite(p[e].time));)e++;var n=p.splice(0,e);return 0==u&&i.shuffle(n),n}function a(){function t(){function t(){var r=e.shift();r?n(r,t):a()}c===s&&(l=i>l&&isFinite(i)?i:l);var e=r(i);c===s?t():(e.forEach(n),a())}if(!(c===s&&Object.keys(d).length>0)){var e=p[0];if(v&&(clearTimeout(v),v=null),h&&e){var i=e.time,o=i-g.now(),u=c===s?0:o/c;v=setTimeout(t,Math.round(u))}}}var c=1,u=!0,h=!1,f=null,l=null,p=[],d={},v=null,y=0,g={};return g.config=function(t){if(t){if("rate"in t){var e=t.rate===s?s:Number(t.rate);if(e!==s&&(isNaN(e)||0>=e))throw new TypeError('rate must be a positive number or the string "discrete"');l=g.now(),f=i.systemNow(),c=e}"deterministic"in t&&(u=t.deterministic?!0:!1)}return a(),{rate:c,deterministic:u}},g.setTime=function(t){if(t instanceof Date)l=t.valueOf();else{var e=Number(t);if(isNaN(e))throw new TypeError("time must be a Date or number");l=e}a()},g.now=function(){if(c===s)return l;if(h){var t=i.systemNow()-f,e=t*c;return l+e}return l},g["continue"]=function(){f=i.systemNow(),h=!0,a()},g.pause=function(){l=g.now(),f=null,h=!1,a()},g.getTime=function(){return new Date(g.now())},g.valueOf=g.getTime,g.toString=function(){return g.getTime().toString()},g.setTimeout=function(t,n){var r=y++,i=g.now()+n;if(isNaN(i))throw new TypeError("delay must be a number");return e({id:r,type:o.TIMEOUT,time:i,callback:t}),a(),r},g.setTrigger=function(t,n){var r=y++,i=Number(n);if(isNaN(i))throw new TypeError("time must be a Date or number");return e({id:r,type:o.TRIGGER,time:i,callback:t}),a(),r},g.setInterval=function(t,n,r){var i=y++,s=Number(n);if(isNaN(s))throw new TypeError("interval must be a number");(0>s||!isFinite(s))&&(s=0);var c;if(void 0!=r){if(c=Number(r),isNaN(c))throw new TypeError("firstTime must be a Date or number")}else c=g.now()+s;return e({id:i,type:o.INTERVAL,interval:s,time:c,firstTime:c,occurrence:0,callback:t}),a(),i},g.clearTimeout=function(t){if(d[t])return void delete d[t];for(var e=0;e<p.length;e++)if(p[e].id===t){p.splice(e,1),a();break}},g.clearTrigger=g.clearTimeout,g.clearInterval=g.clearTimeout,g.list=function(){return p.map(function(t){return t.id})},g.clear=function(){d={},p=[],a()},Object.defineProperty(g,"running",{get:function(){return h}}),g.config(t),g.setTime(i.systemNow()),g.continue(),g}var i=n(43),o={TIMEOUT:0,INTERVAL:1,TRIGGER:2},s="discrete";t.exports=r},function(t,e,n){"use strict";function r(t){function e(t){return null===c?void h.push(t):void s(function(){var e=c?t.onFulfilled:t.onRejected;if(null===e)return void(c?t.resolve:t.reject)(u);var n;try{n=e(u)}catch(r){return void t.reject(r)}t.resolve(n)})}function n(t){try{if(t===f)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if("function"==typeof e)return void o(e.bind(t),n,r)}c=!0,u=t,a()}catch(i){r(i)}}function r(t){c=!1,u=t,a()}function a(){for(var t=0,n=h.length;n>t;t++)e(h[t]);h=null}if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");var c=null,u=null,h=[],f=this;this.then=function(t,n){return new f.constructor(function(r,o){e(new i(t,n,r,o))})},o(t,n,r)}function i(t,e,n,r){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.resolve=n,this.reject=r}function o(t,e,n){var r=!1;try{t(function(t){r||(r=!0,e(t))},function(t){r||(r=!0,n(t))})}catch(i){if(r)return;r=!0,n(i)}}var s=n(62);t.exports=r},function(t,e,n){"use strict";var r=n(35),i=n(62);t.exports=r,r.prototype.done=function(){var t=arguments.length?this.then.apply(this,arguments):this;t.then(null,function(t){i(function(){throw t})})}},function(t,e,n){"use strict";var r=n(35),i=n(62);t.exports=r,r.denodeify=function(t,e){return e=e||1/0,function(){var n=this,i=Array.prototype.slice.call(arguments);return new r(function(r,o){for(;i.length&&i.length>e;)i.pop();i.push(function(t,e){t?o(t):r(e)}),t.apply(n,i)})}},r.nodeify=function(t){return function(){var e=Array.prototype.slice.call(arguments),n="function"==typeof e[e.length-1]?e.pop():null,o=this;try{return t.apply(this,arguments).nodeify(n,o)}catch(s){if(null===n||"undefined"==typeof n)return new r(function(t,e){e(s)});i(function(){n.call(o,s)})}}},r.prototype.nodeify=function(t,e){return"function"!=typeof t?this:void this.then(function(n){i(function(){t.call(e,null,n)})},function(n){i(function(){t.call(e,n)})})}},function(t,e,n){"use strict";function r(t){this.then=function(e){return"function"!=typeof e?this:new i(function(n,r){o(function(){try{n(e(t))}catch(i){r(i)}})})}}var i=n(35),o=n(62);t.exports=i,r.prototype=i.prototype;var s=new r(!0),a=new r(!1),c=new r(null),u=new r(void 0),h=new r(0),f=new r("");i.resolve=function(t){if(t instanceof i)return t;if(null===t)return c;if(void 0===t)return u;if(t===!0)return s;
if(t===!1)return a;if(0===t)return h;if(""===t)return f;if("object"==typeof t||"function"==typeof t)try{var e=t.then;if("function"==typeof e)return new i(e.bind(t))}catch(n){return new i(function(t,e){e(n)})}return new r(t)},i.all=function(t){var e=Array.prototype.slice.call(t);return new i(function(t,n){function r(o,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,function(t){r(o,t)},n)}e[o]=s,0===--i&&t(e)}catch(c){n(c)}}if(0===e.length)return t([]);for(var i=e.length,o=0;o<e.length;o++)r(o,e[o])})},i.reject=function(t){return new i(function(e,n){n(t)})},i.race=function(t){return new i(function(e,n){t.forEach(function(t){i.resolve(t).then(e,n)})})},i.prototype["catch"]=function(t){return this.then(null,t)}},function(t,e,n){t.exports=n(76)},function(t,e,n){function r(t){var e=this;this.peers={},this.addresses={},this.channels={},this.options={reconnectTimeout:3e5,reconnectDelay:1e3,reconnectDecay:2},this.server=null,this.address=null,this.port=null,this.connections={},this.timers={},this.send=function(t,n,r){var i=e.peers[n];return i?(i.emit("message",t,r),u.resolve(null)):e.find(n).then(function(i){var a=e.connections[i];if(a){var c={method:"send",params:{from:t,to:n,message:r}};return a.request(c).catch(function(t){if(0===t.toString().indexOf("Error: Peer not found"))throw delete e.addresses[n],o(n)})}throw s(n,i)})},this.config(t)}function i(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function o(t){return new Error("Peer not found (id: "+t+")")}function s(t,e){return new Error("Peer unreachable (id: "+t+", url: "+e+")")}var a=n(32),c=n(32).Server,u=(n(63),n(39)),h=n(45),f=n(46);r.prototype.config=function(t){if(t&&(i(this.options,t),t.networkId)){if(null===this.networkId)throw new Error("Cannot replace networkId once set");this.networkId=t.networkId}return i({},this.options)},r.prototype.create=function(t){if(t in this.peers)throw new Error("Id already exists (id: "+t+")");var e=new f(t,this.send);return this.peers[t]=e,e},r.prototype.remove=function(t){t instanceof f?delete this.peers[t.id]:t&&delete this.peers[t]},r.prototype.get=function(t){return this.peers[t]||null},r.prototype.find=function(t){var e=this;if(t in e.peers)return u.resolve(e.url||null);var n=e.addresses[t];return n?u.resolve(n):new u(function(n,r){function i(r){var i=e.connections[r];return i.request({method:"find",params:{id:t}}).then(function(r){r&&!s&&(s=!0,e.addresses[t]=r,n(r))})}var s=!1,a=Object.keys(e.connections).map(i);u.all(a).then(function(){s&&0!=a.length||r(o(t))})})},r.prototype.listen=function(t,e){var n=this;return new u(function(r,i){return n.server?void i(new Error("Server already listening")):(n.server=new c({port:e},function(){n.address=t,n.port=e,n.url="ws://"+t+":"+e,r(n)}),n.server.on("connection",function(t){t=h(t),t.onerror=function(){},t.onclose=function(){var e=n._findUrl(t);delete n.connections[e],n.timers[e]=setTimeout(function(){delete n.timers[e],n._forgetPeers(e)},n.options.reconnectTimeout)},t.onrequest=function(e){return n._onRequest(t,e)}}),void n.server.on("error",function(t){i(t)}))})},r.prototype._onRequest=function(t,e){var n,r=this;switch(e.method){case"greeting":n=e.params&&e.params.url;var i=e.params.networkId||null;return null===i||i===r.networkId?!n||n in this.connections?u.resolve({networkId:r.networkId}):(this.connections[n]=t,this._broadcastJoin(n).then(function(){return u.resolve({networkId:r.networkId})})):u.reject(new Error("Network id mismatch ("+i+" !== "+r.networkId+")"));case"join":return n=e.params&&e.params.url,this.join(n).then(function(){return u.resolve()});case"goodbye":return n=this._findUrl(t),this._forgetPeers(n),this._disconnect(n),u.resolve("goodbye");case"hosts":return e.params&&e.params.urls&&this.join(e.params.urls),u.resolve(Object.keys(this.connections));case"find":var s=e.params&&e.params.id;return u.resolve(this.peers[s]?this.url:null);case"send":var a=e.params&&e.params.from,c=e.params&&e.params.to,h=e.params&&e.params.message,f=this.peers[c];return f?(f.emit("message",a,h),u.resolve(null)):u.reject(o(c).toString());case"publish":var l=e.params&&e.params.channel,h=e.params&&e.params.message;return this._publish(l,h),u.resolve({result:null,error:null});case"ping":return u.resolve({result:e.params,error:null});default:return u.reject('Unknown method "'+e.method+'"')}},r.prototype._findUrl=function(t){for(var e in this.connections)if(this.connections.hasOwnProperty(e)&&this.connections[e]===t)return e;return null},r.prototype._forgetPeers=function(t){for(var e in this.addresses)this.addresses.hasOwnProperty(e)&&this.addresses[e]===t&&delete this.addresses[e]},r.prototype.join=function(t){var e=this;return!t||t in e.connections?u.resolve(e):e._connect(t).then(function(){return e._broadcastJoin(t)}).then(function(){return e})},r.prototype._connect=function(t){var e=this;return new u(function(n,r){var i=new a(t);h(i),e.connections[t]=i,i.onrequest=function(t){return e._onRequest(i,t)},i.onclose=function(){e.connections[t]&&(delete e.connections[t],e._reconnect(t))},i.onopen=function(){i.request({method:"greeting",params:{url:e.url,networkId:e.networkId}}).then(function(t){e.networkId=t.networkId,n(i)}).catch(function(n){delete e.connections[t],i.close(),r(n)})},i.onerror=function(n){delete e.connections[t],r(n),i.close()}})},r.prototype._reconnect=function(t){function e(i,o){n.timers[t]=setTimeout(function(){delete n.timers[t];var s=(new Date).valueOf();s-r<n.options.reconnectTimeout?n._connect(t).catch(function(){e(i/n.options.reconnectDecay,o+1)}):n._forgetPeers(t)},i)}var n=this,r=(new Date).valueOf();e(n.options.reconnectDelay,0)},r.prototype._broadcastJoin=function(t){function e(e){var r=n.connections[e];return r.request({method:"join",params:{url:t}}).catch(function(){}).then(function(){return e})}var n=this,r=Object.keys(n.connections).filter(function(e){return e!==t});return u.all(r.map(e))},r.prototype.close=function(){function t(){return e.addresses={},e.server&&(e.server.close(),e.server=null,e.address=null,e.port=null,e.url=null),e}var e=this;if(this.server){var n=Object.keys(this.connections);return u.all(n.map(function(t){return e._disconnect(t)})).then(t)}u.resolve(this)},r.prototype._disconnect=function(t){var e=this.connections[t];return e?(delete this.connections[t],this.timers[t]&&(clearTimeout(this.timers[t]),delete this.timers[t]),e.request({method:"goodbye"}).catch(function(){}).then(function(){e.close()})):void u.resolve()},r.prototype.publish=function(t,e){this._publish(t,e);for(var n in this.connections)if(this.connections.hasOwnProperty(n)){var r=this.connections[n];r.notify({method:"publish",params:{channel:t,message:e}})}},r.prototype._publish=function(t,e){var n=this.channels[t];n&&n.forEach(function(t){t(e)})},r.prototype.subscribe=function(t,e){var n=this.channels[t];n||(n=[],this.channels[t]=n),n.push(e)},r.prototype.unsubscribe=function(t,e){var n=this.channels[t];if(n){var r=n.indexOf(e);-1!==r&&(n.splice(r,1),0===n.length&&delete this.channels[t])}},t.exports=r},function(t,e,n){"use strict";var r=n(51),i=n(56),o=n(55),s=n(57),a=n(58),c=n(59);e.babbler=function(t){return new r(t)},e.tell=function(t){return new i(t)},e.ask=function(t,n){return e.tell(t).listen(n)},e.decide=function(t,e){return new a(t,e)},e.listen=function(t){var e=new o;return t?e.then(t):e},e.then=function(t){return new s(t)},e.iif=function(t,e,n){return new c(t,e,n)},e.Babbler=r,e.block={Block:n(60),Then:n(57),Decision:n(58),IIf:n(59),Listen:n(55),Tell:n(56)},e.messagebus=n(52),e.babblify=function(t,n){var r;if(n&&void 0!==n.id)r=n.id;else{if(void 0===t.id)throw new Error('Id missing. Ensure that either actor has a property "id", or provide an id as a property in second argument params');r=t.id}["ask","tell","listen"].forEach(function(e){if(void 0!==t[e])throw new Error('Conflict: actor already has a property "'+e+'"')});var i=n&&n.send||"send";if("function"!=typeof t[i])throw new Error('Missing function. Function "'+i+'(to, message)" expected on actor or on params');var o=e.babbler(r),s=n&&n.receive||"receive",a=t.hasOwnProperty(s)?t[s]:null;return t[s]=a?function(e,n){o._receive(n),a.call(t,e,n)}:function(t,e){o._receive(e)},o.send=function(e,n){setTimeout(function(){t[i](e,n)},0)},t.__babbler__={babbler:o,receive:a,receiveName:s},t.ask=o.ask.bind(o),t.tell=o.tell.bind(o),t.listen=o.listen.bind(o),t.listenOnce=o.listenOnce.bind(o),t},e.unbabblify=function(t){var e=t.__babbler__;return e&&(delete t.__babbler__,delete t.ask,delete t.tell,delete t.listen,delete t.listenOnce,delete t[e.receiveName],e.receive&&(t[e.receiveName]=e.receive)),t}},function(t,e,n){var r=n(70),i=n(54),o=n(72),s=n(73),a=t.exports=function(t,e){var n=this;n.writable=!0,n.xhr=t,n.body=[],n.uri=(e.protocol||"http:")+"//"+e.host+(e.port?":"+e.port:"")+(e.path||"/"),"undefined"==typeof e.withCredentials&&(e.withCredentials=!0);try{t.withCredentials=e.withCredentials}catch(r){}if(e.responseType)try{t.responseType=e.responseType}catch(r){}if(t.open(e.method||"GET",n.uri,!0),t.onerror=function(){n.emit("error",new Error("Network error"))},n._headers={},e.headers)for(var s=c(e.headers),a=0;a<s.length;a++){var u=s[a];if(n.isSafeRequestHeader(u)){var h=e.headers[u];n.setHeader(u,h)}}e.auth&&this.setHeader("Authorization","Basic "+o.btoa(e.auth));var f=new i;f.on("close",function(){n.emit("close")}),f.on("ready",function(){n.emit("response",f)}),f.on("error",function(t){n.emit("error",t)}),t.onreadystatechange=function(){t.__aborted||f.handle(t)}};s(a,r),a.prototype.setHeader=function(t,e){this._headers[t.toLowerCase()]=e},a.prototype.getHeader=function(t){return this._headers[t.toLowerCase()]},a.prototype.removeHeader=function(t){delete this._headers[t.toLowerCase()]},a.prototype.write=function(t){this.body.push(t)},a.prototype.destroy=function(){this.xhr.__aborted=!0,this.xhr.abort(),this.emit("close")},a.prototype.end=function(t){void 0!==t&&this.body.push(t);for(var e=c(this._headers),n=0;n<e.length;n++){var r=e[n],i=this._headers[r];if(u(i))for(var o=0;o<i.length;o++)this.xhr.setRequestHeader(r,i[o]);else this.xhr.setRequestHeader(r,i)}if(0===this.body.length)this.xhr.send("");else if("string"==typeof this.body[0])this.xhr.send(this.body.join(""));else if(u(this.body[0])){for(var s=[],n=0;n<this.body.length;n++)s.push.apply(s,this.body[n]);this.xhr.send(s)}else if(/Array/.test(Object.prototype.toString.call(this.body[0]))){for(var a=0,n=0;n<this.body.length;n++)a+=this.body[n].length;for(var s=new this.body[0].constructor(a),h=0,n=0;n<this.body.length;n++)for(var l=this.body[n],o=0;o<l.length;o++)s[h++]=l[o];this.xhr.send(s)}else if(f(this.body[0]))this.xhr.send(this.body[0]);else{for(var s="",n=0;n<this.body.length;n++)s+=this.body[n].toString();this.xhr.send(s)}},a.unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"],a.prototype.isSafeRequestHeader=function(t){return t?-1===h(a.unsafeHeaders,t.toLowerCase()):!1};var c=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e},u=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},h=function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1},f=function(t){return"undefined"!=typeof Blob&&t instanceof Blob?!0:"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?!0:"undefined"!=typeof FormData&&t instanceof FormData?!0:void 0}},function(t,e){e.systemNow="function"==typeof Date.now?function(){return Date.now()}:function(){return(new Date).valueOf()},e.shuffle=function(t){for(var e,n,r=t.length;r;e=Math.floor(Math.random()*r),n=t[--r],t[r]=t[e],t[e]=n);return t}},function(t){function e(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function r(t){return"number"==typeof t}function i(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}t.exports=e,e.EventEmitter=e,e.prototype._events=void 0,e.prototype._maxListeners=void 0,e.defaultMaxListeners=10,e.prototype.setMaxListeners=function(t){if(!r(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},e.prototype.emit=function(t){var e,r,s,a,c,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(r=this._events[t],o(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:for(s=arguments.length,a=new Array(s-1),c=1;s>c;c++)a[c-1]=arguments[c];r.apply(this,a)}else if(i(r)){for(s=arguments.length,a=new Array(s-1),c=1;s>c;c++)a[c-1]=arguments[c];for(u=r.slice(),s=u.length,c=0;s>c;c++)u[c].apply(this,a)}return!0},e.prototype.addListener=function(t,r){var s;if(!n(r))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(r.listener)?r.listener:r),this._events[t]?i(this._events[t])?this._events[t].push(r):this._events[t]=[this._events[t],r]:this._events[t]=r,i(this._events[t])&&!this._events[t].warned){var s;s=o(this._maxListeners)?e.defaultMaxListeners:this._maxListeners,s&&s>0&&this._events[t].length>s&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())}return this},e.prototype.on=e.prototype.addListener,e.prototype.once=function(t,e){function r(){this.removeListener(t,r),i||(i=!0,e.apply(this,arguments))}if(!n(e))throw TypeError("listener must be a function");var i=!1;return r.listener=e,this.on(t,r),this},e.prototype.removeListener=function(t,e){var r,o,s,a;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],s=r.length,o=-1,r===e||n(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(i(r)){for(a=s;a-->0;)if(r[a]===e||r[a].listener&&r[a].listener===e){o=a;break}if(0>o)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},e.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],n(r))this.removeListener(t,r);else for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},e.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},e.listenerCount=function(t,e){var r;return r=t._events&&t._events[e]?n(t._events[e])?1:t._events[e].length:0}},function(t,e,n){function r(t){return function(){var e={};if("request"in t)throw new Error("Socket already has a request property");var n=t;return t.onmessage=function(r){var i=r.data;if("{"==i.charAt(0)){var o=JSON.parse(i),s=e[o.id];if(s)clearTimeout(s.timeout),delete e[o.id],o.error?s.reject(new Error(o.error)):s.resolve(o.message);else if("id"in o)try{n.onrequest(o.message).then(function(e){var n={id:o.id,message:e,error:null};t.send(JSON.stringify(n))}).catch(function(e){var n={id:o.id,message:null,error:e.message||e.toString()};t.send(JSON.stringify(n))})}catch(a){var c={id:o.id,message:null,error:a.message||a.toString()};t.send(JSON.stringify(c))}else n.onrequest(o.message)}},n.request=function(n){return new o(function(r,o){var a=i.v1(),c={id:a,message:n};e[a]={resolve:r,reject:o,timeout:setTimeout(function(){delete e[a],o(new Error("Timeout"))},s)},t.send(JSON.stringify(c))})},n.notify=function(e){return new o(function(n){var r={message:e};t.send(JSON.stringify(r),function(){n(null)})})},n.onrequest=function(){return o.reject("No onrequest handler implemented")},n}()}var i=n(63),o=n(39),s=6e4;t.exports=r},function(t){function e(t,e){this.id=t,this._send=e,this.listeners={}}e.prototype.send=function(t,e){return this._send(this.id,t,e)},e.prototype.on=function(t,e){t in this.listeners||(this.listeners[t]=[]),this.listeners[t].push(e)},e.prototype.emit=function(t,e,n){var r=this.listeners[t];if(r)for(var i=0,o=r.length;o>i;i++){var s=r[i];s(e,n)}},t.exports=e},function(t,e,n){"use strict";e.decode=e.parse=n(64),e.encode=e.stringify=n(65)},function(t,e,n){(function(t){function r(){var t=[].slice.call(arguments).join(" ");throw new Error([t,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}function i(t,e){for(var n in t)e(t[n],n)}var o=n(66);e.createHash=n(67),e.createHmac=n(68),e.randomBytes=function(e,n){if(!n||!n.call)return new t(o(e));try{n.call(this,void 0,new t(o(e)))}catch(r){n(r)}},e.getHashes=function(){return["sha1","sha256","sha512","md5","rmd160"]};var s=n(69)(e);e.pbkdf2=s.pbkdf2,e.pbkdf2Sync=s.pbkdf2Sync,i(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman"],function(t){e[t]=function(){r("sorry,",t,"is not implemented yet")}})}).call(e,n(50).Buffer)},function(t,e,n){var r=n(31),i=t.exports;for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o]);i.request=function(t,e){return t||(t={}),t.scheme="https",r.request.call(this,t,e)}},function(t,e,n){(function(t){function t(e,n,r){if(!(this instanceof t))return new t(e,n,r);var i,o=typeof e;if("number"===o)i=e>0?e>>>0:0;else if("string"===o)"base64"===n&&(e=k(e)),i=t.byteLength(e,n);else{if("object"!==o||null===e)throw new TypeError("must start with number, buffer, array or string");"Buffer"===e.type&&F(e.data)&&(e=e.data),i=+e.length>0?Math.floor(+e.length):0}if(this.length>B)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+B.toString(16)+" bytes");var s;t.TYPED_ARRAY_SUPPORT?s=t._augment(new Uint8Array(i)):(s=this,s.length=i,s._isBuffer=!0);var a;if(t.TYPED_ARRAY_SUPPORT&&"number"==typeof e.byteLength)s._set(e);else if(E(e))if(t.isBuffer(e))for(a=0;i>a;a++)s[a]=e.readUInt8(a);else for(a=0;i>a;a++)s[a]=(e[a]%256+256)%256;else if("string"===o)s.write(e,0,n);else if("number"===o&&!t.TYPED_ARRAY_SUPPORT&&!r)for(a=0;i>a;a++)s[a]=0;return s}function r(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r),r>i&&(r=i)):r=i;var o=e.length;if(o%2!==0)throw new Error("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;r>s;s++){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))throw new Error("Invalid hex string");t[n+s]=a}return s}function i(t,e,n,r){var i=C(T(e),t,n,r);return i}function o(t,e,n,r){var i=C(A(e),t,n,r);return i}function s(t,e,n,r){return o(t,e,n,r)}function a(t,e,n,r){var i=C(P(e),t,n,r);return i}function c(t,e,n,r){var i=C(j(e),t,n,r);return i}function u(t,e,n){return R.fromByteArray(0===e&&n===t.length?t:t.slice(e,n))}function h(t,e,n){var r="",i="";n=Math.min(t.length,n);for(var o=e;n>o;o++)t[o]<=127?(r+=O(i)+String.fromCharCode(t[o]),i=""):i+="%"+t[o].toString(16);return r+O(i)}function f(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;n>i;i++)r+=String.fromCharCode(t[i]);return r}function l(t,e,n){return f(t,e,n)}function p(t,e,n){var r=t.length;(!e||0>e)&&(e=0),(!n||0>n||n>r)&&(n=r);for(var i="",o=e;n>o;o++)i+=S(t[o]);return i}function d(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function v(t,e,n){if(t%1!==0||0>t)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function y(e,n,r,i,o,s){if(!t.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");if(n>o||s>n)throw new TypeError("value is out of bounds");if(r+i>e.length)throw new TypeError("index out of range")}function g(t,e,n,r){0>e&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);o>i;i++)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function m(t,e,n,r){0>e&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);o>i;i++)t[n+i]=e>>>8*(r?i:3-i)&255}function _(t,e,n,r,i,o){if(e>i||o>e)throw new TypeError("value is out of bounds");if(n+r>t.length)throw new TypeError("index out of range")}function b(t,e,n,r,i){return i||_(t,e,n,4,3.4028234663852886e38,-3.4028234663852886e38),M.write(t,e,n,r,23,4),n+4}function w(t,e,n,r,i){return i||_(t,e,n,8,1.7976931348623157e308,-1.7976931348623157e308),M.write(t,e,n,r,52,8),n+8}function k(t){for(t=x(t).replace(U,"");t.length%4!==0;)t+="=";return t}function x(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function E(e){return F(e)||t.isBuffer(e)||e&&"object"==typeof e&&"number"==typeof e.length}function S(t){return 16>t?"0"+t.toString(16):t.toString(16)}function T(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(127>=r)e.push(r);else{var i=n;r>=55296&&57343>=r&&n++;for(var o=encodeURIComponent(t.slice(i,n+1)).substr(1).split("%"),s=0;s<o.length;s++)e.push(parseInt(o[s],16))}}return e}function A(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e}function j(t){for(var e,n,r,i=[],o=0;o<t.length;o++)e=t.charCodeAt(o),n=e>>8,r=e%256,i.push(r),i.push(n);return i}function P(t){return R.toByteArray(t)}function C(t,e,n,r){for(var i=0;r>i&&!(i+n>=e.length||i>=t.length);i++)e[i+n]=t[i];return i}function O(t){try{return decodeURIComponent(t)}catch(e){return String.fromCharCode(65533)}}/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
var R=n(82),M=n(79),F=n(80);e.Buffer=t,e.SlowBuffer=t,e.INSPECT_MAX_BYTES=50,t.poolSize=8192;var B=1073741823;t.TYPED_ARRAY_SUPPORT=function(){try{var t=new ArrayBuffer(0),e=new Uint8Array(t);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(n){return!1}}(),t.isBuffer=function(t){return!(null==t||!t._isBuffer)},t.compare=function(e,n){if(!t.isBuffer(e)||!t.isBuffer(n))throw new TypeError("Arguments must be Buffers");for(var r=e.length,i=n.length,o=0,s=Math.min(r,i);s>o&&e[o]===n[o];o++);return o!==s&&(r=e[o],i=n[o]),i>r?-1:r>i?1:0},t.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},t.concat=function(e,n){if(!F(e))throw new TypeError("Usage: Buffer.concat(list[, length])");if(0===e.length)return new t(0);if(1===e.length)return e[0];var r;if(void 0===n)for(n=0,r=0;r<e.length;r++)n+=e[r].length;var i=new t(n),o=0;for(r=0;r<e.length;r++){var s=e[r];s.copy(i,o),o+=s.length}return i},t.byteLength=function(t,e){var n;switch(t+="",e||"utf8"){case"ascii":case"binary":case"raw":n=t.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=2*t.length;break;case"hex":n=t.length>>>1;break;case"utf8":case"utf-8":n=T(t).length;break;case"base64":n=P(t).length;break;default:n=t.length}return n},t.prototype.length=void 0,t.prototype.parent=void 0,t.prototype.toString=function(t,e,n){var r=!1;if(e>>>=0,n=void 0===n||1/0===n?this.length:n>>>0,t||(t="utf8"),0>e&&(e=0),n>this.length&&(n=this.length),e>=n)return"";for(;;)switch(t){case"hex":return p(this,e,n);case"utf8":case"utf-8":return h(this,e,n);case"ascii":return f(this,e,n);case"binary":return l(this,e,n);case"base64":return u(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return d(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}},t.prototype.equals=function(e){if(!t.isBuffer(e))throw new TypeError("Argument must be a Buffer");return 0===t.compare(this,e)},t.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},t.prototype.compare=function(e){if(!t.isBuffer(e))throw new TypeError("Argument must be a Buffer");return t.compare(this,e)},t.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},t.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},t.prototype.write=function(t,e,n,u){if(isFinite(e))isFinite(n)||(u=n,n=void 0);else{var h=u;u=e,e=n,n=h}e=Number(e)||0;var f=this.length-e;n?(n=Number(n),n>f&&(n=f)):n=f,u=String(u||"utf8").toLowerCase();var l;switch(u){case"hex":l=r(this,t,e,n);break;case"utf8":case"utf-8":l=i(this,t,e,n);break;case"ascii":l=o(this,t,e,n);break;case"binary":l=s(this,t,e,n);break;case"base64":l=a(this,t,e,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":l=c(this,t,e,n);break;default:throw new TypeError("Unknown encoding: "+u)}return l},t.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},t.prototype.slice=function(e,n){var r=this.length;if(e=~~e,n=void 0===n?r:~~n,0>e?(e+=r,0>e&&(e=0)):e>r&&(e=r),0>n?(n+=r,0>n&&(n=0)):n>r&&(n=r),e>n&&(n=e),t.TYPED_ARRAY_SUPPORT)return t._augment(this.subarray(e,n));for(var i=n-e,o=new t(i,void 0,!0),s=0;i>s;s++)o[s]=this[s+e];return o},t.prototype.readUInt8=function(t,e){return e||v(t,1,this.length),this[t]},t.prototype.readUInt16LE=function(t,e){return e||v(t,2,this.length),this[t]|this[t+1]<<8},t.prototype.readUInt16BE=function(t,e){return e||v(t,2,this.length),this[t]<<8|this[t+1]},t.prototype.readUInt32LE=function(t,e){return e||v(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},t.prototype.readUInt32BE=function(t,e){return e||v(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},t.prototype.readInt8=function(t,e){return e||v(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},t.prototype.readInt16LE=function(t,e){e||v(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},t.prototype.readInt16BE=function(t,e){e||v(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},t.prototype.readInt32LE=function(t,e){return e||v(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},t.prototype.readInt32BE=function(t,e){return e||v(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},t.prototype.readFloatLE=function(t,e){return e||v(t,4,this.length),M.read(this,t,!0,23,4)},t.prototype.readFloatBE=function(t,e){return e||v(t,4,this.length),M.read(this,t,!1,23,4)},t.prototype.readDoubleLE=function(t,e){return e||v(t,8,this.length),M.read(this,t,!0,52,8)},t.prototype.readDoubleBE=function(t,e){return e||v(t,8,this.length),M.read(this,t,!1,52,8)},t.prototype.writeUInt8=function(e,n,r){return e=+e,n>>>=0,r||y(this,e,n,1,255,0),t.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[n]=e,n+1},t.prototype.writeUInt16LE=function(e,n,r){return e=+e,n>>>=0,r||y(this,e,n,2,65535,0),t.TYPED_ARRAY_SUPPORT?(this[n]=e,this[n+1]=e>>>8):g(this,e,n,!0),n+2},t.prototype.writeUInt16BE=function(e,n,r){return e=+e,n>>>=0,r||y(this,e,n,2,65535,0),t.TYPED_ARRAY_SUPPORT?(this[n]=e>>>8,this[n+1]=e):g(this,e,n,!1),n+2},t.prototype.writeUInt32LE=function(e,n,r){return e=+e,n>>>=0,r||y(this,e,n,4,4294967295,0),t.TYPED_ARRAY_SUPPORT?(this[n+3]=e>>>24,this[n+2]=e>>>16,this[n+1]=e>>>8,this[n]=e):m(this,e,n,!0),n+4},t.prototype.writeUInt32BE=function(e,n,r){return e=+e,n>>>=0,r||y(this,e,n,4,4294967295,0),t.TYPED_ARRAY_SUPPORT?(this[n]=e>>>24,this[n+1]=e>>>16,this[n+2]=e>>>8,this[n+3]=e):m(this,e,n,!1),n+4},t.prototype.writeInt8=function(e,n,r){return e=+e,n>>>=0,r||y(this,e,n,1,127,-128),t.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),0>e&&(e=255+e+1),this[n]=e,n+1},t.prototype.writeInt16LE=function(e,n,r){return e=+e,n>>>=0,r||y(this,e,n,2,32767,-32768),t.TYPED_ARRAY_SUPPORT?(this[n]=e,this[n+1]=e>>>8):g(this,e,n,!0),n+2},t.prototype.writeInt16BE=function(e,n,r){return e=+e,n>>>=0,r||y(this,e,n,2,32767,-32768),t.TYPED_ARRAY_SUPPORT?(this[n]=e>>>8,this[n+1]=e):g(this,e,n,!1),n+2},t.prototype.writeInt32LE=function(e,n,r){return e=+e,n>>>=0,r||y(this,e,n,4,2147483647,-2147483648),t.TYPED_ARRAY_SUPPORT?(this[n]=e,this[n+1]=e>>>8,this[n+2]=e>>>16,this[n+3]=e>>>24):m(this,e,n,!0),n+4},t.prototype.writeInt32BE=function(e,n,r){return e=+e,n>>>=0,r||y(this,e,n,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),t.TYPED_ARRAY_SUPPORT?(this[n]=e>>>24,this[n+1]=e>>>16,this[n+2]=e>>>8,this[n+3]=e):m(this,e,n,!1),n+4},t.prototype.writeFloatLE=function(t,e,n){return b(this,t,e,!0,n)},t.prototype.writeFloatBE=function(t,e,n){return b(this,t,e,!1,n)},t.prototype.writeDoubleLE=function(t,e,n){return w(this,t,e,!0,n)},t.prototype.writeDoubleBE=function(t,e,n){return w(this,t,e,!1,n)},t.prototype.copy=function(e,n,r,i){var o=this;if(r||(r=0),i||0===i||(i=this.length),n||(n=0),i!==r&&0!==e.length&&0!==o.length){if(r>i)throw new TypeError("sourceEnd < sourceStart");if(0>n||n>=e.length)throw new TypeError("targetStart out of bounds");if(0>r||r>=o.length)throw new TypeError("sourceStart out of bounds");if(0>i||i>o.length)throw new TypeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-n<i-r&&(i=e.length-n+r);var s=i-r;if(1e3>s||!t.TYPED_ARRAY_SUPPORT)for(var a=0;s>a;a++)e[a+n]=this[a+r];else e._set(this.subarray(r,r+s),n)}},t.prototype.fill=function(t,e,n){if(t||(t=0),e||(e=0),n||(n=this.length),e>n)throw new TypeError("end < start");if(n!==e&&0!==this.length){if(0>e||e>=this.length)throw new TypeError("start out of bounds");if(0>n||n>this.length)throw new TypeError("end out of bounds");var r;if("number"==typeof t)for(r=e;n>r;r++)this[r]=t;else{var i=T(t.toString()),o=i.length;for(r=e;n>r;r++)this[r]=i[r%o]}return this}},t.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(t.TYPED_ARRAY_SUPPORT)return new t(this).buffer;for(var e=new Uint8Array(this.length),n=0,r=e.length;r>n;n+=1)e[n]=this[n];return e.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var I=t.prototype;t._augment=function(e){return e.constructor=t,e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=I.get,e.set=I.set,e.write=I.write,e.toString=I.toString,e.toLocaleString=I.toString,e.toJSON=I.toJSON,e.equals=I.equals,e.compare=I.compare,e.copy=I.copy,e.slice=I.slice,e.readUInt8=I.readUInt8,e.readUInt16LE=I.readUInt16LE,e.readUInt16BE=I.readUInt16BE,e.readUInt32LE=I.readUInt32LE,e.readUInt32BE=I.readUInt32BE,e.readInt8=I.readInt8,e.readInt16LE=I.readInt16LE,e.readInt16BE=I.readInt16BE,e.readInt32LE=I.readInt32LE,e.readInt32BE=I.readInt32BE,e.readFloatLE=I.readFloatLE,e.readFloatBE=I.readFloatBE,e.readDoubleLE=I.readDoubleLE,e.readDoubleBE=I.readDoubleBE,e.writeUInt8=I.writeUInt8,e.writeUInt16LE=I.writeUInt16LE,e.writeUInt16BE=I.writeUInt16BE,e.writeUInt32LE=I.writeUInt32LE,e.writeUInt32BE=I.writeUInt32BE,e.writeInt8=I.writeInt8,e.writeInt16LE=I.writeInt16LE,e.writeInt16BE=I.writeInt16BE,e.writeInt32LE=I.writeInt32LE,e.writeInt32BE=I.writeInt32BE,e.writeFloatLE=I.writeFloatLE,e.writeFloatBE=I.writeFloatBE,e.writeDoubleLE=I.writeDoubleLE,e.writeDoubleBE=I.writeDoubleBE,e.fill=I.fill,e.inspect=I.inspect,e.toArrayBuffer=I.toArrayBuffer,e};var U=/[^+\/0-9A-z]/g}).call(e,n(50).Buffer)},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(!t)throw new Error("id required");this.id=t,this.listeners=[],this.conversations={},this.connect()}var i=n(63),o=n(89).Promise,s=n(52),a=n(71),c=(n(60),n(57),n(56)),u=n(55);n(59),r.prototype.connect=function(t){if(this.disconnect(),t||(t=s["default"]()),"function"!=typeof t.connect)throw new Error("message bus must contain a function connect(params: {id: string, callback: function}) : string");if("function"!=typeof t.disconnect)throw new Error("message bus must contain a function disconnect(token: string)");if("function"!=typeof t.send)throw new Error("message bus must contain a function send(params: {id: string, message: *})");var e=null,n=new o(function(t){e=t}),r=t.connect({id:this.id,message:this._receive.bind(this),callback:e});return this.disconnect=function(){t.disconnect(r)},this.send=t.send,n},r.prototype._receive=function(t){if(t&&"id"in t&&"message"in t){var e=this,n=t.id,r=this.conversations[n];r&&r.length?r.forEach(function(e){e.deliver(t)}):(r||(r=[]),this.conversations[n]=r,this.listeners.forEach(function(i){var o=new a({id:n,self:e.id,other:t.from,context:{from:t.from},send:e.send});return r.push(o),o.deliver(t),e._process(i,o).then(function(){var t=r.indexOf(o);-1!==t&&r.splice(t,1),0===r.length&&delete e.conversations[n]})}))}},r.prototype.disconnect=function(){},r.prototype.send=function(){throw new Error("Cannot send: not connected")},r.prototype.listen=function(t,e){var n=new u;this.listeners.push(n);var r=n;return t&&(r=r.iif(t)),e&&(r=r.then(e)),r},r.prototype.listenOnce=function(t,e){var n=new u;this.listeners.push(n);var r=this,i=n;return t&&(i=i.iif(t)),i=i.then(function(t){var e=r.listeners.indexOf(n);return-1!==e&&r.listeners.splice(e,1),t}),e&&(i=i.then(e)),i},r.prototype.tell=function(t,e){var n=this,r=i.v4(),o=new a({id:r,self:this.id,other:t,context:{from:t},send:n.send});this.conversations[r]=[o];var s=new c(e);return setTimeout(function(){n._process(s,o).then(function(){delete n.conversations[r]})},0),s},r.prototype.ask=function(t,e,n){return this.tell(t,e).listen(n)},r.prototype._process=function(t,e){return new o(function(n){function r(t,i){t.execute(e,i).then(function(t){t.block?r(t.block,t.result):n(e)})}r(t)})},t.exports=r},function(t,e,n){"use strict";var r=n(89).Promise;e["pubsub-js"]=function(){var t=n(85);return{connect:function(e){var n=t.subscribe(e.id,function(t,n){e.message(n)});return"function"==typeof e.callback&&e.callback(),n},disconnect:function(e){t.unsubscribe(e)},send:function(e,n){t.publish(e,n)}}},e.pubnub=function(t){var e;if("undefined"!=typeof window){if("undefined"==typeof window.PUBNUB)throw new Error("Please load pubnub first in the browser");e=window.PUBNUB}else e=n(83);var i=e.init(t);return{connect:function(t){return i.subscribe({channel:t.id,message:t.message,connect:t.callback}),t.id},disconnect:function(t){i.unsubscribe(t)},send:function(t,e){return new r(function(n){i.publish({channel:t,message:e,callback:n})})}}},e["default"]=e["pubsub-js"]},function(t,e,n){t.exports=n(75)},function(t,e,n){function r(t){for(var e=t.getAllResponseHeaders().split(/\r?\n/),n={},r=0;r<e.length;r++){var i=e[r];if(""!==i){var o=i.match(/^([^:]+):\s*(.*)/);if(o){var s=o[1].toLowerCase(),a=o[2];void 0!==n[s]?c(n[s])?n[s].push(a):n[s]=[n[s],a]:n[s]=a}else n[i]=!0}}return n}var i=n(70),o=n(81),s=t.exports=function(){this.offset=0,this.readable=!0};o.inherits(s,i);var a={streaming:!0,status2:!0};s.prototype.getResponse=function(t){var e=String(t.responseType).toLowerCase();return"blob"===e?t.responseBlob||t.response:"arraybuffer"===e?t.response:t.responseText},s.prototype.getHeader=function(t){return this.headers[t.toLowerCase()]},s.prototype.handle=function(t){if(2===t.readyState&&a.status2){try{this.statusCode=t.status,this.headers=r(t)}catch(e){a.status2=!1}a.status2&&this.emit("ready")}else if(a.streaming&&3===t.readyState){try{this.statusCode||(this.statusCode=t.status,this.headers=r(t),this.emit("ready"))}catch(e){}try{this._emitData(t)}catch(e){a.streaming=!1}}else 4===t.readyState&&(this.statusCode||(this.statusCode=t.status,this.emit("ready")),this._emitData(t),t.error?this.emit("error",this.getResponse(t)):this.emit("end"),this.emit("close"))},s.prototype._emitData=function(t){var e=this.getResponse(t);return e.toString().match(/ArrayBuffer/)?(this.emit("data",new Uint8Array(e,this.offset)),void(this.offset=e.byteLength)):void(e.length>this.offset&&(this.emit("data",e.slice(this.offset)),this.offset=e.length))};var c=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,n){"use strict";function r(){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator")}{var i=(n(89).Promise,n(60));n(57)}r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.execute=function(t){var e=this;return t.receive().then(function(t){return{result:t,block:e.next}})},i.prototype.listen=function(t){var e=new r,n=this.then(e);return t&&(n=n.then(t)),n},t.exports=r},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this.message=t}var i=n(89).Promise,o=n(60),s=n(74).isPromise;n(57),n(55),r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.execute=function(t,e){var n,r=this;if("function"==typeof this.message){var o=this.message(e,t.context);n=s(o)?o:i.resolve(o)}else n=i.resolve(this.message);return n.then(function(e){var n=t.send(e),o=s(n)?n:i.resolve(n);return o.then(function(){return{result:e,block:r.next}})})},o.prototype.tell=function(t){var e=new r(t);return this.then(e)},o.prototype.ask=function(t,e){return this.tell(t).listen(e)},t.exports=r},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if("function"!=typeof t)throw new TypeError("Parameter callback must be a Function");this.callback=t}var i=n(89).Promise,o=n(60),s=n(74).isPromise;r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.execute=function(t,e){var n=this,r=this.callback(e,t.context),o=s(r)?r:i.resolve(r);return o.then(function(t){return{result:t,block:n.next}})},o.prototype.then=function(t){if("function"==typeof t&&(t=new r(t)),!(t instanceof o))throw new TypeError("Parameter next must be a Block or function");return t.previous=this,this.next=t,t},t.exports=r},function(t,e,n){"use strict";function r(t,e){var n,i;if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if("function"==typeof t?(n=t,i=e):(n=null,i=t),n){if("function"!=typeof n)throw new TypeError("Parameter decision must be a function")}else n=function(t){return t};if(i&&i instanceof Function)throw new TypeError("Parameter choices must be an object");if(this.decision=n,this.choices={},i){var o=this;Object.keys(i).forEach(function(t){o.addChoice(t,i[t])})}}var i=n(89).Promise,o=n(60),s=n(74).isPromise;n(57),r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.execute=function(t,e){var n=this,r=this.decision(e,t.context),o=s(r)?r:i.resolve(r);return o.then(function(t){var r=n.choices[t];if(r||(r=n.choices["default"]),!r)throw new Error('Block with id "'+t+'" not found');return{result:e,block:r}})},r.prototype.addChoice=function(t,e){if("string"!=typeof t)throw new TypeError("String expected as choice id");if(!(e instanceof o))throw new TypeError("Block expected as choice");if(t in this.choices)throw new Error('Choice with id "'+t+'" already exists');for(var n=e;n&&n.previous;)n=n.previous;return this.choices[t]=n,this},o.prototype.decide=function(t,e){var n=new r(t,e);return this.then(n)},t.exports=r},function(t,e,n){"use strict";function r(t,e,n){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(this.condition=t instanceof Function?t:t instanceof RegExp?function(e){return t.test(e)}:function(e){return e==t},e&&!(e instanceof o))throw new TypeError("Parameter trueBlock must be a Block");if(n&&!(n instanceof o))throw new TypeError("Parameter falseBlock must be a Block");this.trueBlock=e||null,this.falseBlock=n||null}var i=n(89).Promise,o=n(60),s=n(74).isPromise;n(57),r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.execute=function(t,e){var n=this,r=this.condition(e,t.context),o=s(r)?r:i.resolve(r);return o.then(function(t){var r=t?n.trueBlock||n.next:n.falseBlock;return{result:e,block:r}})},o.prototype.iif=function(t,e,n){var i=new r(t,e,n);return this.then(i)},t.exports=r},function(t){"use strict";function e(){this.next=null,this.previous=null}e.prototype.execute=function(){throw new Error("Cannot run an abstract Block")},t.exports=e},function(t,e,n){var r;(function(t,i){!function(o){function s(t){throw RangeError(M[t])}function a(t,e){for(var n=t.length;n--;)t[n]=e(t[n]);return t}function c(t,e){return a(t.split(R),e).join(".")}function u(t){for(var e,n,r=[],i=0,o=t.length;o>i;)e=t.charCodeAt(i++),e>=55296&&56319>=e&&o>i?(n=t.charCodeAt(i++),56320==(64512&n)?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--)):r.push(e);return r}function h(t){return a(t,function(t){var e="";return t>65535&&(t-=65536,e+=I(t>>>10&1023|55296),t=56320|1023&t),e+=I(t)}).join("")}function f(t){return 10>t-48?t-22:26>t-65?t-65:26>t-97?t-97:k}function l(t,e){return t+22+75*(26>t)-((0!=e)<<5)}function p(t,e,n){var r=0;for(t=n?B(t/T):t>>1,t+=B(t/e);t>F*E>>1;r+=k)t=B(t/F);return B(r+(F+1)*t/(t+S))}function d(t){var e,n,r,i,o,a,c,u,l,d,v=[],y=t.length,g=0,m=j,_=A;for(n=t.lastIndexOf(P),0>n&&(n=0),r=0;n>r;++r)t.charCodeAt(r)>=128&&s("not-basic"),v.push(t.charCodeAt(r));for(i=n>0?n+1:0;y>i;){for(o=g,a=1,c=k;i>=y&&s("invalid-input"),u=f(t.charCodeAt(i++)),(u>=k||u>B((w-g)/a))&&s("overflow"),g+=u*a,l=_>=c?x:c>=_+E?E:c-_,!(l>u);c+=k)d=k-l,a>B(w/d)&&s("overflow"),a*=d;e=v.length+1,_=p(g-o,e,0==o),B(g/e)>w-m&&s("overflow"),m+=B(g/e),g%=e,v.splice(g++,0,m)}return h(v)}function v(t){var e,n,r,i,o,a,c,h,f,d,v,y,g,m,_,b=[];for(t=u(t),y=t.length,e=j,n=0,o=A,a=0;y>a;++a)v=t[a],128>v&&b.push(I(v));for(r=i=b.length,i&&b.push(P);y>r;){for(c=w,a=0;y>a;++a)v=t[a],v>=e&&c>v&&(c=v);for(g=r+1,c-e>B((w-n)/g)&&s("overflow"),n+=(c-e)*g,e=c,a=0;y>a;++a)if(v=t[a],e>v&&++n>w&&s("overflow"),v==e){for(h=n,f=k;d=o>=f?x:f>=o+E?E:f-o,!(d>h);f+=k)_=h-d,m=k-d,b.push(I(l(d+_%m,0))),h=B(_/m);b.push(I(l(h,0))),o=p(n,g,r==i),n=0,++r}++n,++e}return b.join("")}function y(t){return c(t,function(t){return C.test(t)?d(t.slice(4).toLowerCase()):t})}function g(t){return c(t,function(t){return O.test(t)?"xn--"+v(t):t})}var m="object"==typeof e&&e,_=("object"==typeof t&&t&&t.exports==m&&t,"object"==typeof i&&i);(_.global===_||_.window===_)&&(o=_);var b,w=2147483647,k=36,x=1,E=26,S=38,T=700,A=72,j=128,P="-",C=/^xn--/,O=/[^ -~]/,R=/\x2E|\u3002|\uFF0E|\uFF61/g,M={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},F=k-x,B=Math.floor,I=String.fromCharCode;b={version:"1.2.4",ucs2:{decode:u,encode:h},decode:d,encode:v,toASCII:g,toUnicode:y},r=function(){return b}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))}(this)}).call(e,n(88)(t),function(){return this}())},function(t,e,n){(function(e){function n(){for(;i.next;){i=i.next;var t=i.task;i.task=void 0;var e=i.domain;e&&(i.domain=void 0,e.enter());try{t()}catch(r){if(c)throw e&&e.exit(),setTimeout(n,0),e&&e.enter(),r;setTimeout(function(){throw r},0)}e&&e.exit()}s=!1}function r(t){o=o.next={task:t,domain:c&&e.domain,next:null},s||(s=!0,a())}var i={task:void 0,next:null},o=i,s=!1,a=void 0,c=!1;if("undefined"!=typeof e&&e.nextTick)c=!0,a=function(){e.nextTick(n)};else if("function"==typeof setImmediate)a="undefined"!=typeof window?setImmediate.bind(window,n):function(){setImmediate(n)};else if("undefined"!=typeof MessageChannel){var u=new MessageChannel;u.port1.onmessage=n,a=function(){u.port2.postMessage(0)}}else a=function(){setTimeout(n,0)};t.exports=r}).call(e,n(87))},function(t,e,n){var r;(function(i){(function(){function o(t,e,n){var r=e&&n||0,i=0;for(e=e||[],t.toLowerCase().replace(/[0-9a-f]{2}/g,function(t){16>i&&(e[r+i++]=g[t])});16>i;)e[r+i++]=0;return e}function s(t,e){var n=e||0,r=y;return r[t[n++]]+r[t[n++]]+r[t[n++]]+r[t[n++]]+"-"+r[t[n++]]+r[t[n++]]+"-"+r[t[n++]]+r[t[n++]]+"-"+r[t[n++]]+r[t[n++]]+"-"+r[t[n++]]+r[t[n++]]+r[t[n++]]+r[t[n++]]+r[t[n++]]+r[t[n++]]}function a(t,e,n){var r=e&&n||0,i=e||[];t=t||{};var o=null!=t.clockseq?t.clockseq:w,a=null!=t.msecs?t.msecs:(new Date).getTime(),c=null!=t.nsecs?t.nsecs:x+1,u=a-k+(c-x)/1e4;if(0>u&&null==t.clockseq&&(o=o+1&16383),(0>u||a>k)&&null==t.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");k=a,x=c,w=o,a+=122192928e5;var h=(1e4*(268435455&a)+c)%4294967296;i[r++]=h>>>24&255,i[r++]=h>>>16&255,i[r++]=h>>>8&255,i[r++]=255&h;var f=a/4294967296*1e4&268435455;i[r++]=f>>>8&255,i[r++]=255&f,i[r++]=f>>>24&15|16,i[r++]=f>>>16&255,i[r++]=o>>>8|128,i[r++]=255&o;for(var l=t.node||b,p=0;6>p;p++)i[r+p]=l[p];return e?e:s(i)}function c(t,e,n){var r=e&&n||0;"string"==typeof t&&(e="binary"==t?new v(16):null,t=null),t=t||{};var i=t.random||(t.rng||u)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e)for(var o=0;16>o;o++)e[r+o]=i[o];return e||s(i)}var u,h=this;try{var f=n(48).randomBytes;u=f&&function(){return f(16)}}catch(l){}if(!u&&h.crypto&&crypto.getRandomValues){var p=new Uint8Array(16);u=function(){return crypto.getRandomValues(p),p}}if(!u){var d=new Array(16);u=function(){for(var t,e=0;16>e;e++)0===(3&e)&&(t=4294967296*Math.random()),d[e]=t>>>((3&e)<<3)&255;return d}}for(var v="function"==typeof i?i:Array,y=[],g={},m=0;256>m;m++)y[m]=(m+256).toString(16).substr(1),g[y[m]]=m;var _=u(),b=[1|_[0],_[1],_[2],_[3],_[4],_[5]],w=16383&(_[6]<<8|_[7]),k=0,x=0,E=c;E.v1=a,E.v4=c,E.parse=o,E.unparse=s,E.BufferClass=v;r=function(){return E}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))}).call(this)}).call(e,n(50).Buffer)},function(t){"use strict";function e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,r,i,o){r=r||"&",i=i||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(r);var c=1e3;o&&"number"==typeof o.maxKeys&&(c=o.maxKeys);var u=t.length;c>0&&u>c&&(u=c);for(var h=0;u>h;++h){var f,l,p,d,v=t[h].replace(a,"%20"),y=v.indexOf(i);y>=0?(f=v.substr(0,y),l=v.substr(y+1)):(f=v,l=""),p=decodeURIComponent(f),d=decodeURIComponent(l),e(s,p)?n(s[p])?s[p].push(d):s[p]=[s[p],d]:s[p]=d}return s};var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t){"use strict";function e(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var n=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,o,s,a){return o=o||"&",s=s||"=",null===t&&(t=void 0),"object"==typeof t?e(i(t),function(i){var a=encodeURIComponent(n(i))+s;return r(t[i])?e(t[i],function(t){return a+encodeURIComponent(n(t))}).join(o):a+encodeURIComponent(n(t[i]))}).join(o):a?encodeURIComponent(n(a))+s+encodeURIComponent(n(t)):""};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},i=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},function(t,e,n){(function(e,r){!function(){var i=("undefined"==typeof window?e:window)||{};_crypto=i.crypto||i.msCrypto||n(77),t.exports=function(t){if(_crypto.getRandomValues){var e=new r(t);return _crypto.getRandomValues(e),e}if(_crypto.randomBytes)return _crypto.randomBytes(t);throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}}()}).call(e,function(){return this}(),n(50).Buffer)},function(t,e,n){(function(e){function r(t){return function(){var n=[],r={update:function(t,r){return e.isBuffer(t)||(t=new e(t,r)),n.push(t),this},digest:function(r){var i=e.concat(n),o=t(i);return n=null,r?o.toString(r):o}};return r}}var i=n(90),o=r(n(78)),s=r(n(99));t.exports=function(t){return"md5"===t?new o:"rmd160"===t?new s:i(t)}}).call(e,n(50).Buffer)},function(t,e,n){(function(e){function r(t,n){if(!(this instanceof r))return new r(t,n);this._opad=c,this._alg=t;var s="sha512"===t?128:64;n=this._key=e.isBuffer(n)?n:new e(n),n.length>s?n=i(t).update(n).digest():n.length<s&&(n=e.concat([n,o],s));for(var a=this._ipad=new e(s),c=this._opad=new e(s),u=0;s>u;u++)a[u]=54^n[u],c[u]=92^n[u];this._hash=i(t).update(a)}var i=n(67),o=new e(128);o.fill(0),t.exports=r,r.prototype.update=function(t,e){return this._hash.update(t,e),this},r.prototype.digest=function(t){var e=this._hash.digest();return i(this._alg).update(this._opad).update(e).digest(t)}}).call(e,n(50).Buffer)},function(t,e,n){var r=n(93);t.exports=function(t,e){e=e||{};var n=r(t);return e.pbkdf2=n.pbkdf2,e.pbkdf2Sync=n.pbkdf2Sync,e}},function(t,e,n){function r(){i.call(this)}t.exports=r;var i=n(44).EventEmitter,o=n(92);o(r,i),r.Readable=n(94),r.Writable=n(95),r.Duplex=n(96),r.Transform=n(97),r.PassThrough=n(98),r.Stream=r,r.prototype.pipe=function(t,e){function n(e){t.writable&&!1===t.write(e)&&u.pause&&u.pause()}function r(){u.readable&&u.resume&&u.resume()}function o(){h||(h=!0,t.end())}function s(){h||(h=!0,"function"==typeof t.destroy&&t.destroy())}function a(t){if(c(),0===i.listenerCount(this,"error"))throw t}function c(){u.removeListener("data",n),t.removeListener("drain",r),u.removeListener("end",o),u.removeListener("close",s),u.removeListener("error",a),t.removeListener("error",a),u.removeListener("end",c),u.removeListener("close",c),t.removeListener("close",c)}var u=this;u.on("data",n),t.on("drain",r),t._isStdio||e&&e.end===!1||(u.on("end",o),u.on("close",s));var h=!1;return u.on("error",a),t.on("error",a),u.on("end",c),u.on("close",c),t.on("close",c),t.emit("pipe",u),t}},function(t,e,n){function r(t){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this.id=t&&t.id||i.v4(),this.self=t&&t.self||null,this.other=t&&t.other||null,this.context=t&&t.context||{},this._send=t&&t.send||null,this._inbox=[],this._receivers=[]}var i=n(63),o=n(89).Promise;r.prototype.send=function(t){return this._send(this.other,{id:this.id,from:this.self,to:this.other,message:t})},r.prototype.deliver=function(t){if(this._receivers.length){var e=this._receivers.shift();e(t.message)}else this._inbox.push(t.message)},r.prototype.receive=function(){var t=this;return this._inbox.length?o.resolve(this._inbox.shift()):new o(function(e){t._receivers.push(e)})},t.exports=r},function(t,e){!function(){function t(t){this.message=t}var n=e,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.prototype=new Error,t.prototype.name="InvalidCharacterError",n.btoa||(n.btoa=function(e){for(var n,i,o=0,s=r,a="";e.charAt(0|o)||(s="=",o%1);a+=s.charAt(63&n>>8-o%1*8)){if(i=e.charCodeAt(o+=.75),i>255)throw new t("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");n=n<<8|i}return a}),n.atob||(n.atob=function(e){if(e=e.replace(/=+$/,""),e.length%4==1)throw new t("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,i,o=0,s=0,a="";i=e.charAt(s++);~i&&(n=o%4?64*n+i:i,o++%4)?a+=String.fromCharCode(255&n>>(-2*o&6)):0)i=r.indexOf(i);return a})}()},function(t){t.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e){e.isPromise=function(t){return t&&"function"==typeof t.then&&"function"==typeof t["catch"]}},function(t,e,n){(function(e){"use strict";function r(t){t=t||{},t.keepAlive=t.keepAlive!==!1,t.keepAliveMsecs=t.keepAliveMsecs||t.maxKeepAliveTime,u.call(this,t);var e=this;e.maxKeepAliveRequests=parseInt(t.maxKeepAliveRequests,10)||0,e.createSocketCount=0,e.timeoutSocketCount=0,e.requestFinishedCount=0,e.removeAllListeners("free"),e.on("free",function(t,n){e.requestFinishedCount++,t._requestCount++;var r=e.getName(n);if(o("agent.on(free)",r),!e.isDestroyed(t)&&e.requests[r]&&e.requests[r].length)e.requests[r].shift().onSocket(t),0===e.requests[r].length&&delete e.requests[r];else{var i=t._httpMessage;if(i&&i.shouldKeepAlive&&!e.isDestroyed(t)&&e.options.keepAlive){var s=e.freeSockets[r],a=s?s.length:0,c=a;e.sockets[r]&&(c+=e.sockets[r].length),c>=e.maxSockets||a>=e.maxFreeSockets?(e.removeSocket(t,n),t.destroy()):(s=s||[],e.freeSockets[r]=s,t.setKeepAlive(!0,e.keepAliveMsecs),t.unref&&t.unref(),t._httpMessage=null,e.removeSocket(t,n),s.push(t),e.keepAliveMsecs&&t._events&&Array.isArray(t._events.timeout)&&(t.removeAllListeners("timeout"),t.setTimeout(e.keepAliveMsecs,t._maxKeepAliveTimeout)))}else e.removeSocket(t,n),t.destroy()}})}function i(t){r.call(this,t),this.defaultPort=443,this.protocol="https:"}var o,s=n(31),a=n(49),c=n(81);o=e.env.NODE_DEBUG&&/agentkeepalive/.test(e.env.NODE_DEBUG)?function(){console.error.apply(console,arguments)}:function(){};var u=s.Agent;(0===e.version.indexOf("v0.8.")||0===e.version.indexOf("v0.10."))&&(u=n(84).Agent,o("%s use _http_agent",e.version)),c.inherits(r,u),t.exports=r,r.prototype.createSocket=function(t,e){var n=this,r=u.prototype.createSocket.call(this,t,e);return r._requestCount=0,n.keepAliveMsecs&&(r._maxKeepAliveTimeout=function(){o("maxKeepAliveTimeout, socket destroy()"),r.destroy(),n.timeoutSocketCount++},r.setTimeout(n.keepAliveMsecs,r._maxKeepAliveTimeout),r.setNoDelay(!0)),this.createSocketCount++,r},r.prototype.removeSocket=function(t,e){u.prototype.removeSocket.call(this,t,e);var n=this.getName(e);if(o("removeSocket",n,"destroyed:",this.isDestroyed(t)),this.isDestroyed(t)&&this.freeSockets[n]){var r=this.freeSockets[n].indexOf(t);-1!==r&&(this.freeSockets[n].splice(r,1),0===this.freeSockets[n].length&&delete this.freeSockets[n])}},c.inherits(i,r),i.prototype.createConnection=a.globalAgent.createConnection,i.prototype.getName=function(t){var e=r.prototype.getName.call(this,t);return e+=":",t.ca&&(e+=t.ca),e+=":",t.cert&&(e+=t.cert),e+=":",t.ciphers&&(e+=t.ciphers),e+=":",t.key&&(e+=t.key),e+=":",t.pfx&&(e+=t.pfx),e+=":",void 0!==t.rejectUnauthorized&&(e+=t.rejectUnauthorized),e
},r.HttpsAgent=i}).call(e,n(87))},function(t,e,n){"use strict";var r=n(86)();t.exports=r},function(){},function(t,e,n){function r(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var n=1732584193,r=-271733879,i=-1732584194,h=271733878,f=0;f<t.length;f+=16){var l=n,p=r,d=i,v=h;n=o(n,r,i,h,t[f+0],7,-680876936),h=o(h,n,r,i,t[f+1],12,-389564586),i=o(i,h,n,r,t[f+2],17,606105819),r=o(r,i,h,n,t[f+3],22,-1044525330),n=o(n,r,i,h,t[f+4],7,-176418897),h=o(h,n,r,i,t[f+5],12,1200080426),i=o(i,h,n,r,t[f+6],17,-1473231341),r=o(r,i,h,n,t[f+7],22,-45705983),n=o(n,r,i,h,t[f+8],7,1770035416),h=o(h,n,r,i,t[f+9],12,-1958414417),i=o(i,h,n,r,t[f+10],17,-42063),r=o(r,i,h,n,t[f+11],22,-1990404162),n=o(n,r,i,h,t[f+12],7,1804603682),h=o(h,n,r,i,t[f+13],12,-40341101),i=o(i,h,n,r,t[f+14],17,-1502002290),r=o(r,i,h,n,t[f+15],22,1236535329),n=s(n,r,i,h,t[f+1],5,-165796510),h=s(h,n,r,i,t[f+6],9,-1069501632),i=s(i,h,n,r,t[f+11],14,643717713),r=s(r,i,h,n,t[f+0],20,-373897302),n=s(n,r,i,h,t[f+5],5,-701558691),h=s(h,n,r,i,t[f+10],9,38016083),i=s(i,h,n,r,t[f+15],14,-660478335),r=s(r,i,h,n,t[f+4],20,-405537848),n=s(n,r,i,h,t[f+9],5,568446438),h=s(h,n,r,i,t[f+14],9,-1019803690),i=s(i,h,n,r,t[f+3],14,-187363961),r=s(r,i,h,n,t[f+8],20,1163531501),n=s(n,r,i,h,t[f+13],5,-1444681467),h=s(h,n,r,i,t[f+2],9,-51403784),i=s(i,h,n,r,t[f+7],14,1735328473),r=s(r,i,h,n,t[f+12],20,-1926607734),n=a(n,r,i,h,t[f+5],4,-378558),h=a(h,n,r,i,t[f+8],11,-2022574463),i=a(i,h,n,r,t[f+11],16,1839030562),r=a(r,i,h,n,t[f+14],23,-35309556),n=a(n,r,i,h,t[f+1],4,-1530992060),h=a(h,n,r,i,t[f+4],11,1272893353),i=a(i,h,n,r,t[f+7],16,-155497632),r=a(r,i,h,n,t[f+10],23,-1094730640),n=a(n,r,i,h,t[f+13],4,681279174),h=a(h,n,r,i,t[f+0],11,-358537222),i=a(i,h,n,r,t[f+3],16,-722521979),r=a(r,i,h,n,t[f+6],23,76029189),n=a(n,r,i,h,t[f+9],4,-640364487),h=a(h,n,r,i,t[f+12],11,-421815835),i=a(i,h,n,r,t[f+15],16,530742520),r=a(r,i,h,n,t[f+2],23,-995338651),n=c(n,r,i,h,t[f+0],6,-198630844),h=c(h,n,r,i,t[f+7],10,1126891415),i=c(i,h,n,r,t[f+14],15,-1416354905),r=c(r,i,h,n,t[f+5],21,-57434055),n=c(n,r,i,h,t[f+12],6,1700485571),h=c(h,n,r,i,t[f+3],10,-1894986606),i=c(i,h,n,r,t[f+10],15,-1051523),r=c(r,i,h,n,t[f+1],21,-2054922799),n=c(n,r,i,h,t[f+8],6,1873313359),h=c(h,n,r,i,t[f+15],10,-30611744),i=c(i,h,n,r,t[f+6],15,-1560198380),r=c(r,i,h,n,t[f+13],21,1309151649),n=c(n,r,i,h,t[f+4],6,-145523070),h=c(h,n,r,i,t[f+11],10,-1120210379),i=c(i,h,n,r,t[f+2],15,718787259),r=c(r,i,h,n,t[f+9],21,-343485551),n=u(n,l),r=u(r,p),i=u(i,d),h=u(h,v)}return Array(n,r,i,h)}function i(t,e,n,r,i,o){return u(h(u(u(e,t),u(r,o)),i),n)}function o(t,e,n,r,o,s,a){return i(e&n|~e&r,t,e,o,s,a)}function s(t,e,n,r,o,s,a){return i(e&r|n&~r,t,e,o,s,a)}function a(t,e,n,r,o,s,a){return i(e^n^r,t,e,o,s,a)}function c(t,e,n,r,o,s,a){return i(n^(e|~r),t,e,o,s,a)}function u(t,e){var n=(65535&t)+(65535&e),r=(t>>16)+(e>>16)+(n>>16);return r<<16|65535&n}function h(t,e){return t<<e|t>>>32-e}var f=n(91);t.exports=function(t){return f.hash(t,r,16)}},function(t,e){e.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,u=c>>1,h=-7,f=n?i-1:0,l=n?-1:1,p=t[e+f];for(f+=l,o=p&(1<<-h)-1,p>>=-h,h+=a;h>0;o=256*o+t[e+f],f+=l,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=r;h>0;s=256*s+t[e+f],f+=l,h-=8);if(0===o)o=1-u;else{if(o===c)return s?0/0:1/0*(p?-1:1);s+=Math.pow(2,r),o-=u}return(p?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,a,c,u=8*o-i-1,h=(1<<u)-1,f=h>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,v=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||1/0===e?(a=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),e+=s+f>=1?l/c:l*Math.pow(2,1-f),e*c>=2&&(s++,c/=2),s+f>=h?(a=0,s=h):s+f>=1?(a=(e*c-1)*Math.pow(2,i),s+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;t[n+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;t[n+p]=255&s,p+=d,s/=256,u-=8);t[n+p-d]|=128*v}},function(t){var e=Array.isArray,n=Object.prototype.toString;t.exports=e||function(t){return!!t&&"[object Array]"==n.call(t)}},function(t,e,n){(function(t,r){function i(t,n){var r={seen:[],stylize:s};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),v(n)?r.showHidden=n:n&&e._extend(r,n),w(r.showHidden)&&(r.showHidden=!1),w(r.depth)&&(r.depth=2),w(r.colors)&&(r.colors=!1),w(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),c(r,t,r.depth)}function o(t,e){var n=i.styles[e];return n?"["+i.colors[n][0]+"m"+t+"["+i.colors[n][1]+"m":t}function s(t){return t}function a(t){var e={};return t.forEach(function(t){e[t]=!0}),e}function c(t,n,r){if(t.customInspect&&n&&T(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return _(i)||(i=c(t,i,r)),i}var o=u(t,n);if(o)return o;var s=Object.keys(n),v=a(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),S(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return h(n);if(0===s.length){if(T(n)){var y=n.name?": "+n.name:"";return t.stylize("[Function"+y+"]","special")}if(k(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(E(n))return t.stylize(Date.prototype.toString.call(n),"date");if(S(n))return h(n)}var g="",m=!1,b=["{","}"];if(d(n)&&(m=!0,b=["[","]"]),T(n)){var w=n.name?": "+n.name:"";g=" [Function"+w+"]"}if(k(n)&&(g=" "+RegExp.prototype.toString.call(n)),E(n)&&(g=" "+Date.prototype.toUTCString.call(n)),S(n)&&(g=" "+h(n)),0===s.length&&(!m||0==n.length))return b[0]+g+b[1];if(0>r)return k(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special");t.seen.push(n);var x;return x=m?f(t,n,r,v,s):s.map(function(e){return l(t,n,r,v,e,m)}),t.seen.pop(),p(x,g,b)}function u(t,e){if(w(e))return t.stylize("undefined","undefined");if(_(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return m(e)?t.stylize(""+e,"number"):v(e)?t.stylize(""+e,"boolean"):y(e)?t.stylize("null","null"):void 0}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,n,r,i){for(var o=[],s=0,a=e.length;a>s;++s)o.push(O(e,String(s))?l(t,e,n,r,String(s),!0):"");return i.forEach(function(i){i.match(/^\d+$/)||o.push(l(t,e,n,r,i,!0))}),o}function l(t,e,n,r,i,o){var s,a,u;if(u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},u.get?a=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(a=t.stylize("[Setter]","special")),O(r,i)||(s="["+i+"]"),a||(t.seen.indexOf(u.value)<0?(a=y(n)?c(t,u.value,null):c(t,u.value,n-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),w(s)){if(o&&i.match(/^\d+$/))return a;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function p(t,e,n){var r=0,i=t.reduce(function(t,e){return r++,e.indexOf("\n")>=0&&r++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function d(t){return Array.isArray(t)}function v(t){return"boolean"==typeof t}function y(t){return null===t}function g(t){return null==t}function m(t){return"number"==typeof t}function _(t){return"string"==typeof t}function b(t){return"symbol"==typeof t}function w(t){return void 0===t}function k(t){return x(t)&&"[object RegExp]"===j(t)}function x(t){return"object"==typeof t&&null!==t}function E(t){return x(t)&&"[object Date]"===j(t)}function S(t){return x(t)&&("[object Error]"===j(t)||t instanceof Error)}function T(t){return"function"==typeof t}function A(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function j(t){return Object.prototype.toString.call(t)}function P(t){return 10>t?"0"+t.toString(10):t.toString(10)}function C(){var t=new Date,e=[P(t.getHours()),P(t.getMinutes()),P(t.getSeconds())].join(":");return[t.getDate(),B[t.getMonth()],e].join(" ")}function O(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var R=/%[sdj%]/g;e.format=function(t){if(!_(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(i(arguments[n]));return e.join(" ")}for(var n=1,r=arguments,o=r.length,s=String(t).replace(R,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return t}}),a=r[n];o>n;a=r[++n])s+=y(a)||!x(a)?" "+a:" "+i(a);return s},e.deprecate=function(n,i){function o(){if(!s){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),s=!0}return n.apply(this,arguments)}if(w(t.process))return function(){return e.deprecate(n,i).apply(this,arguments)};if(r.noDeprecation===!0)return n;var s=!1;return o};var M,F={};e.debuglog=function(t){if(w(M)&&(M=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!F[t])if(new RegExp("\\b"+t+"\\b","i").test(M)){var n=r.pid;F[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else F[t]=function(){};return F[t]},e.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=d,e.isBoolean=v,e.isNull=y,e.isNullOrUndefined=g,e.isNumber=m,e.isString=_,e.isSymbol=b,e.isUndefined=w,e.isRegExp=k,e.isObject=x,e.isDate=E,e.isError=S,e.isFunction=T,e.isPrimitive=A,e.isBuffer=n(100);var B=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];e.log=function(){console.log("%s - %s",C(),e.format.apply(e,arguments))},e.inherits=n(140),e._extend=function(t,e){if(!e||!x(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(e,function(){return this}(),n(87))},function(t,e){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function e(t){var e=t.charCodeAt(0);return e===s?62:e===a?63:c>e?-1:c+10>e?e-c+26+26:h+26>e?e-h:u+26>e?e-u+26:void 0}function r(t){function n(t){u[f++]=t}var r,i,s,a,c,u;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var h=t.length;c="="===t.charAt(h-2)?2:"="===t.charAt(h-1)?1:0,u=new o(3*t.length/4-c),s=c>0?t.length-4:t.length;var f=0;for(r=0,i=0;s>r;r+=4,i+=3)a=e(t.charAt(r))<<18|e(t.charAt(r+1))<<12|e(t.charAt(r+2))<<6|e(t.charAt(r+3)),n((16711680&a)>>16),n((65280&a)>>8),n(255&a);return 2===c?(a=e(t.charAt(r))<<2|e(t.charAt(r+1))>>4,n(255&a)):1===c&&(a=e(t.charAt(r))<<10|e(t.charAt(r+1))<<4|e(t.charAt(r+2))>>2,n(a>>8&255),n(255&a)),u}function i(t){function e(t){return n.charAt(t)}function r(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}var i,o,s,a=t.length%3,c="";for(i=0,s=t.length-a;s>i;i+=3)o=(t[i]<<16)+(t[i+1]<<8)+t[i+2],c+=r(o);switch(a){case 1:o=t[t.length-1],c+=e(o>>2),c+=e(o<<4&63),c+="==";break;case 2:o=(t[t.length-2]<<8)+t[t.length-1],c+=e(o>>10),c+=e(o>>4&63),c+=e(o<<2&63),c+="="}return c}var o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="+".charCodeAt(0),a="/".charCodeAt(0),c="0".charCodeAt(0),u="a".charCodeAt(0),h="A".charCodeAt(0);t.toByteArray=r,t.fromByteArray=i}(e)},function(t,e,r){(function(e){function i(){return"x"+ ++T+ +new Date}function o(){return+new Date}function s(t,e){var n=t.join(B),r=[];return e?(p(e,function(t,e){var n="object"==typeof e?JSON.stringify(e):e;"undefined"!=typeof e&&null!=e&&v(n).length>0&&r.push(t+"="+v(n))}),n+="?"+r.join(I)):n}function a(t,e){var n,r=0,i=function(){r+e>o()?(clearTimeout(n),n=setTimeout(i,e)):(r=o(),t())};return i}function c(t,e){var n=[];return p(t||[],function(t){e(t)&&n.push(t)}),n}function u(t,e){return t.replace(q,function(t,n){return e[n]||t})}function h(t,e){return setTimeout(t,e)}function f(t){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)});return t&&t(e),e}function l(t){return!!t&&(Array.isArray&&Array.isArray(t)||"number"==typeof t.length)}function p(t,e){if(t&&e)if(l(t))for(var n=0,r=t.length;r>n;)e.call(t[n],t[n],n++);else for(var n in t)t.hasOwnProperty&&t.hasOwnProperty(n)&&e.call(t[n],n,t[n])}function d(t,e){var n=[];return p(t||[],function(t,r){n.push(e(t,r))}),n}function v(t){return encodeURIComponent(t)}function y(t,e){var n=[];return p(t,function(t,r){e?t.search("-pnpres")<0&&r.subscribed&&n.push(t):r.subscribed&&n.push(t)}),n.sort()}function g(){h(function(){A||(A=1,p(j,function(t){t()}))},F)}function m(t){return msg=t||{apns:{}},msg.getPubnubMessage=function(){var t={};if(Object.keys(msg.apns).length){t.pn_apns={aps:{alert:msg.apns.alert,badge:msg.apns.badge}};for(var e in msg.apns)t.pn_apns[e]=msg.apns[e];var n=["badge","alert"];for(var e in n)delete t.pn_apns[n[e]]}msg.gcm&&(t.pn_gcm={data:msg.gcm});for(var e in msg)t[e]=msg[e];var r=["apns","gcm","publish","channel","callback","error"];for(var e in r)delete t[r[e]];return t},msg.publish=function(){var t=msg.getPubnubMessage();msg.pubnub&&msg.channel&&msg.pubnub.publish({message:t,channel:msg.channel,callback:msg.callback,error:msg.error})},msg}function _(t){function e(t){return t||(t={}),p(we,function(e,n){e in t||(t[e]=n)}),t}function r(t){var e=[];return p(t,function(t){e.push(t)}),e}function s(t){return r(t).sort()}function l(t){var e="",n=s(t);for(var r in n){var i=n[r];e+=i+"="+v(t[i]),r!=n.length-1&&(e+="&")}return e}function m(t,e,n){var r=!1;if("number"==typeof t)r=t>U||0==t?!1:!0;else{if("boolean"==typeof t)return t?N:0;r=!0}return r?(n&&n("Presence Heartbeat value invalid. Valid range ( x > "+U+" or x = 0). Current Value : "+(e||U)),e||U):t}function _(t,e){return je.encrypt(t,e||Te)||t}function b(t,e){return je.decrypt(t,e||Te)||je.decrypt(t,Te)||t}function w(){return clearTimeout(de),!ye||ye>=500||1>ye||!y(le,!0).length?void(ge=!1):(ge=!0,void Pe.presence_heartbeat({callback:function(){de=h(w,ye*F)},error:function(t){ke&&ke("Presence Heartbeat unable to reach Pubnub servers."+JSON.stringify(t)),de=h(w,ye*F)}}))}function x(){!ge&&w()}function E(t){if(me){if(!ie.length)return}else{if(t&&(ie.sending=0),ie.sending||!ie.length)return;ie.sending=1}be(ie.shift())}function S(t){var e=0;return p(y(le),function(n){var r=le[n];r&&(e++,(t||function(){})(r))}),e}function T(t,e,n){if("object"==typeof t){if(t.error&&t.message&&t.payload)return void n({message:t.message,payload:t.payload});if(t.payload)return void e(t.payload)}e(t)}function O(t,e){e("object"==typeof t&&t.error&&t.message&&t.payload?{message:t.message,payload:t.payload}:t)}function B(){xe()||q(1,{error:"Offline. Please check your network settings. "}),h(B,F)}function I(){Pe.time(function(t){z(function(){},t),t||q(1,{error:"Heartbeat failed to connect to Pubnub Servers.Please check your network settings."}),h(I,K)})}function q(t,e){ce&&ce(t,e),ce=null}function H(t){var e=o()-oe;return e-t/1e4}function z(t,e){function n(e){if(e){var n=e/1e4,i=(o()-r)/2;oe=o()-(n+i),t&&t(oe)}}var r=o();e&&n(e)||Pe.time(n)}var V=+t.windowing||C,J=(+t.timeout||R)*F,K=(+t.keepalive||M)*F,W=t.noleave||0,G=t.publish_key||"demo",Y=t.subscribe_key||"demo",$=t.auth_key||"",X=t.secret_key||"",Q=t.hmac_SHA256,Z=t.ssl?"s":"",te="http"+Z+"://"+(t.origin||"pubsub.pubnub.com"),ee=D(te),ne=D(te),re=function(){},ie=[],oe=0,se=0,ae=0,ce=0,ue=t.restore||0,he=0,fe=!1,le={},pe={},de=null,ve=m(t.heartbeat||t.pnexpires||0,t.error),ye=t.heartbeat_interval||ve-3,ge=!1,me=t.no_wait_for_pending,_e=t["compatible_3.5"]||!1,be=t.xdr,we=t.params||{},ke=t.error||function(){},xe=t._is_online||function(){return 1},Ee=t.jsonp_cb||function(){return 0},Se=t.db||{get:function(){},set:function(){}},Te=t.cipher_key,Ae=t.uuid||Se&&Se.get(Y+"uuid")||"",je=t.crypto_obj||{encrypt:function(t){return t},decrypt:function(t){return t}},Pe={LEAVE:function(t,n,r,i){var o={uuid:Ae,auth:$},s=D(te),r=r||function(){},a=i||function(){},c=Ee();if(t.indexOf(P)>0)return!0;if(_e){if(!Z)return!1;if("0"==c)return!1}return W?!1:("0"!=c&&(o.callback=c),be({blocking:n||Z,timeout:2e3,callback:c,data:e(o),success:function(t){T(t,r,a)},fail:function(t){O(t,a)},url:[s,"v2","presence","sub_key",Y,"channel",v(t),"leave"]}),!0)},set_resumed:function(t){fe=t},get_cipher_key:function(){return Te},set_cipher_key:function(t){Te=t},raw_encrypt:function(t,e){return _(t,e)},raw_decrypt:function(t,e){return b(t,e)},get_heartbeat:function(){return ve},set_heartbeat:function(t){ve=m(t,ye,ke),ye=ve-3>=1?ve-3:1,re(),w()},get_heartbeat_interval:function(){return ye},set_heartbeat_interval:function(t){ye=t,w()},get_version:function(){return L},getGcmMessageObject:function(t){return{data:t}},getApnsMessageObject:function(t){var e={aps:{badge:1,alert:""}};for(k in t)k[e]=t[k];return e},newPnMessage:function(){var t={};gcm&&(t.pn_gcm=gcm),apns&&(t.pn_apns=apns);for(k in n)t[k]=n[k];return t},_add_param:function(t,e){we[t]=e},history:function(t,n){var n=t.callback||n,r=t.count||t.limit||100,i=t.reverse||"false",o=t.error||function(){},s=t.auth_key||$,a=t.cipher_key,c=t.channel,u=t.start,h=t.end,f=t.include_token,l={},p=Ee();return c?n?Y?(l.stringtoken="true",l.count=r,l.reverse=i,l.auth=s,p&&(l.callback=p),u&&(l.start=u),h&&(l.end=h),f&&(l.include_token="true"),void be({callback:p,data:e(l),success:function(t){if("object"==typeof t&&t.error)return void o({message:t.message,payload:t.payload});for(var e=t[0],r=[],i=0;i<e.length;i++){var s=b(e[i],a);try{r.push(JSON.parse(s))}catch(c){r.push(s)}}n([r,t[1],t[2]])},fail:function(t){O(t,o)},url:[ee,"v2","history","sub-key",Y,"channel",v(c)]})):ke("Missing Subscribe Key"):ke("Missing Callback"):ke("Missing Channel")},replay:function(t,n){var r,n=n||t.callback||function(){},i=t.auth_key||$,o=t.source,s=t.destination,a=t.stop,c=t.start,u=t.end,h=t.reverse,f=t.limit,l=Ee(),p={};return o?s?G?Y?("0"!=l&&(p.callback=l),a&&(p.stop="all"),h&&(p.reverse="true"),c&&(p.start=c),u&&(p.end=u),f&&(p.count=f),p.auth=i,r=[ee,"v1","replay",G,Y,o,s],void be({callback:l,success:function(t){T(t,n,err)},fail:function(){n([0,"Disconnected"])},url:r,data:e(p)})):ke("Missing Subscribe Key"):ke("Missing Publish Key"):ke("Missing Destination Channel"):ke("Missing Source Channel")},auth:function(t){$=t,re()},time:function(t){var n=Ee();be({callback:n,data:e({uuid:Ae,auth:$}),timeout:5*F,url:[ee,"time",n],success:function(e){t(e[0])},fail:function(){t(0)}})},publish:function(t,n){var r=t.message;if(!r)return ke("Missing Message");var i,n=n||t.callback||r.callback||function(){},o=t.channel||r.channel,s=t.auth_key||$,a=t.cipher_key,c=t.error||r.error||function(){},u=t.post||!1,h="store_in_history"in t?t.store_in_history:!0,f=Ee(),l="push";return t.prepend&&(l="unshift"),o?G?Y?(r.getPubnubMessage&&(r=r.getPubnubMessage()),r=JSON.stringify(_(r,a)),i=[ee,"publish",G,Y,0,v(o),f,v(r)],we={uuid:Ae,auth:s},h||(we.store="0"),ie[l]({callback:f,timeout:5*F,url:i,data:e(we),fail:function(t){O(t,c),E(1)},success:function(t){T(t,n,c),E(1)},mode:u?"POST":"GET"}),void E()):ke("Missing Subscribe Key"):ke("Missing Publish Key"):ke("Missing Channel")},unsubscribe:function(t,e){var n=t.channel,e=e||t.callback||function(){},r=t.error||function(){};he=0,n=d((n.join?n.join(","):""+n).split(","),function(t){return le[t]?t+","+t+P:void 0}).join(","),p(n.split(","),function(t){var n=!0;t&&(A&&(n=Pe.LEAVE(t,0,e,r)),n||e({action:"leave"}),le[t]=0,t in pe&&delete pe[t])}),re()},subscribe:function(t,n){function r(t){t?h(re,F):(ee=D(te,1),ne=D(te,1),h(function(){Pe.time(r)},F)),S(function(e){return t&&e.disconnected?(e.disconnected=0,e.reconnect(e.name)):void(t||e.disconnected||(e.disconnected=1,e.disconnect(e.name)))})}function i(){var t=Ee(),n=y(le).join(",");if(n){q();var o=e({uuid:Ae,auth:a}),s=JSON.stringify(pe);s.length>2&&(o.state=JSON.stringify(pe)),ve&&(o.heartbeat=ve),x(),ce=be({timeout:E,callback:t,fail:function(t){O(t,l),Pe.time(r)},data:e(o),url:[ne,"subscribe",Y,v(n),t,he],success:function(t){if(!t||"object"==typeof t&&"error"in t&&t.error)return l(t.error),h(re,F);if(g(t[1]),he=!he&&ue&&Se.get(Y)||t[1],S(function(t){t.connected||(t.connected=1,t.connect(t.name))}),fe&&!ue)return he=0,fe=!1,Se.set(Y,0),void h(i,T);w&&(he=1e4,w=0),Se.set(Y,t[1]);var e=function(){var e=t.length>2?t[2]:d(y(le),function(e){return d(Array(t[0].length).join(",").split(","),function(){return e})}).join(","),n=e.split(",");return function(){var t=n.shift()||ae;return[(le[t]||{}).callback||se,t.split(P)[0]]}}(),n=H(+t[1]);p(t[0],function(r){var i=e(),o=b(r,le[i[1]]?le[i[1]].cipher_key:null);i[0](o,t,i[1],n)}),h(i,T)}})}}var s=t.channel,n=n||t.callback,n=n||t.message,a=t.auth_key||$,c=t.connect||function(){},u=t.reconnect||function(){},f=t.disconnect||function(){},l=t.error||function(){},g=t.idle||function(){},m=t.presence||0,_=t.noheresync||0,w=t.backfill||0,k=t.timetoken||0,E=t.timeout||J,T=t.windowing||V,C=t.state,R=t.heartbeat||t.pnexpires,M=t.restore||ue;return ue=M,he=k,s?n?Y?((R||0===R)&&Pe.set_heartbeat(R),p((s.join?s.join(","):""+s).split(","),function(e){var r=le[e]||{};le[ae=e]={name:e,connected:r.connected,disconnected:r.disconnected,subscribed:1,callback:se=n,cipher_key:t.cipher_key,connect:c,disconnect:f,reconnect:u},C&&(pe[e]=e in C?C[e]:C),m&&(Pe.subscribe({channel:e+P,callback:m,restore:M}),r.subscribed||_||Pe.here_now({channel:e,callback:function(t){p("uuids"in t?t.uuids:[],function(n){m({action:"join",uuid:n,timestamp:Math.floor(o()/1e3),occupancy:t.occupancy||1},t,e)})}}))}),re=function(){q(),h(i,T)},A?void re():j.push(re)):ke("Missing Subscribe Key"):ke("Missing Callback"):ke("Missing Channel")},here_now:function(t,n){var n=t.callback||n,r=t.error||function(){},i=t.auth_key||$,o=t.channel,s=Ee(),a="uuids"in t?t.uuids:!0,c=t.state,u={uuid:Ae,auth:i};if(a||(u.disable_uuids=1),c&&(u.state=1),!n)return ke("Missing Callback");if(!Y)return ke("Missing Subscribe Key");var h=[ee,"v2","presence","sub_key",Y];o&&h.push("channel")&&h.push(v(o)),"0"!=s&&(u.callback=s),be({callback:s,data:e(u),success:function(t){T(t,n,r)},fail:function(t){O(t,r)},url:h})},where_now:function(t,n){var n=t.callback||n,r=t.error||function(){},i=t.auth_key||$,o=Ee(),s=t.uuid||Ae,a={auth:i};return n?Y?("0"!=o&&(a.callback=o),void be({callback:o,data:e(a),success:function(t){T(t,n,r)},fail:function(t){O(t,r)},url:[ee,"v2","presence","sub_key",Y,"uuid",v(s)]})):ke("Missing Subscribe Key"):ke("Missing Callback")},state:function(t,n){var r,n=t.callback||n||function(){},i=t.error||function(){},o=t.auth_key||$,s=Ee(),a=t.state,c=t.uuid||Ae,u=t.channel,h=e({auth:o});return Y?c?u?("0"!=s&&(h.callback=s),le[u]&&le[u].subscribed&&a&&(pe[u]=a),h.state=JSON.stringify(a),r=a?[ee,"v2","presence","sub-key",Y,"channel",v(u),"uuid",c,"data"]:[ee,"v2","presence","sub-key",Y,"channel",v(u),"uuid",v(c)],void be({callback:s,data:e(h),success:function(t){T(t,n,i)},fail:function(t){O(t,i)},url:r})):ke("Missing Channel"):ke("Missing UUID"):ke("Missing Subscribe Key")},grant:function(t,n){var n=t.callback||n,r=t.error||function(){},i=t.channel,o=Ee(),s=t.ttl,a=t.read?"1":"0",c=t.write?"1":"0",u=t.auth_key;if(!n)return ke("Missing Callback");if(!Y)return ke("Missing Subscribe Key");if(!G)return ke("Missing Publish Key");if(!X)return ke("Missing Secret Key");var h=Math.floor((new Date).getTime()/1e3),f=Y+"\n"+G+"\ngrant\n",p={w:c,r:a,timestamp:h};"undefined"!=i&&null!=i&&i.length>0&&(p.channel=i),"0"!=o&&(p.callback=o),(s||0===s)&&(p.ttl=s),u&&(p.auth=u),p=e(p),u||delete p.auth,f+=l(p);var d=Q(f,X);d=d.replace(/\+/g,"-"),d=d.replace(/\//g,"_"),p.signature=d,be({callback:o,data:p,success:function(t){T(t,n,r)},fail:function(t){O(t,r)},url:[ee,"v1","auth","grant","sub-key",Y]})},audit:function(t,n){var n=t.callback||n,r=t.error||function(){},i=t.channel,o=t.auth_key,s=Ee();if(!n)return ke("Missing Callback");if(!Y)return ke("Missing Subscribe Key");if(!G)return ke("Missing Publish Key");if(!X)return ke("Missing Secret Key");var a=Math.floor((new Date).getTime()/1e3),c=Y+"\n"+G+"\naudit\n",u={timestamp:a};"0"!=s&&(u.callback=s),"undefined"!=i&&null!=i&&i.length>0&&(u.channel=i),o&&(u.auth=o),u=e(u),o||delete u.auth,c+=l(u);var h=Q(c,X);h=h.replace(/\+/g,"-"),h=h.replace(/\//g,"_"),u.signature=h,be({callback:s,data:u,success:function(t){T(t,n,r)},fail:function(t){O(t,r)},url:[ee,"v1","auth","audit","sub-key",Y]})},revoke:function(t,e){t.read=!1,t.write=!1,Pe.grant(t,e)},set_uuid:function(t){Ae=t,re()},get_uuid:function(){return Ae},presence_heartbeat:function(t){var n=t.callback||function(){},r=t.error||function(){},i=Ee(),o={uuid:Ae,auth:$},s=JSON.stringify(pe);s.length>2&&(o.state=JSON.stringify(pe)),ve>0&&320>ve&&(o.heartbeat=ve),"0"!=i&&(o.callback=i),be({callback:i,data:e(o),timeout:5*F,url:[ee,"v2","presence","sub-key",Y,"channel",v(y(le,!0).join(",")),"heartbeat"],success:function(t){T(t,n,r)},fail:function(t){O(t,r)}})},xdr:be,ready:g,db:Se,uuid:f,map:d,each:p,"each-channel":S,grep:c,offline:function(){q(1,{message:"Offline. Please check your network settings."})},supplant:u,now:o,unique:i,updater:a};return Ae||(Ae=Pe.uuid()),Se.set(Y+"uuid",Ae),h(B,F),h(I,K),de=h(x,(ye-3)*F),z(),Pe}function b(t,n){return K.createHmac("sha256",new e(n,"utf8")).update(t).digest("base64")}function w(t){console.error(t)}function x(t){var e,n,i=t.success||function(){},o=t.fail||function(){},a=t.origin||"pubsub.pubnub.com",c=t.ssl,u=0,f=0,l=t.mode||"GET",p=t.data||{},d=t.timeout||O,v="",y=function(){if(!f){f=1,clearTimeout(m);try{n=JSON.parse(v)}catch(t){return g(1)}i(n)}},g=function(t,n){u||(u=1,clearTimeout(m),e&&(e.on("error",function(){}),e.on("data",function(){}),e.on("end",function(){}),e.abort&&e.abort(),e=null),t&&o(n))},m=h(function(){g(1)},d);p.pnsdk=J;var _={},b="";"POST"==l&&(b=decodeURIComponent(t.url.pop()));var w=s(t.url,p);c||(c="https"==w.split("://")[0]?!0:!1),w="/"+w.split("/").slice(3).join("/");var a=t.url[0].split("//")[1];_.hostname=W?W.hostname:t.url[0].split("//")[1],_.port=W?W.port:c?443:80,_.path=W?"http://"+a+w:w,_.headers=W?{Host:a}:null,_.method=l,_.keepAlive=!!V,_.agent=V,_.body=b,r(31).globalAgent.maxSockets=1/0;try{e=(c?z:H).request(_,function(t){t.setEncoding("utf8"),t.on("error",function(){console.log("error"),g(1,v||{error:"Network Connection Error"})}),t.on("abort",function(){console.log("abort"),g(1,v||{error:"Network Connection Error"})}),t.on("data",function(t){t&&(v+=t)}),t.on("end",function(){var e=t.statusCode;switch(e){case 401:case 402:case 403:try{t=JSON.parse(v),g(1,t)}catch(n){return g(1,v)}return}y()})}),e.timeout=d,e.on("error",function(){g(1,{error:"Network Connection Error"})}),"POST"==l&&e.write(b),e.end()}catch(k){return g(0),x(t)}return g}function E(){function t(t){return K.createHash("sha256").update(t).digest("hex").slice(0,32)}var e="0123456789012345";return{encrypt:function(n,r){if(!r)return n;var i=JSON.stringify(n),o=K.createCipheriv("aes-256-cbc",t(r),e),s=o.update(i,"utf8","base64")+o.final("base64");return s||n},decrypt:function(n,r){if(!r)return n;var i=K.createDecipheriv("aes-256-cbc",t(r),e);try{var o=i.update(n,"base64","utf8")+i.final("utf8")}catch(s){return null}return JSON.parse(o)}}}function S(){return"EventEmitter"in H.Agent.super_}var T=1,A=!1,j=[],P="-pnpres",C=10,O=1e4,R=310,M=60,F=1e3,B="/",I="&",U=5,N=30,L="3.6.8",q=/{([\w\-]+)}/g,D=function(){var t=20,e=Math.floor(Math.random()*t);return function(n,r){return n.indexOf("pubsub.")>0&&n.replace("pubsub","ps"+(r?f().split("-")[0]:++e<t?e:e=1))||n}}(),T=1,H=r(31),z=r(49),V=new(S()?H.Agent:r(141))({keepAlive:!0,keepAliveMsecs:3e5,maxSockets:5}),O=1e4,F=1e3,J="PubNub-JS-Nodejs/3.6.8",K=r(48),W=null,G=function(){var t={};return{get:function(e){return t[e]},set:function(e,n){t[e]=n}}}(),Y=function(t){W=t.proxy,t.xdr=x,t.db=G,t.error=t.error||w,t.hmac_SHA256=b,t.crypto_obj=E(),t.params={pnsdk:J},t.keepAlive===!1&&(V=void 0),SELF=function(t){return Y(t)};var e=_(t);for(var n in e)e.hasOwnProperty(n)&&(SELF[n]=e[n]);return SELF.init=SELF,SELF.secure=SELF,SELF.ready(),SELF};Y.init=Y,Y.unique=i,Y.secure=Y,t.exports=Y,t.exports.PNmessage=m}).call(e,r(50).Buffer)},function(t,e,n){(function(t){function r(t){if(!(this instanceof r))return new r(t);c.call(this);var e=this;e.defaultPort=80,e.protocol="http:",e.options=a._extend({},t),e.options.path=null,e.requests={},e.sockets={},e.freeSockets={},e.keepAliveMsecs=e.options.keepAliveMsecs||1e3,e.keepAlive=e.options.keepAlive||!1,e.maxSockets=e.options.maxSockets||r.defaultMaxSockets,e.maxFreeSockets=e.options.maxFreeSockets||256,e.on("free",function(t,n){var r=e.getName(n);if(i("agent.on(free)",r),!e.isDestroyed(t)&&e.requests[r]&&e.requests[r].length)e.requests[r].shift().onSocket(t),0===e.requests[r].length&&delete e.requests[r];else{var o=t._httpMessage;if(o&&o.shouldKeepAlive&&!e.isDestroyed(t)&&e.options.keepAlive){var s=e.freeSockets[r],a=s?s.length:0,c=a;e.sockets[r]&&(c+=e.sockets[r].length),c>=e.maxSockets||a>=e.maxFreeSockets?(e.removeSocket(t,n),t.destroy()):(s=s||[],e.freeSockets[r]=s,t.setKeepAlive(!0,e.keepAliveMsecs),t.unref&&t.unref(),t._httpMessage=null,e.removeSocket(t,n),s.push(t))}else e.removeSocket(t,n),t.destroy()}})}var i,o=n(!function(){var t=new Error('Cannot find module "net"');throw t.code="MODULE_NOT_FOUND",t}()),s=n(28),a=n(81),c=n(44).EventEmitter,u=n(31).ClientRequest;i=t.env.NODE_DEBUG&&/agentkeepalive/.test(t.env.NODE_DEBUG)?function(){console.error.apply(console,arguments)}:function(){},a.inherits(r,c),e.Agent=r,r.defaultMaxSockets=1/0,r.prototype.createConnection=o.createConnection,r.prototype.getName=function(t){var e="";return e+=t.host?t.host:"localhost",e+=":",t.port&&(e+=t.port),e+=":",t.localAddress&&(e+=t.localAddress),e+=":"},r.prototype.addRequest=function(t,e){"string"==typeof e&&(e={host:e,port:arguments[2],path:arguments[3]});var n=this.getName(e);this.sockets[n]||(this.sockets[n]=[]);var r=this.freeSockets[n]?this.freeSockets[n].length:0,o=r+this.sockets[n].length;if(r){var s=this.freeSockets[n].shift();i("have free socket"),this.freeSockets[n].length||delete this.freeSockets[n],s.ref&&s.ref(),t.onSocket(s),this.sockets[n].push(s)}else o<this.maxSockets?(i("call onSocket",o,r),t.onSocket(this.createSocket(t,e))):(i("wait for socket"),this.requests[n]||(this.requests[n]=[]),this.requests[n].push(t))},r.prototype.createSocket=function(t,e){function n(){s.emit("free",h,e)}function r(){i("CLIENT socket onClose"),s.removeSocket(h,e)}function o(){i("CLIENT socket onRemove"),s.removeSocket(h,e,"agentRemove"),h.removeListener("close",r),h.removeListener("free",n),h.removeListener("agentRemove",o)}var s=this;if(e=a._extend({},e),e=a._extend(e,s.options),e.servername=e.host,t){var c=t.getHeader("host");c&&(e.servername=c.replace(/:.*$/,""))}var u=s.getName(e);i("createConnection",u,e);var h=s.createConnection(e);return s.sockets[u]||(s.sockets[u]=[]),this.sockets[u].push(h),i("sockets",u,this.sockets[u].length),h.on("free",n),h.on("close",r),h.on("agentRemove",o),h},r.prototype.removeSocket=function(t,e){var n=this.getName(e);i("removeSocket",n,"destroyed:",this.isDestroyed(t));var r=[this.sockets];if(this.isDestroyed(t)&&r.push(this.freeSockets),r.forEach(function(e){if(e[n]){var r=e[n].indexOf(t);-1!==r&&(e[n].splice(r,1),0===e[n].length&&delete e[n])}}),this.requests[n]&&this.requests[n].length){i("removeSocket, have a request, make a socket");var o=this.requests[n][0];this.createSocket(o,e).emit("free")}},r.prototype.destroy=function(){var t=[this.freeSockets,this.sockets];t.forEach(function(t){Object.keys(t).forEach(function(e){t[e].forEach(function(t){t.destroy()})})})},r.prototype.request=function(t,e){if("string"==typeof t&&(t=s.parse(t)),t.hostname&&(t.host=t.hostname),t&&t.path&&/ /.test(t.path))throw new TypeError("Request path contains unescaped characters.");if(t.protocol&&t.protocol!==this.protocol)throw new Error("Protocol:"+t.protocol+" not supported.");return t=a._extend({agent:this,keepAlive:this.keepAlive},t),t.agent===!1&&(t.agent=new this.constructor),i("agent.request",t),new u(t,e)
},r.prototype.get=function(t,e){var n=this.request(t,e);return n.end(),n},r.prototype.isDestroyed=function(t){return t.destroyed||t._destroyed},e.globalAgent=new r}).call(e,n(87))},function(t,e,n){var r,i;(function(t){!function(o,s){"use strict";"object"==typeof e&&t?t.exports=s():(r=s,i="function"==typeof r?r.call(e,n,e,t):r,!(void 0!==i&&(t.exports=i)))}("object"==typeof window&&window||this,function(){"use strict";function t(t){var e;for(e in t)if(t.hasOwnProperty(e))return!0;return!1}function e(t){return function(){throw t}}function n(t,n,r){try{t(n,r)}catch(i){setTimeout(e(i),0)}}function r(t,e,n){t(e,n)}function i(t,e,i,o){var s,a=u[e],c=o?r:n;if(u.hasOwnProperty(e))for(s in a)a.hasOwnProperty(s)&&c(a[s],t,i)}function o(t,e,n){return function(){var r=String(t),o=r.lastIndexOf(".");for(i(t,t,e,n);-1!==o;)r=r.substr(0,o),o=r.lastIndexOf("."),i(t,r,e)}}function s(e){for(var n=String(e),r=Boolean(u.hasOwnProperty(n)&&t(u[n])),i=n.lastIndexOf(".");!r&&-1!==i;)n=n.substr(0,i),i=n.lastIndexOf("."),r=Boolean(u.hasOwnProperty(n)&&t(u[n]));return r}function a(t,e,n,r){var i=o(t,e,r),a=s(t);return a?(n===!0?i():setTimeout(i,0),!0):!1}var c={},u={},h=-1;return c.publish=function(t,e){return a(t,e,!1,c.immediateExceptions)},c.publishSync=function(t,e){return a(t,e,!0,c.immediateExceptions)},c.subscribe=function(t,e){if("function"!=typeof e)return!1;u.hasOwnProperty(t)||(u[t]={});var n="uid_"+String(++h);return u[t][n]=e,n},c.unsubscribe=function(t){var e,n,r,i="string"==typeof t,o=!1;for(e in u)if(u.hasOwnProperty(e)){if(n=u[e],i&&n[t]){delete n[t],o=t;break}if(!i)for(r in n)n.hasOwnProperty(r)&&n[r]===t&&(delete n[r],o=!0)}return o},c})}).call(e,n(88)(t))},function(t,e,n){(function(e){"use strict";t.exports=function(){function t(t){return void 0===t?!1:t instanceof i}function r(t,e){return t instanceof d?e>=0:!1}function i(t){if("function"!=typeof t)throw new E("the promise constructor requires a resolver function");if(this.constructor!==i)throw new E("the promise constructor cannot be invoked directly");this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._settledValue=void 0,this._boundTo=void 0,t!==f&&this._resolveFromResolver(t)}function o(t,e){return s(t,d,e===!0&&t._isBound()?t._boundTo:void 0).promise()}function s(e,n,r){var o=null;return m(e)?o=e:(o=i._cast(e,void 0),o!==e?o._setBoundTo(r):t(o)||(o=null)),null!==o?new n(o,r):{promise:function(){return R("expecting an array, a promise or a thenable")}}}var a=n(105),c=n(107),u=n(109),h=n(106),f=function(){},l={},p={e:null},d=n(108)(i,f),v=n(110)(),y=n(111)(p),g=n(112),m=c.isArray,_=c.errorObj,b=c.tryCatch1,w=c.tryCatch2,k=c.tryCatchApply,x=h.RangeError,E=h.TypeError,S=h.CancellationError,T=h.TimeoutError,A=h.RejectionError,j=h.originatesFromRejection,P=h.markAsOriginatingFromRejection,C=h.canAttach,O=c.thrower,R=n(113)(i),M=function(){return new E("circular promise resolution chain")};i.prototype.bind=function(t){var e=new i(f);return e._setTrace(this),e._follow(this),e._setBoundTo(t),this._cancellable()&&(e._setCancellable(),e._cancellationParent=this),e},i.prototype.toString=function(){return"[object Promise]"},i.prototype.caught=i.prototype["catch"]=function(t){var e=arguments.length;if(e>1){var n,r=new Array(e-1),i=0;for(n=0;e-1>n;++n){var o=arguments[n];if("function"!=typeof o){var s=new E("A catch filter must be an error constructor or a filter function");return this._attachExtraTrace(s),void u.invoke(this._reject,this,s)}r[i++]=o}r.length=i,t=arguments[n],this._resetTrace();var a=new y(r,t,this);return this._then(void 0,a.doFilter,void 0,a,void 0)}return this._then(void 0,t,void 0,void 0,void 0)},i.prototype.then=function(t,e,n){return this._then(t,e,n,void 0,void 0)},i.prototype.done=function(t,e,n){var r=this._then(t,e,n,void 0,void 0);r._setIsFinal()},i.prototype.spread=function(t,e){return this._then(t,e,void 0,l,void 0)},i.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()},i.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this._settledValue,t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this._settledValue,t.isRejected=!0),t},i.prototype.all=function(){return o(this,!0)},i.is=t,i.all=function(t){return o(t,!1)},i.join=function(){for(var t=arguments.length,e=new Array(t),n=0;t>n;++n)e[n]=arguments[n];return s(e,d,void 0).promise()},i.resolve=i.fulfilled=function(t){var e=new i(f);return e._setTrace(void 0),e._tryFollow(t)?e:(e._cleanValues(),e._setFulfilled(),e._settledValue=t,e)},i.reject=i.rejected=function(t){var e=new i(f);if(e._setTrace(void 0),P(t),e._cleanValues(),e._setRejected(),e._settledValue=t,!C(t)){var n=new Error(t+"");e._setCarriedStackTrace(n)}return e._ensurePossibleRejectionHandled(),e},i.prototype.error=function(t){return this.caught(j,t)},i.prototype._resolveFromSyncValue=function(t){if(t===_)this._cleanValues(),this._setRejected(),this._settledValue=t.e,this._ensurePossibleRejectionHandled();else{var e=i._cast(t,void 0);e instanceof i?this._follow(e):(this._cleanValues(),this._setFulfilled(),this._settledValue=t)}},i.method=function(t){if("function"!=typeof t)throw new E("fn must be a function");return function(){var e;switch(arguments.length){case 0:e=b(t,this,void 0);break;case 1:e=b(t,this,arguments[0]);break;case 2:e=w(t,this,arguments[0],arguments[1]);break;default:for(var n=arguments.length,r=new Array(n),o=0;n>o;++o)r[o]=arguments[o];e=k(t,r,this)}var s=new i(f);return s._setTrace(void 0),s._resolveFromSyncValue(e),s}},i.attempt=i["try"]=function(t,e,n){if("function"!=typeof t)return R("fn must be a function");var r=m(e)?k(t,e,n):b(t,n,e),o=new i(f);return o._setTrace(void 0),o._resolveFromSyncValue(r),o},i.defer=i.pending=function(){var t=new i(f);return t._setTrace(void 0),new g(t)},i.bind=function(t){var e=new i(f);return e._setTrace(void 0),e._setFulfilled(),e._setBoundTo(t),e},i.cast=function(t){var e=i._cast(t,void 0);return e instanceof i?e:i.resolve(e)},i.onPossiblyUnhandledRejection=function(t){v.possiblyUnhandledRejection="function"==typeof t?t:void 0};var F;i.onUnhandledRejectionHandled=function(t){F="function"==typeof t?t:void 0};var B=!1||!("undefined"==typeof e||"string"!=typeof e.execPath||"object"!=typeof e.env||!e.env.BLUEBIRD_DEBUG&&"development"!==e.env.NODE_ENV);i.longStackTraces=function(){if(u.haveItemsQueued()&&B===!1)throw new Error("cannot enable long stack traces after promises have been created");B=v.isSupported()},i.hasLongStackTraces=function(){return B&&v.isSupported()},i.prototype._setProxyHandlers=function(t,e){var n=this._length();if(n>=524282&&(n=0,this._setLength(0)),0===n)this._promise0=e,this._receiver0=t;else{var r=n-5;this[r+3]=e,this[r+4]=t,this[r+0]=this[r+1]=this[r+2]=void 0}this._setLength(n+5)},i.prototype._proxyPromiseArray=function(t,e){this._setProxyHandlers(t,e)},i.prototype._proxyPromise=function(t){t._setProxied(),this._setProxyHandlers(t,-1)},i.prototype._then=function(t,e,n,r,o){var s=void 0!==o,a=s?o:new i(f);if(B&&!s){var c=this._peekContext()===this._traceParent;a._traceParent=c?this._traceParent:this,a._setTrace(this)}!s&&this._isBound()&&a._setBoundTo(this._boundTo);var h=this._addCallbacks(t,e,n,a,r);return!s&&this._cancellable()&&(a._setCancellable(),a._cancellationParent=this),this.isResolved()&&u.invoke(this._queueSettleAt,this,h),a},i.prototype._length=function(){return 524287&this._bitField},i.prototype._isFollowingOrFulfilledOrRejected=function(){return(939524096&this._bitField)>0},i.prototype._isFollowing=function(){return 536870912===(536870912&this._bitField)},i.prototype._setLength=function(t){this._bitField=-524288&this._bitField|524287&t},i.prototype._setFulfilled=function(){this._bitField=268435456|this._bitField},i.prototype._setRejected=function(){this._bitField=134217728|this._bitField},i.prototype._setFollowing=function(){this._bitField=536870912|this._bitField},i.prototype._setIsFinal=function(){this._bitField=33554432|this._bitField},i.prototype._isFinal=function(){return(33554432&this._bitField)>0},i.prototype._cancellable=function(){return(67108864&this._bitField)>0},i.prototype._setCancellable=function(){this._bitField=67108864|this._bitField},i.prototype._unsetCancellable=function(){this._bitField=-67108865&this._bitField},i.prototype._setRejectionIsUnhandled=function(){this._bitField=2097152|this._bitField},i.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-2097153&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},i.prototype._isRejectionUnhandled=function(){return(2097152&this._bitField)>0},i.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=524288|this._bitField},i.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-524289&this._bitField},i.prototype._isUnhandledRejectionNotified=function(){return(524288&this._bitField)>0},i.prototype._setCarriedStackTrace=function(t){this._bitField=1048576|this._bitField,this._fulfillmentHandler0=t},i.prototype._unsetCarriedStackTrace=function(){this._bitField=-1048577&this._bitField,this._fulfillmentHandler0=void 0},i.prototype._isCarryingStackTrace=function(){return(1048576&this._bitField)>0},i.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:void 0},i.prototype._receiverAt=function(t){var e;return e=0===t?this._receiver0:this[t+4-5],this._isBound()&&void 0===e?this._boundTo:e},i.prototype._promiseAt=function(t){return 0===t?this._promise0:this[t+3-5]},i.prototype._fulfillmentHandlerAt=function(t){return 0===t?this._fulfillmentHandler0:this[t+0-5]},i.prototype._rejectionHandlerAt=function(t){return 0===t?this._rejectionHandler0:this[t+1-5]},i.prototype._unsetAt=function(t){0===t?(this._rejectionHandler0=this._progressHandler0=this._promise0=this._receiver0=void 0,this._isCarryingStackTrace()||(this._fulfillmentHandler0=void 0)):this[t-5+0]=this[t-5+1]=this[t-5+2]=this[t-5+3]=this[t-5+4]=void 0},i.prototype._resolveFromResolver=function(t){function e(t){r._tryFollow(t)||r._fulfill(t)}function n(t){var e=C(t)?t:new Error(t+"");r._attachExtraTrace(e),P(t),r._reject(t,e===t?void 0:e)}var r=this;this._setTrace(void 0),this._pushContext();var i=w(t,void 0,e,n);if(this._popContext(),void 0!==i&&i===_){var o=i.e,s=C(o)?o:new Error(o+"");r._reject(o,s)}},i.prototype._addCallbacks=function(t,e,n,r,i){var o=this._length();if(o>=524282&&(o=0,this._setLength(0)),0===o)this._promise0=r,void 0!==i&&(this._receiver0=i),"function"!=typeof t||this._isCarryingStackTrace()||(this._fulfillmentHandler0=t),"function"==typeof e&&(this._rejectionHandler0=e),"function"==typeof n&&(this._progressHandler0=n);else{var s=o-5;this[s+3]=r,this[s+4]=i,this[s+0]="function"==typeof t?t:void 0,this[s+1]="function"==typeof e?e:void 0,this[s+2]="function"==typeof n?n:void 0}return this._setLength(o+5),o},i.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=8388608|this._bitField,this._boundTo=t):this._bitField=-8388609&this._bitField},i.prototype._isBound=function(){return 8388608===(8388608&this._bitField)},i.prototype._spreadSlowCase=function(t,e,n,r){var i=s(n,d,r).promise()._then(function(){return t.apply(r,arguments)},void 0,void 0,l,void 0);e._follow(i)},i.prototype._callSpread=function(e,n,r,o){var s=this._isBound()?this._boundTo:void 0;if(m(r))for(var a=0,c=r.length;c>a;++a)if(t(i._cast(r[a],void 0)))return void this._spreadSlowCase(e,n,r,s);return o&&n._pushContext(),k(e,r,s)},i.prototype._callHandler=function(t,e,n,r,i){var o;return e!==l||this.isRejected()?(i&&n._pushContext(),o=b(t,e,r)):o=this._callSpread(t,n,r,i),i&&n._popContext(),o},i.prototype._settlePromiseFromHandler=function(e,n,r,o){if(!t(o))return void e.call(n,r,o);var s=B,a=this._callHandler(e,n,o,r,s);if(!o._isFollowing())if(a===_||a===o||a===p){var c=a===o?M():a.e,u=C(c)?c:new Error(c+"");a!==p&&o._attachExtraTrace(u),o._rejectUnchecked(c,u)}else{var h=i._cast(a,o);if(t(h)){if(h.isRejected()&&!h._isCarryingStackTrace()&&!C(h._settledValue)){var u=new Error(h._settledValue+"");o._attachExtraTrace(u),h._setCarriedStackTrace(u)}o._follow(h),h._cancellable()&&(o._cancellationParent=h,o._setCancellable())}else o._fulfillUnchecked(a)}},i.prototype._follow=function(t){this._setFollowing(),t.isPending()?(t._cancellable()&&(this._cancellationParent=t,this._setCancellable()),t._proxyPromise(this)):t.isFulfilled()?this._fulfillUnchecked(t._settledValue):this._rejectUnchecked(t._settledValue,t._getCarriedStackTrace()),t._isRejectionUnhandled()&&t._unsetRejectionIsUnhandled(),B&&null==t._traceParent&&(t._traceParent=this)},i.prototype._tryFollow=function(e){if(this._isFollowingOrFulfilledOrRejected()||e===this)return!1;var n=i._cast(e,void 0);return t(n)?(this._follow(n),!0):!1},i.prototype._resetTrace=function(){B&&(this._trace=new v(void 0===this._peekContext()))},i.prototype._setTrace=function(t){if(B){var e=this._peekContext();this._traceParent=e;var n=void 0===e;this._trace=void 0!==t&&t._traceParent===e?t._trace:new v(n)}return this},i.prototype._attachExtraTrace=function(t){if(B){var e=this,n=t.stack;n="string"==typeof n?n.split("\n"):[];for(var r=1;null!=e&&null!=e._trace;)n=v.combine(n,e._trace.stack.split("\n")),e=e._traceParent;var i=Error.stackTraceLimit+r,o=n.length;o>i&&(n.length=i),t.stack=n.length<=r?"(No stack trace)":n.join("\n")}},i.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=void 0)},i.prototype._fulfill=function(t){this._isFollowingOrFulfilledOrRejected()||this._fulfillUnchecked(t)},i.prototype._reject=function(t,e){this._isFollowingOrFulfilledOrRejected()||this._rejectUnchecked(t,e)},i.prototype._settlePromiseAt=function(t){var e=this.isFulfilled()?this._fulfillmentHandlerAt(t):this._rejectionHandlerAt(t),n=this._settledValue,o=this._receiverAt(t),s=this._promiseAt(t);if("function"==typeof e)this._settlePromiseFromHandler(e,o,n,s);else{var a=!1,c=this.isFulfilled();void 0!==o&&(o instanceof i&&o._isProxied()?(o._unsetProxied(),c?o._fulfillUnchecked(n):o._rejectUnchecked(n,this._getCarriedStackTrace()),a=!0):r(o,s)&&(c?o._promiseFulfilled(n,s):o._promiseRejected(n,s),a=!0)),a||(c?s._fulfill(n):s._reject(n,this._getCarriedStackTrace()))}t>=256&&this._queueGC()},i.prototype._isProxied=function(){return 4194304===(4194304&this._bitField)},i.prototype._setProxied=function(){this._bitField=4194304|this._bitField},i.prototype._unsetProxied=function(){this._bitField=-4194305&this._bitField},i.prototype._isGcQueued=function(){return-1073741824===(-1073741824&this._bitField)},i.prototype._setGcQueued=function(){this._bitField=-1073741824|this._bitField},i.prototype._unsetGcQueued=function(){this._bitField=1073741823&this._bitField},i.prototype._queueGC=function(){this._isGcQueued()||(this._setGcQueued(),u.invokeLater(this._gc,this,void 0))},i.prototype._gc=function(){var t=this._length();this._unsetAt(0);for(var e=0;t>e;e++)delete this[e];this._setLength(0),this._unsetGcQueued()},i.prototype._queueSettleAt=function(t){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled(),u.invoke(this._settlePromiseAt,this,t)},i.prototype._fulfillUnchecked=function(t){if(this.isPending()){if(t===this){var e=M();return this._attachExtraTrace(e),this._rejectUnchecked(e,void 0)}this._cleanValues(),this._setFulfilled(),this._settledValue=t;var n=this._length();n>0&&u.invoke(this._settlePromises,this,n)}},i.prototype._rejectUncheckedCheckError=function(t){var e=C(t)?t:new Error(t+"");this._rejectUnchecked(t,e===t?void 0:e)},i.prototype._rejectUnchecked=function(t,e){if(this.isPending()){if(t===this){var n=M();return this._attachExtraTrace(n),this._rejectUnchecked(n)}if(this._cleanValues(),this._setRejected(),this._settledValue=t,this._isFinal())return void u.invokeLater(O,void 0,void 0===e?t:e);var r=this._length();void 0!==e&&this._setCarriedStackTrace(e),r>0?u.invoke(this._rejectPromises,this,null):this._ensurePossibleRejectionHandled()}},i.prototype._rejectPromises=function(){this._settlePromises(),this._unsetCarriedStackTrace()},i.prototype._settlePromises=function(){for(var t=this._length(),e=0;t>e;e+=5)this._settlePromiseAt(e)},i.prototype._ensurePossibleRejectionHandled=function(){this._setRejectionIsUnhandled(),void 0!==v.possiblyUnhandledRejection&&u.invokeLater(this._notifyUnhandledRejection,this,void 0)},i.prototype._notifyUnhandledRejectionIsHandled=function(){"function"==typeof F&&u.invokeLater(F,void 0,this)},i.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue,e=this._getCarriedStackTrace();this._setUnhandledRejectionIsNotified(),void 0!==e&&(this._unsetCarriedStackTrace(),t=e),"function"==typeof v.possiblyUnhandledRejection&&v.possiblyUnhandledRejection(t,this)}};var I=[];i.prototype._peekContext=function(){var t=I.length-1;return t>=0?I[t]:void 0},i.prototype._pushContext=function(){B&&I.push(this)},i.prototype._popContext=function(){B&&I.pop()};var U=a.Promise;return i.noConflict=function(){return a.Promise===i&&(a.Promise=U),i},v.isSupported()||(i.longStackTraces=function(){},B=!1),i._makeSelfResolutionError=M,n(114)(i,p),n(115)(i),n(116)(i,f),n(117)(i),i.RangeError=x,i.CancellationError=S,i.TimeoutError=T,i.TypeError=E,i.RejectionError=A,c.toFastProperties(i),c.toFastProperties(i.prototype),n(118)(i,f),n(119)(i,s,d),n(120)(i,f),n(121)(i),n(122)(i,s,d,R),n(123)(i,R,f),n(124)(i,d,f,R),n(125)(i),n(126)(i,f),n(127)(i,d),n(128)(i,s,d,R,f),n(129)(i,s,d),n(130)(i,s,d,R),n(131)(i,r),n(132)(i,f),i.prototype=i.prototype,i}}).call(e,n(87))},function(t){function e(){}var n=t.exports={};n.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.on=e,n.addListener=e,n.once=e,n.off=e,n.removeListener=e,n.removeAllListeners=e,n.emit=e,n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")}},function(t){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e,n){"use strict";var r=n(133).Promise,i=n(134).polyfill;e.Promise=r,e.polyfill=i},function(t,e,n){var e=t.exports=function(t){var n=e[t];if(!n)throw new Error(t+" is not supported (we accept pull requests)");return new n},r=n(50).Buffer,i=n(101)(r);e.sha1=n(102)(r,i),e.sha256=n(103)(r,i),e.sha512=n(104)(r,i)},function(t,e,n){(function(e){function n(t,n){if(t.length%o!==0){var r=t.length+(o-t.length%o);t=e.concat([t,s],r)}for(var i=[],a=n?t.readInt32BE:t.readInt32LE,c=0;c<t.length;c+=o)i.push(a.call(t,c));return i}function r(t,n,r){for(var i=new e(n),o=r?i.writeInt32BE:i.writeInt32LE,s=0;s<t.length;s++)o.call(i,t[s],4*s,!0);return i}function i(t,i,o,s){e.isBuffer(t)||(t=new e(t));var c=i(n(t,s),t.length*a);return r(c,o,s)}var o=4,s=new e(o);s.fill(0);var a=8;t.exports={hash:i}}).call(e,n(50).Buffer)},function(t){t.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){(function(e){t.exports=function(t){function n(t,e,n,i,o,s){if("function"==typeof o&&(s=o,o=void 0),"function"!=typeof s)throw new Error("No callback provided to pbkdf2");setTimeout(function(){var a;try{a=r(t,e,n,i,o)}catch(c){return s(c)}s(void 0,a)})}function r(n,r,i,o,s){if("number"!=typeof i)throw new TypeError("Iterations not a number");if(0>i)throw new TypeError("Bad iterations");if("number"!=typeof o)throw new TypeError("Key length not a number");if(0>o)throw new TypeError("Bad key length");s=s||"sha1",e.isBuffer(n)||(n=new e(n)),e.isBuffer(r)||(r=new e(r));var a,c,u,h=1,f=new e(o),l=new e(r.length+4);r.copy(l,0,0,r.length);for(var p=1;h>=p;p++){l.writeUInt32BE(p,r.length);var d=t.createHmac(s,n).update(l).digest();if(!a&&(a=d.length,u=new e(a),h=Math.ceil(o/a),c=o-(h-1)*a,o>(Math.pow(2,32)-1)*a))throw new TypeError("keylen exceeds maximum length");d.copy(u,0,0,a);for(var v=1;i>v;v++){d=t.createHmac(s,n).update(d).digest();for(var y=0;a>y;y++)u[y]^=d[y]}var g=(p-1)*a,m=p==h?c:a;u.copy(f,g,0,m)}return f}return{pbkdf2:n,pbkdf2Sync:r}}}).call(e,n(50).Buffer)},function(t,e,n){e=t.exports=n(135),e.Stream=n(70),e.Readable=e,e.Writable=n(136),e.Duplex=n(137),e.Transform=n(138),e.PassThrough=n(139)},function(t,e,n){t.exports=n(136)},function(t,e,n){t.exports=n(137)},function(t,e,n){t.exports=n(138)},function(t,e,n){t.exports=n(139)},function(t,e,n){(function(e){function n(t,e,n){return t^e^n}function r(t,e,n){return t&e|~t&n}function i(t,e,n){return(t|~e)^n}function o(t,e,n){return t&n|e&~n}function s(t,e,n){return t^(e|~n)}function a(t,e){return t<<e|t>>>32-e}function c(t){var n=[1732584193,4023233417,2562383102,271733878,3285377520];"string"==typeof t&&(t=new e(t,"utf8"));var r=v(t),i=8*t.length,o=8*t.length;r[i>>>5]|=128<<24-i%32,r[(i+64>>>9<<4)+14]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);for(var s=0;s<r.length;s+=16)g(n,r,s);for(var s=0;5>s;s++){var a=n[s];n[s]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}var c=y(n);return new e(c)}t.exports=c;var u=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],h=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],f=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],l=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],p=[0,1518500249,1859775393,2400959708,2840853838],d=[1352829926,1548603684,1836072691,2053994217,0],v=function(t){for(var e=[],n=0,r=0;n<t.length;n++,r+=8)e[r>>>5]|=t[n]<<24-r%32;return e},y=function(t){for(var e=[],n=0;n<32*t.length;n+=8)e.push(t[n>>>5]>>>24-n%32&255);return e},g=function(t,e,c){for(var v=0;16>v;v++){var y=c+v,g=e[y];e[y]=16711935&(g<<8|g>>>24)|4278255360&(g<<24|g>>>8)}var m,_,b,w,k,x,E,S,T,A;x=m=t[0],E=_=t[1],S=b=t[2],T=w=t[3],A=k=t[4];for(var j,v=0;80>v;v+=1)j=m+e[c+u[v]]|0,j+=16>v?n(_,b,w)+p[0]:32>v?r(_,b,w)+p[1]:48>v?i(_,b,w)+p[2]:64>v?o(_,b,w)+p[3]:s(_,b,w)+p[4],j=0|j,j=a(j,f[v]),j=j+k|0,m=k,k=w,w=a(b,10),b=_,_=j,j=x+e[c+h[v]]|0,j+=16>v?s(E,S,T)+d[0]:32>v?o(E,S,T)+d[1]:48>v?i(E,S,T)+d[2]:64>v?r(E,S,T)+d[3]:n(E,S,T)+d[4],j=0|j,j=a(j,l[v]),j=j+A|0,x=A,A=T,T=a(S,10),S=E,E=j;j=t[1]+b+T|0,t[1]=t[2]+w+A|0,t[2]=t[3]+k+x|0,t[3]=t[4]+m+E|0,t[4]=t[0]+_+S|0,t[0]=j}}).call(e,n(50).Buffer)},function(t){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t){t.exports=function(t){function e(e,n){this._block=new t(e),this._finalSize=n,this._blockSize=e,this._len=0,this._s=0}return e.prototype.init=function(){this._s=0,this._len=0},e.prototype.update=function(e,n){"string"==typeof e&&(n=n||"utf8",e=new t(e,n));for(var r=this._len+=e.length,i=this._s=this._s||0,o=0,s=this._block;r>i;){for(var a=Math.min(e.length,o+this._blockSize-i%this._blockSize),c=a-o,u=0;c>u;u++)s[i%this._blockSize+u]=e[u+o];i+=c,o+=c,i%this._blockSize===0&&this._update(s)}return this._s=i,this},e.prototype.digest=function(t){var e=8*this._len;this._block[this._len%this._blockSize]=128,this._block.fill(0,this._len%this._blockSize+1),e%(8*this._blockSize)>=8*this._finalSize&&(this._update(this._block),this._block.fill(0)),this._block.writeInt32BE(e,this._blockSize-4);var n=this._update(this._block)||this._hash();return t?n.toString(t):n},e.prototype._update=function(){throw new Error("_update must be implemented by subclass")},e}},function(t,e,n){var r=n(81).inherits;t.exports=function(t,e){function n(){return d.length?d.pop().init():this instanceof n?(this._w=p,e.call(this,64,56),this._h=null,void this.init()):new n}function i(t,e,n,r){return 20>t?e&n|~e&r:40>t?e^n^r:60>t?e&n|e&r|n&r:e^n^r}function o(t){return 20>t?1518500249:40>t?1859775393:60>t?-1894007588:-899497514}function s(t,e){return t+e|0}function a(t,e){return t<<e|t>>>32-e}var c=0,u=4,h=8,f=12,l=16,p=new("undefined"==typeof Int32Array?Array:Int32Array)(80),d=[];return r(n,e),n.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,e.prototype.init.call(this),this},n.prototype._POOL=d,n.prototype._update=function(t){var e,n,r,c,u,h,f,l,p,d;e=h=this._a,n=f=this._b,r=l=this._c,c=p=this._d,u=d=this._e;for(var v=this._w,y=0;80>y;y++){var g=v[y]=16>y?t.readInt32BE(4*y):a(v[y-3]^v[y-8]^v[y-14]^v[y-16],1),m=s(s(a(e,5),i(y,n,r,c)),s(s(u,g),o(y)));u=c,c=r,r=a(n,30),n=e,e=m}this._a=s(e,h),this._b=s(n,f),this._c=s(r,l),this._d=s(c,p),this._e=s(u,d)},n.prototype._hash=function(){d.length<100&&d.push(this);var e=new t(20);return e.writeInt32BE(0|this._a,c),e.writeInt32BE(0|this._b,u),e.writeInt32BE(0|this._c,h),e.writeInt32BE(0|this._d,f),e.writeInt32BE(0|this._e,l),e},n}},function(t,e,n){var r=n(81).inherits;t.exports=function(t,e){function n(){this.init(),this._w=p,e.call(this,64,56)}function i(t,e){return t>>>e|t<<32-e}function o(t,e){return t>>>e}function s(t,e,n){return t&e^~t&n}function a(t,e,n){return t&e^t&n^e&n}function c(t){return i(t,2)^i(t,13)^i(t,22)}function u(t){return i(t,6)^i(t,11)^i(t,25)}function h(t){return i(t,7)^i(t,18)^o(t,3)}function f(t){return i(t,17)^i(t,19)^o(t,10)}var l=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],p=new Array(64);return r(n,e),n.prototype.init=function(){return this._a=1779033703,this._b=-1150833019,this._c=1013904242,this._d=-1521486534,this._e=1359893119,this._f=-1694144372,this._g=528734635,this._h=1541459225,this._len=this._s=0,this},n.prototype._update=function(t){var e,n,r,i,o,p,d,v,y,g,m=this._w;e=0|this._a,n=0|this._b,r=0|this._c,i=0|this._d,o=0|this._e,p=0|this._f,d=0|this._g,v=0|this._h;for(var _=0;64>_;_++){var b=m[_]=16>_?t.readInt32BE(4*_):f(m[_-2])+m[_-7]+h(m[_-15])+m[_-16];y=v+u(o)+s(o,p,d)+l[_]+b,g=c(e)+a(e,n,r),v=d,d=p,p=o,o=i+y,i=r,r=n,n=e,e=y+g}this._a=e+this._a|0,this._b=n+this._b|0,this._c=r+this._c|0,this._d=i+this._d|0,this._e=o+this._e|0,this._f=p+this._f|0,this._g=d+this._g|0,this._h=v+this._h|0},n.prototype._hash=function(){var e=new t(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},n}},function(t,e,n){var r=n(81).inherits;t.exports=function(t,e){function n(){this.init(),this._w=c,e.call(this,128,112)}function i(t,e,n){return t>>>n|e<<32-n}function o(t,e,n){return t&e^~t&n}function s(t,e,n){return t&e^t&n^e&n}var a=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],c=new Array(160);return r(n,e),n.prototype.init=function(){return this._a=1779033703,this._b=-1150833019,this._c=1013904242,this._d=-1521486534,this._e=1359893119,this._f=-1694144372,this._g=528734635,this._h=1541459225,this._al=-205731576,this._bl=-2067093701,this._cl=-23791573,this._dl=1595750129,this._el=-1377402159,this._fl=725511199,this._gl=-79577749,this._hl=327033209,this._len=this._s=0,this},n.prototype._update=function(t){var e,n,r,c,u,h,f,l,p,d,v,y,g,m,_,b,w=this._w;e=0|this._a,n=0|this._b,r=0|this._c,c=0|this._d,u=0|this._e,h=0|this._f,f=0|this._g,l=0|this._h,p=0|this._al,d=0|this._bl,v=0|this._cl,y=0|this._dl,g=0|this._el,m=0|this._fl,_=0|this._gl,b=0|this._hl;for(var k=0;80>k;k++){var x,E,S=2*k;if(16>k)x=w[S]=t.readInt32BE(4*S),E=w[S+1]=t.readInt32BE(4*S+4);else{var T=w[S-30],A=w[S-30+1],j=i(T,A,1)^i(T,A,8)^T>>>7,P=i(A,T,1)^i(A,T,8)^i(A,T,7);T=w[S-4],A=w[S-4+1];var C=i(T,A,19)^i(A,T,29)^T>>>6,O=i(A,T,19)^i(T,A,29)^i(A,T,6),R=w[S-14],M=w[S-14+1],F=w[S-32],B=w[S-32+1];E=P+M,x=j+R+(P>>>0>E>>>0?1:0),E+=O,x=x+C+(O>>>0>E>>>0?1:0),E+=B,x=x+F+(B>>>0>E>>>0?1:0),w[S]=x,w[S+1]=E}var I=s(e,n,r),U=s(p,d,v),N=i(e,p,28)^i(p,e,2)^i(p,e,7),L=i(p,e,28)^i(e,p,2)^i(e,p,7),q=i(u,g,14)^i(u,g,18)^i(g,u,9),D=i(g,u,14)^i(g,u,18)^i(u,g,9),H=a[S],z=a[S+1],V=o(u,h,f),J=o(g,m,_),K=b+D,W=l+q+(b>>>0>K>>>0?1:0);K+=J,W=W+V+(J>>>0>K>>>0?1:0),K+=z,W=W+H+(z>>>0>K>>>0?1:0),K+=E,W=W+x+(E>>>0>K>>>0?1:0);var G=L+U,Y=N+I+(L>>>0>G>>>0?1:0);l=f,b=_,f=h,_=m,h=u,m=g,g=y+K|0,u=c+W+(y>>>0>g>>>0?1:0)|0,c=r,y=v,r=n,v=d,n=e,d=p,p=K+G|0,e=W+Y+(K>>>0>p>>>0?1:0)|0}this._al=this._al+p|0,this._bl=this._bl+d|0,this._cl=this._cl+v|0,this._dl=this._dl+y|0,this._el=this._el+g|0,this._fl=this._fl+m|0,this._gl=this._gl+_|0,this._hl=this._hl+b|0,this._a=this._a+e+(this._al>>>0<p>>>0?1:0)|0,this._b=this._b+n+(this._bl>>>0<d>>>0?1:0)|0,this._c=this._c+r+(this._cl>>>0<v>>>0?1:0)|0,this._d=this._d+c+(this._dl>>>0<y>>>0?1:0)|0,this._e=this._e+u+(this._el>>>0<g>>>0?1:0)|0,this._f=this._f+h+(this._fl>>>0<m>>>0?1:0)|0,this._g=this._g+f+(this._gl>>>0<_>>>0?1:0)|0,this._h=this._h+l+(this._hl>>>0<b>>>0?1:0)|0
},n.prototype._hash=function(){function e(t,e,r){n.writeInt32BE(t,r),n.writeInt32BE(e,r+4)}var n=new t(64);return e(this._a,this._al,0),e(this._b,this._bl,8),e(this._c,this._cl,16),e(this._d,this._dl,24),e(this._e,this._el,32),e(this._f,this._fl,40),e(this._g,this._gl,48),e(this._h,this._hl,56),n},n}},function(t,e){(function(e){t.exports=function(){if(void 0!==this)return this;try{return e}catch(t){}try{return window}catch(t){}try{return self}catch(t){}}()}).call(e,function(){return this}())},function(t,e,n){"use strict";function r(t){try{p(t,"isAsync",!0)}catch(e){}}function i(t){return null==t?!1:t instanceof c||t.isAsync===!0}function o(t){return t instanceof d}function s(t){return o(t)}function a(t,e){function n(r){return this instanceof n?(this.message="string"==typeof r?r:e,this.name=t,void(d.captureStackTrace&&d.captureStackTrace(this,this.constructor))):new n(r)}return l(n,d),n}function c(t){this.name="RejectionError",this.message=t,this.cause=t,this.isAsync=!0,t instanceof d?(this.message=t.message,this.stack=t.stack):d.captureStackTrace&&d.captureStackTrace(this,this.constructor)}var u=n(105),h=n(142).freeze,f=n(107),l=f.inherits,p=f.notEnumerableProp,d=u.Error,v=u.TypeError;"function"!=typeof v&&(v=a("TypeError","type error"));var y=u.RangeError;"function"!=typeof y&&(y=a("RangeError","range error"));var g=a("CancellationError","cancellation error"),m=a("TimeoutError","timeout error");l(c,d);var _="__BluebirdErrorTypes__",b=u[_];b||(b=h({CancellationError:g,TimeoutError:m,RejectionError:c}),p(u,_,b)),t.exports={Error:d,TypeError:v,RangeError:y,CancellationError:b.CancellationError,RejectionError:b.RejectionError,TimeoutError:b.TimeoutError,originatesFromRejection:i,markAsOriginatingFromRejection:r,canAttach:s}},function(t,e,n){"use strict";function r(t){"undefined"!=typeof console&&null!==console&&"function"==typeof console.warn&&console.warn("Bluebird: "+t)}function i(t,e,n){try{return t.call(e,n)}catch(r){return _.e=r,_}}function o(t,e,n,r){try{return t.call(e,n,r)}catch(i){return _.e=i,_}}function s(t,e,n){try{return t.apply(n,e)}catch(r){return _.e=r,_}}function a(t){return"string"==typeof t?t:""+t}function c(t){return null==t||t===!0||t===!1||"string"==typeof t||"number"==typeof t}function u(t){return!c(t)}function h(t){return c(t)?new Error(a(t)):t}function f(t,e){var n,r=t.length,i=new Array(r+1);for(n=0;r>n;++n)i[n]=t[n];return i[n]=e,i}function l(t,e,n){if(c(t))return t;var r={value:n,configurable:!0,enumerable:!1,writable:!0};return y.defineProperty(t,e,r),t}function p(t){throw t}function d(t){function e(){}return e.prototype=t,e}var v=n(105),y=n(142),g=function(){try{var t={};return y.defineProperty(t,"f",{get:function(){return 3}}),3===t.f}catch(e){return!1}}(),m=function(){return"undefined"!=typeof window&&null!==window&&"undefined"!=typeof window.document&&"undefined"!=typeof navigator&&null!==navigator&&"string"==typeof navigator.appName&&window===v?!1:!0}(),_={e:{}},b=function(t,e){function n(){this.constructor=t,this.constructor$=e;for(var n in e.prototype)r.call(e.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=e.prototype[n])}var r={}.hasOwnProperty;return n.prototype=e.prototype,t.prototype=new n,t.prototype},w=function(){return"string"!==this}.call("string"),k={thrower:p,isArray:y.isArray,haveGetters:g,notEnumerableProp:l,isPrimitive:c,isObject:u,canEvaluate:m,deprecated:r,errorObj:_,tryCatch1:i,tryCatch2:o,tryCatchApply:s,inherits:b,withAppended:f,asString:a,maybeWrapAsError:h,wrapsPrimitiveReceiver:w,toFastProperties:d};t.exports=k},function(t,e,n){"use strict";t.exports=function(t,e){function r(t){switch(t){case-1:return void 0;case-2:return[];case-3:return{}}}function i(n,r){var i=this._promise=new t(e),o=void 0;n instanceof t&&(o=n,n._cancellable()&&(i._setCancellable(),i._cancellationParent=n),n._isBound()&&i._setBoundTo(r)),i._setTrace(o),this._values=n,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var o=n(106).canAttach,s=n(107),a=n(109),c={}.hasOwnProperty,u=s.isArray;return i.PropertiesPromiseArray=function(){},i.prototype.length=function(){return this._length},i.prototype.promise=function(){return this._promise},i.prototype._init=function(e,n){var o=this._values;if(o instanceof t){if(!o.isFulfilled())return o.isPending()?void o._then(this._init,this._reject,void 0,this,n):(o._unsetRejectionIsUnhandled(),void this._reject(o._settledValue));if(o=o._settledValue,!u(o)){var s=new t.TypeError("expecting an array, a promise or a thenable");return void this.__hardReject__(s)}this._values=o}if(0===o.length)return void this._resolve(r(n));var h,f=o.length,l=f;h=this instanceof i.PropertiesPromiseArray?this._values:new Array(f);for(var p=!1,d=0;f>d;++d){var v=o[d];if(void 0!==v||c.call(o,d)){var y=t._cast(v,void 0);y instanceof t?y.isPending()?y._proxyPromiseArray(this,d):(y._unsetRejectionIsUnhandled(),p=!0):p=!0,h[d]=y}else l--}if(0===l)return void this._resolve(-2===n?h:r(n));if(this._values=h,this._length=l,p){var g=l===f?this._scanDirectValues:this._scanDirectValuesHoled;a.invoke(g,this,f)}},i.prototype._settlePromiseAt=function(e){var n=this._values[e];n instanceof t?n.isFulfilled()?this._promiseFulfilled(n._settledValue,e):n.isRejected()&&this._promiseRejected(n._settledValue,e):this._promiseFulfilled(n,e)},i.prototype._scanDirectValuesHoled=function(t){for(var e=0;t>e&&!this._isResolved();++e)c.call(this._values,e)&&this._settlePromiseAt(e)},i.prototype._scanDirectValues=function(t){for(var e=0;t>e&&!this._isResolved();++e)this._settlePromiseAt(e)},i.prototype._isResolved=function(){return null===this._values},i.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},i.prototype.__hardReject__=i.prototype._reject=function(t){this._values=null;var e=o(t)?t:new Error(t+"");this._promise._attachExtraTrace(e),this._promise._reject(t,e)},i.prototype._promiseProgressed=function(t,e){this._isResolved()||this._promise._progress({index:e,value:t})},i.prototype._promiseFulfilled=function(t,e){if(!this._isResolved()){this._values[e]=t;var n=++this._totalResolved;n>=this._length&&this._resolve(this._values)}},i.prototype._promiseRejected=function(t){this._isResolved()||(this._totalResolved++,this._reject(t))},i}},function(t,e,n){"use strict";function r(){this._isTickUsed=!1,this._length=0,this._lateBuffer=new o,this._functionBuffer=new o(75e3);var t=this;this.consumeFunctionBuffer=function(){t._consumeFunctionBuffer()}}var i=n(143),o=n(144),s=n(107).errorObj,a=n(107).tryCatch1,c=n(105).process;r.prototype.haveItemsQueued=function(){return this._length>0},r.prototype.invokeLater=function(t,e,n){void 0===c||null==c.domain||t.domain||(t=c.domain.bind(t)),this._lateBuffer.push(t,e,n),this._queueTick()},r.prototype.invoke=function(t,e,n){void 0===c||null==c.domain||t.domain||(t=c.domain.bind(t));var r=this._functionBuffer;r.push(t,e,n),this._length=r.length(),this._queueTick()},r.prototype._consumeFunctionBuffer=function(){for(var t=this._functionBuffer;t.length()>0;){var e=t.shift(),n=t.shift(),r=t.shift();e.call(n,r)}this._reset(),this._consumeLateBuffer()},r.prototype._consumeLateBuffer=function(){for(var t=this._lateBuffer;t.length()>0;){var e=t.shift(),n=t.shift(),r=t.shift(),i=a(e,n,r);if(i===s){if(this._queueTick(),null==e.domain)throw i.e;e.domain.emit("error",i.e)}}},r.prototype._queueTick=function(){this._isTickUsed||(i(this.consumeFunctionBuffer),this._isTickUsed=!0)},r.prototype._reset=function(){this._isTickUsed=!1,this._length=0},t.exports=new r},function(t,e,n){"use strict";t.exports=function(){function t(t){var n;if("function"==typeof t)n="[function "+(t.name||"anonymous")+"]";else{n=t.toString();var r=/\[object [a-zA-Z0-9$_]+\]/;if(r.test(n))try{var i=JSON.stringify(t);n=i}catch(o){}0===n.length&&(n="(empty array)")}return"(<"+e(n)+">, no stack trace)"}function e(t){var e=41;return t.length<e?t:t.substr(0,e-3)+"..."}function r(t,e){this.captureStackTrace(r,e)}var i=n(107).inherits,o=n(142).defineProperty,s=new RegExp("\\b(?:[a-zA-Z0-9.]+\\$_\\w+|tryCatch(?:1|2|Apply)|new \\w*PromiseArray|\\w*PromiseArray\\.\\w*PromiseArray|setTimeout|CatchFilter\\$_\\w+|makeNodePromisified|processImmediate|process._tickCallback|nextTick|Async\\$\\w+)\\b"),a=null,c=null;i(r,Error),r.prototype.captureStackTrace=function(t,e){u(this,t,e)},r.possiblyUnhandledRejection=function(t){if("object"==typeof console){var e;if("object"==typeof t||"function"==typeof t){var n=t.stack;e="Possibly unhandled "+c(n,t)}else e="Possibly unhandled "+String(t);"function"==typeof console.error||"object"==typeof console.error?console.error(e):("function"==typeof console.log||"object"==typeof console.log)&&console.log(e)}},r.combine=function(t,e){for(var n=t.length-1,r=e.length-1;r>=0;--r){var i=e[r];if(t[n]!==i)break;t.pop(),n--}t.push("From previous event:");for(var o=t.concat(e),c=[],r=0,u=o.length;u>r;++r)s.test(o[r])||r>0&&!a.test(o[r])&&"From previous event:"!==o[r]||c.push(o[r]);return c},r.isSupported=function(){return"function"==typeof u};var u=function h(){if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){a=/^\s*at\s*/,c=function(e,n){return"string"==typeof e?e:void 0!==n.name&&void 0!==n.message?n.name+". "+n.message:t(n)};var e=Error.captureStackTrace;return function(t,n){e(t,n)}}var n=new Error;if("string"==typeof n.stack&&"function"==typeof"".startsWith&&n.stack.startsWith("stackDetection@")&&"stackDetection"===h.name){o(Error,"stackTraceLimit",{writable:!0,enumerable:!1,configurable:!1,value:25}),a=/@/;var r=/[@\n]/;return c=function(e,n){return"string"==typeof e?n.name+". "+n.message+"\n"+e:void 0!==n.name&&void 0!==n.message?n.name+". "+n.message:t(n)},function(t){for(var e=(new Error).stack,n=e.split(r),i=n.length,o="",s=0;i>s;s+=2)o+=n[s],o+="@",o+=n[s+1],o+="\n";t.stack=o}}return c=function(e,n){return"string"==typeof e?e:"object"!=typeof n&&"function"!=typeof n||void 0===n.name||void 0===n.message?t(n):n.name+". "+n.message},null}();return r}},function(t,e,n){"use strict";t.exports=function(t){function e(t,e,n){this._instances=t,this._callback=e,this._promise=n}function r(t,e){var n={},r=s(t,n,e);if(r===a)return r;var i=c(n);return i.length?(a.e=new u("Catch filter must inherit from Error or be a simple predicate function"),a):r}var i=n(107),o=n(106),s=i.tryCatch1,a=i.errorObj,c=n(142).keys,u=o.TypeError;return e.prototype.doFilter=function(e){for(var n=this._callback,i=this._promise,c=i._isBound()?i._boundTo:void 0,u=0,h=this._instances.length;h>u;++u){var f=this._instances[u],l=f===Error||null!=f&&f.prototype instanceof Error;if(l&&e instanceof f){var p=s(n,c,e);return p===a?(t.e=p.e,t):p}if("function"==typeof f&&!l){var d=r(f,e);if(d===a){var v=o.canAttach(a.e)?a.e:new Error(a.e+"");this._promise._attachExtraTrace(v),e=a.e;break}if(d){var p=s(n,c,e);return p===a?(t.e=p.e,t):p}}}return t.e=e,t},e}},function(t,e,n){"use strict";function r(t){return t instanceof Error&&d.getPrototypeOf(t)===Error.prototype}function i(t){var e;return e=r(t)?new f(t):t,u.markAsOriginatingFromRejection(e),e}function o(t){function e(e,n){if(null!==t){if(e){var r=i(c(e));t._attachExtraTrace(r),t._reject(r)}else if(arguments.length>2){for(var o=arguments.length,s=new Array(o-1),a=1;o>a;++a)s[a-1]=arguments[a];t._fulfill(s)}else t._fulfill(n);t=null}}return e}var s,a=n(107),c=a.maybeWrapAsError,u=n(106),h=u.TimeoutError,f=u.RejectionError,l=n(109),p=a.haveGetters,d=n(142);if(s=p?function(t){this.promise=t}:function(t){this.promise=t,this.asCallback=o(t),this.callback=this.asCallback},p){var v={get:function(){return o(this.promise)}};d.defineProperty(s.prototype,"asCallback",v),d.defineProperty(s.prototype,"callback",v)}s._nodebackForPromise=o,s.prototype.toString=function(){return"[object PromiseResolver]"},s.prototype.resolve=s.prototype.fulfill=function(t){var e=this.promise;if(void 0===e||void 0===e._tryFollow)throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");e._tryFollow(t)||l.invoke(e._fulfill,e,t)},s.prototype.reject=function(t){var e=this.promise;if(void 0===e||void 0===e._attachExtraTrace)throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");u.markAsOriginatingFromRejection(t);var n=u.canAttach(t)?t:new Error(t+"");e._attachExtraTrace(n),l.invoke(e._reject,e,t),n!==t&&l.invoke(this._setCarriedStackTrace,this,n)},s.prototype.progress=function(t){l.invoke(this.promise._progress,this.promise,t)},s.prototype.cancel=function(){l.invoke(this.promise.cancel,this.promise,void 0)},s.prototype.timeout=function(){this.reject(new h("timeout"))},s.prototype.isResolved=function(){return this.promise.isResolved()},s.prototype.toJSON=function(){return this.promise.toJSON()},s.prototype._setCarriedStackTrace=function(t){this.promise.isRejected()&&this.promise._setCarriedStackTrace(t)},t.exports=s},function(t,e,n){"use strict";t.exports=function(t){function e(e){var n=new r(e),i=t.rejected(n),o=i._peekContext();return null!=o&&o._attachExtraTrace(n),i}var r=n(106).TypeError;return e}},function(t,e,n){"use strict";t.exports=function(t,e){function r(){return this}function i(){throw this}function o(t){return function(){return t}}function s(t){return function(){throw t}}function a(t,e,n){var a;return a=f&&l(e)?n?o(e):s(e):n?r:i,t._then(a,p,void 0,e,void 0)}function c(n){var r=this.promise,i=this.handler,o=r._isBound()?i.call(r._boundTo):i();if(void 0!==o){var s=t._cast(o,void 0);if(s instanceof t)return a(s,n,r.isFulfilled())}return r.isRejected()?(e.e=n,e):n}function u(e){var n=this.promise,r=this.handler,i=n._isBound()?r.call(n._boundTo,e):r(e);if(void 0!==i){var o=t._cast(i,void 0);if(o instanceof t)return a(o,e,!0)}return e}var h=n(107),f=h.wrapsPrimitiveReceiver,l=h.isPrimitive,p=h.thrower;t.prototype._passThroughHandler=function(t,e){if("function"!=typeof t)return this.then();var n={promise:this,handler:t};return this._then(e?c:u,e?c:void 0,void 0,n,void 0)},t.prototype.lastly=t.prototype["finally"]=function(t){return this._passThroughHandler(t,!0)},t.prototype.tap=function(t){return this._passThroughHandler(t,!1)}}},function(t,e,n){"use strict";var r=n(107),i=r.isPrimitive,o=r.wrapsPrimitiveReceiver;t.exports=function(t){var e=function(){return this},n=function(){throw this},r=function(t,e){return 1===e?function(){throw t}:2===e?function(){return t}:void 0};t.prototype["return"]=t.prototype.thenReturn=function(t){return o&&i(t)?this._then(r(t,2),void 0,void 0,void 0,void 0):this._then(e,void 0,void 0,t,void 0)},t.prototype["throw"]=t.prototype.thenThrow=function(t){return o&&i(t)?this._then(r(t,1),void 0,void 0,void 0,void 0):this._then(n,void 0,void 0,t,void 0)}}},function(t,e,n){"use strict";t.exports=function(t,e){function r(t){try{return t.then}catch(e){return u.e=e,u}}function i(n,i){if(h(n)){if(n instanceof t)return n;if(o(n)){var a=new t(e);return a._setTrace(void 0),n._then(a._fulfillUnchecked,a._rejectUncheckedCheckError,a._progressUnchecked,a,null),a._setFollowing(),a}var f=r(n);if(f===u)return void 0!==i&&c(f.e)&&i._attachExtraTrace(f.e),t.reject(f.e);if("function"==typeof f)return s(n,f,i)}return n}function o(t){return f.call(t,"_promise0")}function s(e,n,r){function i(n){if(!u){if(u=!0,e===n){var i=t._makeSelfResolutionError();return void 0!==r&&r._attachExtraTrace(i),void a.promise._reject(i,void 0)}a.resolve(n)}}function o(t){if(!u){u=!0;var e=c(t)?t:new Error(t+"");void 0!==r&&r._attachExtraTrace(e),a.promise._reject(t,e)}}function s(t){if(!u){var e=a.promise;"function"==typeof e._progress&&e._progress(t)}}var a=t.defer(),u=!1;try{n.call(e,i,o,s)}catch(h){if(!u){u=!0;var f=c(h)?h:new Error(h+"");void 0!==r&&r._attachExtraTrace(f),a.promise._reject(h,f)}}return a.promise}var a=n(107),c=n(106).canAttach,u=a.errorObj,h=a.isObject,f={}.hasOwnProperty;t._cast=i}},function(t){"use strict";t.exports=function(t){function e(t){void 0!==t?(this._bitField=t._bitField,this._settledValue=t.isResolved()?t._settledValue:void 0):(this._bitField=0,this._settledValue=void 0)}e.prototype.isFulfilled=t.prototype.isFulfilled=function(){return(268435456&this._bitField)>0},e.prototype.isRejected=t.prototype.isRejected=function(){return(134217728&this._bitField)>0},e.prototype.isPending=t.prototype.isPending=function(){return 0===(402653184&this._bitField)},e.prototype.value=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise");return this._settledValue},e.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise");return this._settledValue},e.prototype.isResolved=t.prototype.isResolved=function(){return(402653184&this._bitField)>0},t.prototype.inspect=function(){return new e(this)},t.PromiseInspection=e}},function(t,e,n){"use strict";var r=n(105),i=function(t,e){for(var n=arguments.length,i=new Array(n-2),o=2;n>o;++o)i[o-2]=arguments[o];r.setTimeout(function(){t.apply(void 0,i)},e)};t.exports=function(t,e){var r=(n(107),n(106)),o=(n(113)(t),t.TimeoutError),s=function(t,e,n){if(t.isPending()){"string"!=typeof e&&(e="operation timed out after "+n+" ms");var i=new o(e);r.markAsOriginatingFromRejection(i),t._attachExtraTrace(i),t._rejectUnchecked(i)}},a=function(t,e){e._fulfill(t)},c=t.delay=function(n,r){void 0===r&&(r=n,n=void 0),r=+r;var o=t._cast(n,void 0),s=new t(e);return o instanceof t?(o._isBound()&&s._setBoundTo(o._boundTo),o._cancellable()&&(s._setCancellable(),s._cancellationParent=o),s._setTrace(o),s._follow(o),s.then(function(e){return t.delay(e,r)})):(s._setTrace(void 0),i(a,r,n,s),s)};t.prototype.delay=function(t){return c(this,t)},t.prototype.timeout=function(n,r){n=+n;var o=new t(e);return o._setTrace(this),this._isBound()&&o._setBoundTo(this._boundTo),this._cancellable()&&(o._setCancellable(),o._cancellationParent=this),o._follow(this),i(s,n,o,r,n),o}}},function(t,e,n){"use strict";t.exports=function(t,e,r){function i(t,n){var r=e(t,o,n===!0&&t._isBound()?t._boundTo:void 0),i=r.promise();return i.isRejected()?i:(r.setHowMany(1),r.setUnwrap(),r.init(),i)}var o=n(145)(r);t.any=function(t){return i(t,!1)},t.prototype.any=function(){return i(this,!0)}}},function(t,e,n){"use strict";t.exports=function(t,e){function r(n,r){var c=t._cast(n,void 0);if(c instanceof t)return s(c);if(!o(n))return i("expecting an array, a promise or a thenable");var u=new t(e);u._setTrace(r),void 0!==r&&(r._isBound()&&u._setBoundTo(r._boundTo),r._cancellable()&&(u._setCancellable(),u._cancellationParent=r));for(var h=u._fulfill,f=u._reject,l=0,p=n.length;p>l;++l){var d=n[l];(void 0!==d||a.call(n,l))&&t.cast(d)._then(h,f,void 0,u,null)}return u}var i=n(113)(t),o=n(107).isArray,s=function(t){return t.then(function(e){return r(e,t)})},a={}.hasOwnProperty;t.race=function(t){return r(t,void 0)},t.prototype.race=function(){return r(this,void 0)}}},function(t){"use strict";t.exports=function(t){function e(t){var e="string"==typeof this?this:""+this;return t[e]}t.prototype.call=function(t){for(var e=arguments.length,n=new Array(e-1),r=1;e>r;++r)n[r-1]=arguments[r];return this._then(function(e){return e[t].apply(e,n)},void 0,void 0,void 0,void 0)},t.prototype.get=function(t){return this._then(e,void 0,void 0,t,void 0)}}},function(t,e,n){"use strict";t.exports=function(t){function e(e){for(var n=this instanceof t?this._settledValue:this,r=n.length,i=new Array(r),o=0,s=0;r>s;++s)e[s]&&(i[o++]=n[s]);return i.length=o,i}var r=(n(107).isArray,{ref:null});t.filter=function(n,i){return t.map(n,i,r)._then(e,void 0,void 0,r.ref,void 0)},t.prototype.filter=function(t){return this.map(t,r)._then(e,void 0,void 0,r.ref,void 0)}}},function(t,e,n){"use strict";t.exports=function(t,e,r){var i=n(146)(t,r),o=n(106),s=o.TypeError,a=n(107).deprecated;t.coroutine=function(t){if("function"!=typeof t)throw new s("generatorFunction must be a function");var e=i;return function(){var n=t.apply(this,arguments),r=new e(void 0,void 0);return r._generator=n,r._next(void 0),r.promise()}},t.coroutine.addYieldHandler=i.addYieldHandler,t.spawn=function(n){if(a("Promise.spawn is deprecated. Use Promise.coroutine instead."),"function"!=typeof n)return e("generatorFunction must be a function");var r=new i(n,this),o=r.promise();return r._run(t.spawn),o}}},function(t,e,n){"use strict";t.exports=function(t,e,r,i){function o(t){return s(t,this[0],this[1],this[2])}function s(e,n,s,c){if("function"!=typeof n)return i("fn must be a function");var u=void 0;s===!0?e._isBound()&&(u=e._boundTo):s!==!1&&(u=s);var h=void 0!==c;if(h&&(c.ref=e),e instanceof t){var l=[n,u,c];return e._then(o,void 0,void 0,l,void 0)}if(!f(e))return i("expecting an array, a promise or a thenable");var p=new t(r);void 0!==u&&p._setBoundTo(u),p._setTrace(void 0);var d=new a(p,n,e,u,h);return d.init(),p}function a(t,e,n,r,i){this.shouldUnwrapItems=i,this.index=0,this.items=n,this.callback=e,this.receiver=r,this.promise=t,this.result=new Array(n.length)}var c=t.all,u=n(107),h=n(106).canAttach,f=u.isArray,l=t._cast,p={};u.inherits(a,e),a.prototype.init=function(){for(var e=this.items,n=e.length,r=this.result,i=!1,o=0;n>o;++o){var s=l(e[o],void 0);s instanceof t?s.isPending()?(r[o]=p,s._proxyPromiseArray(this,o)):s.isFulfilled()?r[o]=s.value():(s._unsetRejectionIsUnhandled(),i||(this.reject(s.reason()),i=!0)):r[o]=s}i||this.iterate()},a.prototype.isResolved=function(){return null===this.promise},a.prototype._promiseProgressed=function(t){this.isResolved()||this.promise._progress(t)},a.prototype._promiseFulfilled=function(t,e){this.isResolved()||(this.result[e]=t,this.shouldUnwrapItems&&(this.items[e]=t),this.index===e&&this.iterate())},a.prototype._promiseRejected=function(t){this.reject(t)},a.prototype.reject=function(t){if(!this.isResolved()){var e=h(t)?t:new Error(t+"");this.promise._attachExtraTrace(e),this.promise._reject(t,e)}},a.prototype.iterate=function(){for(var t=this.index,e=this.items,n=this.result,r=e.length,n=this.result,i=this.receiver,o=this.callback;r>t;++t){var s=n[t];if(s===p)return void(this.index=t);try{n[t]=o.call(i,s,t,r)}catch(a){return this.reject(a)}}this.promise._follow(c(n)),this.items=this.result=this.callback=this.promise=null},t.prototype.map=function(t,e){return s(this,t,!0,e)},t.map=function(t,e,n){return s(t,e,!1,n)}}},function(t,e,n){"use strict";t.exports=function(t){function e(t){throw t}function r(t,n){var r=this,i=void 0===t?c(r,n,null):a(r,n,null,t);i===u&&s.invokeLater(e,void 0,i.e)}function i(t,n){var r=this,i=c(r,n,t);i===u&&s.invokeLater(e,void 0,i.e)}var o=n(107),s=n(109),a=o.tryCatch2,c=o.tryCatch1,u=o.errorObj;t.prototype.nodeify=function(t){return"function"==typeof t&&this._then(r,i,void 0,t,this._isBound()?this._boundTo:null),this}}},function(t,e,n){"use strict";t.exports=function(t,e){function r(t){return t.__isPromisified__===!0}function i(t,e){var n=e+"Async"in t;return n?r(t[e+"Async"]):!1}function o(t){for(var e=0;e<t.length;e+=2){var n=t[e];if(k.test(n))for(var r=n.replace(k,""),i=0;i<t.length;i+=2)if(t[i]===r)throw new w("Cannot promisify an API that has normal methods with Async-suffix")}}function s(t){for(var e=[t],n=Math.max(0,t-1-5),r=t-1;r>=n;--r)r!==t&&e.push(r);for(var r=t+1;5>=r;++r)e.push(r);return e}function a(t){for(var e=new Array(t),n=0;n<e.length;++n)e[n]="_arg"+n;return e.join(", ")}function c(t){return"number"==typeof t.length?Math.max(Math.min(t.length,1024),0):0}function u(t){return E.test(t)?"."+t:"['"+t.replace(/(['\\])/g,"\\$1")+"']"}function h(n,r,i,o){function h(t){for(var e=new Array(t),i=0,o=e.length;o>i;++i)e[i]="arguments["+i+"]";var s=t>0?",":"";return"string"==typeof n&&r===p?"this"+u(n)+"("+e.join(",")+s+" fn);break;":(void 0===r?"callback("+e.join(",")+s+" fn);":"callback.call("+(r===p?"this":"receiver")+", "+e.join(",")+s+" fn);")+"break;"}function f(){for(var t="",e=0;e<d.length;++e)t+="case "+d[e]+":"+h(d[e]);return t+="default: var args = new Array(len + 1);var i = 0;for (var i = 0; i < len; ++i) {    args[i] = arguments[i];}args[i] = fn;"+("string"==typeof n?"this"+u(n)+".apply(":"callback.apply(")+(r===p?"this":"receiver")+", args); break;"}var l=Math.max(0,c(o)-1),d=s(l),v="string"==typeof i?i+"Async":"promisified";return E.test(v)||(v="promisified"),new Function("Promise","callback","receiver","withAppended","maybeWrapAsError","nodebackForPromise","INTERNAL","var ret = function "+v+"("+a(l)+') {"use strict";var len = arguments.length;var promise = new Promise(INTERNAL);promise._setTrace(void 0);var fn = nodebackForPromise(promise);try {switch(len) {'+f()+"}}catch(e){ var wrapped = maybeWrapAsError(e);promise._attachExtraTrace(wrapped);promise._reject(wrapped);}return promise;}; ret.__isPromisified__ = true; return ret;")(t,n,r,g,m,y,e)}function f(n,r){function i(){var i=r;r===p&&(i=this),"string"==typeof n&&(n=i[n]);var o=new t(e);o._setTrace(void 0);var s=y(o);try{n.apply(i,g(arguments,s))}catch(a){var c=m(a);o._attachExtraTrace(c),o._reject(c)}return o}return i.__isPromisified__=!0,i}function l(t,e,n){if(n){for(var r=x(t),i=0,o=r.length;o>i;i+=2){var s=r[i],a=r[i+1],c=s+"Async";t[c]=S(s,p,s,a)}return d.toFastProperties(t),t}return S(t,e,void 0,t)}var p={},d=n(107),v=n(142),y=n(112)._nodebackForPromise,g=d.withAppended,m=d.maybeWrapAsError,_=d.canEvaluate,b=d.deprecated,w=n(106).TypeError,k=new RegExp("Async$"),x=function(){if(v.isES5){var t=Object.create,e=Object.getOwnPropertyDescriptor;return function(n){for(var s=[],a=t(null),c=n;null!==n;){for(var u=v.keys(n),h=0,f=u.length;f>h;++h){var l=u[h];if(!a[l]){a[l]=!0;var p=e(n,l);null==p||"function"!=typeof p.value||r(p.value)||i(c,l)||s.push(l,p.value)}}n=v.getPrototypeOf(n)}return o(s),s}}return function(t){var e=[];for(var n in t){var s=t[n];"function"!=typeof s||r(s)||i(t,n)||e.push(n,s)}return o(e),e}}(),E=/^[a-z$_][a-z$_0-9]*$/i,S=_?h:f;t.promisify=function(t,e){if("object"==typeof t&&null!==t)return b("Promise.promisify for promisifying entire objects is deprecated. Use Promise.promisifyAll instead."),l(t,e,!0);if("function"!=typeof t)throw new w("fn must be a function");return r(t)?t:l(t,arguments.length<2?p:e,!1)},t.promisifyAll=function(t){if("function"!=typeof t&&"object"!=typeof t)throw new w("the target of promisifyAll must be an object or a function");return l(t,void 0,!0)}}},function(t,e,n){"use strict";t.exports=function(t,e){function r(e,n){var r,o=t._cast(e,void 0);return a(o)?(o instanceof t?r=o._then(t.props,void 0,void 0,void 0,void 0):(r=new i(o,n===!0&&o._isBound()?o._boundTo:void 0).promise(),n=!1),n===!0&&o._isBound()&&r._setBoundTo(o._boundTo),r):s("cannot await properties of a non-object")}var i=n(147)(t,e),o=n(107),s=n(113)(t),a=o.isObject;t.prototype.props=function(){return r(this,!0)},t.props=function(t){return r(t,!1)}}},function(t){"use strict";t.exports=function(t,e,n,r,i){function o(e,n,r,o,s){this.promise=new t(i),this.index=n,this.length=o.length,this.items=o,this.callback=e,this.receiver=s,this.accum=r}function s(t,e){var n=this,r=void 0;"function"!=typeof n&&(r=n.receiver,n=n.fn);var i=t.length,s=void 0,a=0;void 0!==e?(s=e,a=0):(a=1,i>0&&(s=t[0]));var c=a;if(c>=i)return s;var u=new o(n,c,s,t,r);return u.iterate(),u.promise}function a(t){var e=this.fn,n=this.initialValue;return s.call(e,t,n)}function c(t,e,n,r){return n._then(function(n){return u(t,e,n,r)},void 0,void 0,void 0,void 0)}function u(i,o,u,h){if("function"!=typeof o)return r("fn must be a function");if(h===!0&&i._isBound()&&(o={fn:o,receiver:i._boundTo}),void 0!==u){if(u instanceof t){if(!u.isFulfilled())return c(i,o,u,h);u=u._settledValue}return e(i,n,h===!0&&i._isBound()?i._boundTo:void 0).promise()._then(a,void 0,void 0,{fn:o,initialValue:u},void 0)}return e(i,n,h===!0&&i._isBound()?i._boundTo:void 0).promise()._then(s,void 0,void 0,o,void 0)}o.prototype.reject=function(t){this.promise._reject(t)},o.prototype.fulfill=function(t,e){this.accum=t,this.index=e+1,this.iterate()},o.prototype.iterate=function(){for(var e=this.index,n=this.length,r=this.items,i=this.accum,o=this.receiver,s=this.callback;n>e;++e)if(i=s.call(o,i,r[e],e,n),i=t._cast(i,void 0),i instanceof t)return void i._then(this.fulfill,this.reject,void 0,this,e);this.promise._fulfill(i)},t.reduce=function(t,e,n){return u(t,e,n,!1)},t.prototype.reduce=function(t,e){return u(this,t,e,!0)}}},function(t,e,n){"use strict";t.exports=function(t,e,r){function i(t,n){return e(t,o,n===!0&&t._isBound()?t._boundTo:void 0).promise()}var o=n(148)(t,r);t.settle=function(t){return i(t,!1)},t.prototype.settle=function(){return i(this,!0)}}},function(t,e,n){"use strict";t.exports=function(t,e,r,i){function o(t,n,r){if((0|n)!==n||0>n)return i("expecting a positive integer");var o=e(t,s,r===!0&&t._isBound()?t._boundTo:void 0),a=o.promise();return a.isRejected()?a:(o.setHowMany(n),o.init(),a)}var s=n(145)(r);t.some=function(t,e){return o(t,e,!1)},t.prototype.some=function(t){return o(this,t,!0)}}},function(t,e,n){"use strict";t.exports=function(t,e){var r=n(107),i=n(109),o=n(106),s=r.tryCatch1,a=r.errorObj;t.prototype.progressed=function(t){return this._then(void 0,void 0,t,void 0,void 0)},t.prototype._progress=function(t){this._isFollowingOrFulfilledOrRejected()||this._progressUnchecked(t)},t.prototype._progressHandlerAt=function(t){return 0===t?this._progressHandler0:this[t+2-5]},t.prototype._doProgressWith=function(e){var n=e.value,r=e.handler,i=e.promise,c=e.receiver;this._pushContext();var u=s(r,c,n);if(this._popContext(),u===a){if(null!=u.e&&"StopProgressPropagation"!==u.e.name){var h=o.canAttach(u.e)?u.e:new Error(u.e+"");i._attachExtraTrace(h),i._progress(u.e)}}else u instanceof t?u._then(i._progress,null,null,i,void 0):i._progress(u)},t.prototype._progressUnchecked=function(n){if(this.isPending())for(var r=this._length(),o=this._progress,s=0;r>s;s+=5){var a=this._progressHandlerAt(s),c=this._promiseAt(s);if(c instanceof t)"function"==typeof a?i.invoke(this._doProgressWith,this,{handler:a,promise:c,receiver:this._receiverAt(s),value:n}):i.invoke(o,c,n);else{var u=this._receiverAt(s);"function"==typeof a?a.call(u,n,c):u instanceof t&&u._isProxied()?u._progressUnchecked(n):e(u,c)&&u._promiseProgressed(n,c)}}}}},function(t,e,n){"use strict";t.exports=function(t,e){var r=n(106),i=n(109),o=r.CancellationError;t.prototype._cancel=function(){if(!this.isCancellable())return this;for(var t,e=this;void 0!==(t=e._cancellationParent)&&t.isCancellable();)e=t;var n=new o;e._attachExtraTrace(n),e._rejectUnchecked(n)},t.prototype.cancel=function(){return this.isCancellable()?(i.invokeLater(this._cancel,this,void 0),this):this},t.prototype.cancellable=function(){return this._cancellable()?this:(this._setCancellable(),this._cancellationParent=void 0,this)},t.prototype.uncancellable=function(){var n=new t(e);return n._setTrace(this),n._follow(this),n._unsetCancellable(),this._isBound()&&n._setBoundTo(this._boundTo),n},t.prototype.fork=function(t,e,n){var r=this._then(t,e,n,void 0,void 0);return r._setCancellable(),r._cancellationParent=void 0,r}}},function(t,e,n){"use strict";function r(t){if(!y(t))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof r))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],i(t,this)}function i(t,e){function n(t){u(e,t)}function r(t){f(e,t)}try{t(n,r)}catch(i){r(i)}}function o(t,e,n,r){var i,o,s,a,h=y(n);if(h)try{i=n(r),s=!0}catch(l){a=!0,o=l}else i=r,s=!0;c(e,i)||(h&&s?u(e,i):a?f(e,o):t===E?u(e,i):t===S&&f(e,i))}function s(t,e,n,r){var i=t._subscribers,o=i.length;i[o]=e,i[o+E]=n,i[o+S]=r}function a(t,e){for(var n,r,i=t._subscribers,s=t._detail,a=0;a<i.length;a+=3)n=i[a],r=i[a+e],o(e,n,r,s);t._subscribers=null}function c(t,e){var n,r=null;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(v(e)&&(r=e.then,y(r)))return r.call(e,function(r){return n?!0:(n=!0,void(e!==r?u(t,r):h(t,r)))},function(e){return n?!0:(n=!0,void f(t,e))}),!0}catch(i){return n?!0:(f(t,i),!0)
}return!1}function u(t,e){t===e?h(t,e):c(t,e)||h(t,e)}function h(t,e){t._state===k&&(t._state=x,t._detail=e,d.async(l,t))}function f(t,e){t._state===k&&(t._state=x,t._detail=e,d.async(p,t))}function l(t){a(t,t._state=E)}function p(t){a(t,t._state=S)}var d=n(150).config,v=(n(150).configure,n(149).objectOrFunction),y=n(149).isFunction,g=(n(149).now,n(151).all),m=n(152).race,_=n(153).resolve,b=n(155).reject,w=n(154).asap;d.async=w;var k=void 0,x=0,E=1,S=2;r.prototype={constructor:r,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(t,e){var n=this,r=new this.constructor(function(){});if(this._state){var i=arguments;d.async(function(){o(n._state,r,i[n._state-1],n._detail)})}else s(this,r,t,e);return r},"catch":function(t){return this.then(null,t)}},r.all=g,r.race=m,r.resolve=_,r.reject=b,e.Promise=r},function(t,e,n){(function(t){"use strict";function r(){var e;e="undefined"!=typeof t?t:"undefined"!=typeof window&&window.document?window:self;var n="Promise"in e&&"resolve"in e.Promise&&"reject"in e.Promise&&"all"in e.Promise&&"race"in e.Promise&&function(){var t;return new e.Promise(function(e){t=e}),o(t)}();n||(e.Promise=i)}var i=n(133).Promise,o=n(149).isFunction;e.polyfill=r}).call(e,function(){return this}())},function(t,e,n){(function(e){function r(t,e){var r=n(137);t=t||{};var i=t.highWaterMark,o=t.objectMode?16:16384;this.highWaterMark=i||0===i?i:o,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!t.objectMode,e instanceof r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.defaultEncoding=t.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(j||(j=n(159).StringDecoder),this.decoder=new j(t.encoding),this.encoding=t.encoding)}function i(t){n(137);return this instanceof i?(this._readableState=new r(t,this),this.readable=!0,void T.call(this)):new i(t)}function o(t,e,n,r,i){var o=u(e,n);if(o)t.emit("error",o);else if(A.isNullOrUndefined(n))e.reading=!1,e.ended||h(t,e);else if(e.objectMode||n&&n.length>0)if(e.ended&&!i){var a=new Error("stream.push() after EOF");t.emit("error",a)}else if(e.endEmitted&&i){var a=new Error("stream.unshift() after end event");t.emit("error",a)}else!e.decoder||i||r||(n=e.decoder.write(n)),i||(e.reading=!1),e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,i?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&f(t)),p(t,e);else i||(e.reading=!1);return s(e)}function s(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}function a(t){if(t>=C)t=C;else{t--;for(var e=1;32>e;e<<=1)t|=t>>e;t++}return t}function c(t,e){return 0===e.length&&e.ended?0:e.objectMode?0===t?0:1:isNaN(t)||A.isNull(t)?e.flowing&&e.buffer.length?e.buffer[0].length:e.length:0>=t?0:(t>e.highWaterMark&&(e.highWaterMark=a(t)),t>e.length?e.ended?e.length:(e.needReadable=!0,0):t)}function u(t,e){var n=null;return A.isBuffer(e)||A.isString(e)||A.isNullOrUndefined(e)||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function h(t,e){if(e.decoder&&!e.ended){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,f(t)}function f(t){var n=t._readableState;n.needReadable=!1,n.emittedReadable||(P("emitReadable",n.flowing),n.emittedReadable=!0,n.sync?e.nextTick(function(){l(t)}):l(t))}function l(t){P("emit readable"),t.emit("readable"),m(t)}function p(t,n){n.readingMore||(n.readingMore=!0,e.nextTick(function(){d(t,n)}))}function d(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(P("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function v(t){return function(){var e=t._readableState;P("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&S.listenerCount(t,"data")&&(e.flowing=!0,m(t))}}function y(t,n){n.resumeScheduled||(n.resumeScheduled=!0,e.nextTick(function(){g(t,n)}))}function g(t,e){e.resumeScheduled=!1,t.emit("resume"),m(t),e.flowing&&!e.reading&&t.read(0)}function m(t){var e=t._readableState;if(P("flow",e.flowing),e.flowing)do var n=t.read();while(null!==n&&e.flowing)}function _(t,e){var n,r=e.buffer,i=e.length,o=!!e.decoder,s=!!e.objectMode;if(0===r.length)return null;if(0===i)n=null;else if(s)n=r.shift();else if(!t||t>=i)n=o?r.join(""):E.concat(r,i),r.length=0;else if(t<r[0].length){var a=r[0];n=a.slice(0,t),r[0]=a.slice(t)}else if(t===r[0].length)n=r.shift();else{n=o?"":new E(t);for(var c=0,u=0,h=r.length;h>u&&t>c;u++){var a=r[0],f=Math.min(t-c,a.length);o?n+=a.slice(0,f):a.copy(n,c,0,f),f<a.length?r[0]=a.slice(f):r.shift(),c+=f}}return n}function b(t){var n=t._readableState;if(n.length>0)throw new Error("endReadable called on non-empty stream");n.endEmitted||(n.ended=!0,e.nextTick(function(){n.endEmitted||0!==n.length||(n.endEmitted=!0,t.readable=!1,t.emit("end"))}))}function w(t,e){for(var n=0,r=t.length;r>n;n++)e(t[n],n)}function k(t,e){for(var n=0,r=t.length;r>n;n++)if(t[n]===e)return n;return-1}t.exports=i;var x=n(158),E=n(50).Buffer;i.ReadableState=r;var S=n(44).EventEmitter;S.listenerCount||(S.listenerCount=function(t,e){return t.listeners(e).length});var T=n(70),A=n(160);A.inherits=n(92);var j,P=n(156);P=P&&P.debuglog?P.debuglog("stream"):function(){},A.inherits(i,T),i.prototype.push=function(t,e){var n=this._readableState;return A.isString(t)&&!n.objectMode&&(e=e||n.defaultEncoding,e!==n.encoding&&(t=new E(t,e),e="")),o(this,n,t,e,!1)},i.prototype.unshift=function(t){var e=this._readableState;return o(this,e,t,"",!0)},i.prototype.setEncoding=function(t){return j||(j=n(159).StringDecoder),this._readableState.decoder=new j(t),this._readableState.encoding=t,this};var C=8388608;i.prototype.read=function(t){P("read",t);var e=this._readableState,n=t;if((!A.isNumber(t)||t>0)&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return P("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?b(this):f(this),null;if(t=c(t,e),0===t&&e.ended)return 0===e.length&&b(this),null;var r=e.needReadable;P("need readable",r),(0===e.length||e.length-t<e.highWaterMark)&&(r=!0,P("length less than watermark",r)),(e.ended||e.reading)&&(r=!1,P("reading or ended",r)),r&&(P("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1),r&&!e.reading&&(t=c(n,e));var i;return i=t>0?_(t,e):null,A.isNull(i)&&(e.needReadable=!0,t=0),e.length-=t,0!==e.length||e.ended||(e.needReadable=!0),n!==t&&e.ended&&0===e.length&&b(this),A.isNull(i)||this.emit("data",i),i},i.prototype._read=function(){this.emit("error",new Error("not implemented"))},i.prototype.pipe=function(t,n){function r(t){P("onunpipe"),t===f&&o()}function i(){P("onend"),t.end()}function o(){P("cleanup"),t.removeListener("close",c),t.removeListener("finish",u),t.removeListener("drain",y),t.removeListener("error",a),t.removeListener("unpipe",r),f.removeListener("end",i),f.removeListener("end",o),f.removeListener("data",s),!l.awaitDrain||t._writableState&&!t._writableState.needDrain||y()}function s(e){P("ondata");var n=t.write(e);!1===n&&(P("false write response, pause",f._readableState.awaitDrain),f._readableState.awaitDrain++,f.pause())}function a(e){P("onerror",e),h(),t.removeListener("error",a),0===S.listenerCount(t,"error")&&t.emit("error",e)}function c(){t.removeListener("finish",u),h()}function u(){P("onfinish"),t.removeListener("close",c),h()}function h(){P("unpipe"),f.unpipe(t)}var f=this,l=this._readableState;switch(l.pipesCount){case 0:l.pipes=t;break;case 1:l.pipes=[l.pipes,t];break;default:l.pipes.push(t)}l.pipesCount+=1,P("pipe count=%d opts=%j",l.pipesCount,n);var p=(!n||n.end!==!1)&&t!==e.stdout&&t!==e.stderr,d=p?i:o;l.endEmitted?e.nextTick(d):f.once("end",d),t.on("unpipe",r);var y=v(f);return t.on("drain",y),f.on("data",s),t._events&&t._events.error?x(t._events.error)?t._events.error.unshift(a):t._events.error=[a,t._events.error]:t.on("error",a),t.once("close",c),t.once("finish",u),t.emit("pipe",f),l.flowing||(P("pipe resume"),f.resume()),t},i.prototype.unpipe=function(t){var e=this._readableState;if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this),this);if(!t){var n=e.pipes,r=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var i=0;r>i;i++)n[i].emit("unpipe",this);return this}var i=k(e.pipes,t);return-1===i?this:(e.pipes.splice(i,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this),this)},i.prototype.on=function(t,n){var r=T.prototype.on.call(this,t,n);if("data"===t&&!1!==this._readableState.flowing&&this.resume(),"readable"===t&&this.readable){var i=this._readableState;if(!i.readableListening)if(i.readableListening=!0,i.emittedReadable=!1,i.needReadable=!0,i.reading)i.length&&f(this,i);else{var o=this;e.nextTick(function(){P("readable nexttick read 0"),o.read(0)})}}return r},i.prototype.addListener=i.prototype.on,i.prototype.resume=function(){var t=this._readableState;return t.flowing||(P("resume"),t.flowing=!0,t.reading||(P("resume read 0"),this.read(0)),y(this,t)),this},i.prototype.pause=function(){return P("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(P("pause"),this._readableState.flowing=!1,this.emit("pause")),this},i.prototype.wrap=function(t){var e=this._readableState,n=!1,r=this;t.on("end",function(){if(P("wrapped end"),e.decoder&&!e.ended){var t=e.decoder.end();t&&t.length&&r.push(t)}r.push(null)}),t.on("data",function(i){if(P("wrapped data"),e.decoder&&(i=e.decoder.write(i)),i&&(e.objectMode||i.length)){var o=r.push(i);o||(n=!0,t.pause())}});for(var i in t)A.isFunction(t[i])&&A.isUndefined(this[i])&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));var o=["error","close","destroy","pause","resume"];return w(o,function(e){t.on(e,r.emit.bind(r,e))}),r._read=function(e){P("wrapped _read",e),n&&(n=!1,t.resume())},r},i._fromList=_}).call(e,n(87))},function(t,e,n){(function(e){function r(t,e,n){this.chunk=t,this.encoding=e,this.callback=n}function i(t,e){var r=n(137);t=t||{};var i=t.highWaterMark,o=t.objectMode?16:16384;this.highWaterMark=i||0===i?i:o,this.objectMode=!!t.objectMode,e instanceof r&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var s=t.decodeStrings===!1;this.decodeStrings=!s,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){p(e,t)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function o(t){var e=n(137);return this instanceof o||this instanceof e?(this._writableState=new i(t,this),this.writable=!0,void x.call(this)):new o(t)}function s(t,n,r){var i=new Error("write after end");t.emit("error",i),e.nextTick(function(){r(i)})}function a(t,n,r,i){var o=!0;if(!(k.isBuffer(r)||k.isString(r)||k.isNullOrUndefined(r)||n.objectMode)){var s=new TypeError("Invalid non-string/buffer chunk");t.emit("error",s),e.nextTick(function(){i(s)}),o=!1}return o}function c(t,e,n){return!t.objectMode&&t.decodeStrings!==!1&&k.isString(e)&&(e=new w(e,n)),e}function u(t,e,n,i,o){n=c(e,n,i),k.isBuffer(n)&&(i="buffer");var s=e.objectMode?1:n.length;e.length+=s;var a=e.length<e.highWaterMark;return a||(e.needDrain=!0),e.writing||e.corked?e.buffer.push(new r(n,i,o)):h(t,e,!1,s,n,i,o),a}function h(t,e,n,r,i,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function f(t,n,r,i,o){r?e.nextTick(function(){n.pendingcb--,o(i)}):(n.pendingcb--,o(i)),t._writableState.errorEmitted=!0,t.emit("error",i)}function l(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function p(t,n){var r=t._writableState,i=r.sync,o=r.writecb;if(l(r),n)f(t,r,i,n,o);else{var s=g(t,r);s||r.corked||r.bufferProcessing||!r.buffer.length||y(t,r),i?e.nextTick(function(){d(t,r,s,o)}):d(t,r,s,o)}}function d(t,e,n,r){n||v(t,e),e.pendingcb--,r(),_(t,e)}function v(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function y(t,e){if(e.bufferProcessing=!0,t._writev&&e.buffer.length>1){for(var n=[],r=0;r<e.buffer.length;r++)n.push(e.buffer[r].callback);e.pendingcb++,h(t,e,!0,e.length,e.buffer,"",function(t){for(var r=0;r<n.length;r++)e.pendingcb--,n[r](t)}),e.buffer=[]}else{for(var r=0;r<e.buffer.length;r++){var i=e.buffer[r],o=i.chunk,s=i.encoding,a=i.callback,c=e.objectMode?1:o.length;if(h(t,e,!1,c,o,s,a),e.writing){r++;break}}r<e.buffer.length?e.buffer=e.buffer.slice(r):e.buffer.length=0}e.bufferProcessing=!1}function g(t,e){return e.ending&&0===e.length&&!e.finished&&!e.writing}function m(t,e){e.prefinished||(e.prefinished=!0,t.emit("prefinish"))}function _(t,e){var n=g(t,e);return n&&(0===e.pendingcb?(m(t,e),e.finished=!0,t.emit("finish")):m(t,e)),n}function b(t,n,r){n.ending=!0,_(t,n),r&&(n.finished?e.nextTick(r):t.once("finish",r)),n.ended=!0}t.exports=o;var w=n(50).Buffer;o.WritableState=i;var k=n(160);k.inherits=n(92);var x=n(70);k.inherits(o,x),o.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},o.prototype.write=function(t,e,n){var r=this._writableState,i=!1;return k.isFunction(e)&&(n=e,e=null),k.isBuffer(t)?e="buffer":e||(e=r.defaultEncoding),k.isFunction(n)||(n=function(){}),r.ended?s(this,r,n):a(this,r,t,n)&&(r.pendingcb++,i=u(this,r,t,e,n)),i},o.prototype.cork=function(){var t=this._writableState;t.corked++},o.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.buffer.length||y(this,t))},o.prototype._write=function(t,e,n){n(new Error("not implemented"))},o.prototype._writev=null,o.prototype.end=function(t,e,n){var r=this._writableState;k.isFunction(t)?(n=t,t=null,e=null):k.isFunction(e)&&(n=e,e=null),k.isNullOrUndefined(t)||this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||b(this,r,n)}}).call(e,n(87))},function(t,e,n){(function(e){function r(t){return this instanceof r?(c.call(this,t),u.call(this,t),t&&t.readable===!1&&(this.readable=!1),t&&t.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,t&&t.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",i)):new r(t)}function i(){this.allowHalfOpen||this._writableState.ended||e.nextTick(this.end.bind(this))}function o(t,e){for(var n=0,r=t.length;r>n;n++)e(t[n],n)}t.exports=r;var s=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e},a=n(160);a.inherits=n(92);var c=n(135),u=n(136);a.inherits(r,c),o(s(u.prototype),function(t){r.prototype[t]||(r.prototype[t]=u.prototype[t])})}).call(e,n(87))},function(t,e,n){function r(t,e){this.afterTransform=function(t,n){return i(e,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function i(t,e,n){var r=t._transformState;r.transforming=!1;var i=r.writecb;if(!i)return t.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,c.isNullOrUndefined(n)||t.push(n),i&&i(e);var o=t._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&t._read(o.highWaterMark)}function o(t){if(!(this instanceof o))return new o(t);a.call(this,t),this._transformState=new r(t,this);var e=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",function(){c.isFunction(this._flush)?this._flush(function(t){s(e,t)}):s(e)})}function s(t,e){if(e)return t.emit("error",e);var n=t._writableState,r=t._transformState;if(n.length)throw new Error("calling transform done when ws.length != 0");if(r.transforming)throw new Error("calling transform done when still transforming");return t.push(null)}t.exports=o;var a=n(137),c=n(160);c.inherits=n(92),c.inherits(o,a),o.prototype.push=function(t,e){return this._transformState.needTransform=!1,a.prototype.push.call(this,t,e)},o.prototype._transform=function(){throw new Error("not implemented")},o.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(){var t=this._transformState;c.isNull(t.writechunk)||!t.writecb||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))}},function(t,e,n){function r(t){return this instanceof r?void i.call(this,t):new r(t)}t.exports=r;var i=n(138),o=n(160);o.inherits=n(92),o.inherits(r,i),r.prototype._transform=function(t,e,n){n(null,t)}},function(t){t.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){t.exports=n(157)},function(t){var e=function(){"use strict";return void 0===this}();if(e)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,keys:Object.keys,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:e};else{var n={}.hasOwnProperty,r={}.toString,i={}.constructor.prototype,o=function(t){var e=[];for(var r in t)n.call(t,r)&&e.push(r);return e},s=function(t,e,n){return t[e]=n.value,t},a=function(t){return t},c=function(t){try{return Object(t).constructor.prototype}catch(e){return i}},u=function(t){try{return"[object Array]"===r.call(t)}catch(e){return!1}};t.exports={isArray:u,keys:o,defineProperty:s,freeze:a,getPrototypeOf:c,isES5:e}}},function(t,e,n){(function(e){"use strict";var r,i=n(105);if("undefined"!=typeof e&&null!==e&&"function"==typeof e.cwd&&"function"==typeof e.nextTick&&"string"==typeof e.version)r=function(t){e.nextTick(t)};else if("function"!=typeof i.MutationObserver&&"function"!=typeof i.WebkitMutationObserver&&"function"!=typeof i.WebKitMutationObserver||"undefined"==typeof document||"function"!=typeof document.createElement)if("function"==typeof i.postMessage&&"function"!=typeof i.importScripts&&"function"==typeof i.addEventListener&&"function"==typeof i.removeEventListener){var o="bluebird_message_key_"+Math.random();r=function(){function t(t){if(t.source===i&&t.data===o){var n=e;e=void 0,n()}}var e=void 0;return i.addEventListener("message",t,!1),function(t){e=t,i.postMessage(o,"*")}}()}else r="function"==typeof i.MessageChannel?function(){var t=void 0,e=new i.MessageChannel;return e.port1.onmessage=function(){var e=t;t=void 0,e()},function(n){t=n,e.port2.postMessage(null)}}():i.setTimeout?function(t){setTimeout(t,4)}:function(t){t()};else r=function(){var t=i.MutationObserver||i.WebkitMutationObserver||i.WebKitMutationObserver,e=document.createElement("div"),n=void 0,r=new t(function(){var t=n;n=void 0,t()});return r.observe(e,{attributes:!0}),function(t){n=t,e.setAttribute("class","foo")}}();t.exports=r}).call(e,n(87))},function(t){"use strict";function e(t,e,n,r,i){for(var o=0;i>o;++o)n[o+r]=t[o+e]}function n(t){return t>>>=0,t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t+1}function r(t){return"number"!=typeof t?16:n(Math.min(Math.max(16,t),1073741824))}function i(t){this._capacity=r(t),this._length=0,this._front=0,this._makeCapacity()}i.prototype._willBeOverCapacity=function(t){return this._capacity<t},i.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1);var n=this._front+e&this._capacity-1;this[n]=t,this._length=e+1},i.prototype.push=function(t,e,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(t),this._pushOne(e),void this._pushOne(n);var i=this._front+r-3;this._checkCapacity(r);var o=this._capacity-1;this[i+0&o]=t,this[i+1&o]=e,this[i+2&o]=n,this._length=r},i.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},i.prototype.length=function(){return this._length},i.prototype._makeCapacity=function(){for(var t=this._capacity,e=0;t>e;++e)this[e]=void 0},i.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<3)},i.prototype._resizeTo=function(t){var n=this._front,r=this._capacity,i=new Array(r),o=this.length();if(e(this,0,i,0,r),this._capacity=t,this._makeCapacity(),this._front=0,r>=n+o)e(i,n,this,0,o);else{var s=o-(n+o&r-1);e(i,n,this,0,s),e(i,0,this,s,o-s)}},t.exports=i},function(t,e,n){"use strict";t.exports=function(t){function e(t,e){this.constructor$(t,e),this._howMany=0,this._unwrap=!1,this._initialized=!1}var r=n(107),i=n(106).RangeError,o=r.inherits,s=r.isArray;return o(e,t),e.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-2);var t=s(this._values);if(this._holes=t?this._values.length-this.length():0,!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()){var e="(Promise.some) input array contains less than "+this._howMany+" promises";this._reject(new i(e))}}},e.prototype.init=function(){this._initialized=!0,this._init()},e.prototype.setUnwrap=function(){this._unwrap=!0},e.prototype.howMany=function(){return this._howMany},e.prototype.setHowMany=function(t){this._isResolved()||(this._howMany=t)},e.prototype._promiseFulfilled=function(t){this._isResolved()||(this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),this._resolve(1===this.howMany()&&this._unwrap?this._values[0]:this._values)))},e.prototype._promiseRejected=function(t){this._isResolved()||(this._addRejected(t),this.howMany()>this._canPossiblyFulfill()&&this._reject(this._values.length===this.length()?[]:this._values.slice(this.length()+this._holes)))},e.prototype._fulfilled=function(){return this._totalResolved},e.prototype._rejected=function(){return this._values.length-this.length()-this._holes},e.prototype._addRejected=function(t){this._values.push(t)},e.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},e.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},e}},function(t,e,n){"use strict";t.exports=function(t,e){function r(e){for(var n=f,i=u,o=t,s=n.length,a=0;s>a;++a){var c=h(n[a],void 0,e);if(c===i)return o.reject(i.e);var l=o._cast(c,r,void 0);if(l instanceof o)return l}return null}function i(n,r){var i=this._promise=new t(e);i._setTrace(void 0),this._generatorFunction=n,this._receiver=r,this._generator=void 0}var o=n(106),s=o.TypeError,a=n(107),c=a.isArray,u=a.errorObj,h=a.tryCatch1,f=[];return i.prototype.promise=function(){return this._promise},i.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._next(void 0)},i.prototype._continue=function l(e){if(e===u){this._generator=void 0;var n=o.canAttach(e.e)?e.e:new Error(e.e+"");return this._promise._attachExtraTrace(n),void this._promise._reject(e.e,n)}var i=e.value;if(e.done===!0)this._generator=void 0,this._promise._tryFollow(i)||this._promise._fulfill(i);else{var a=t._cast(i,l,void 0);if(!(a instanceof t)&&(a=c(a)?t.all(a):r(a),null===a))return void this._throw(new s("A value was yielded that could not be treated as a promise"));a._then(this._next,this._throw,void 0,this,null)}},i.prototype._throw=function(t){o.canAttach(t)&&this._promise._attachExtraTrace(t),this._continue(h(this._generator["throw"],this._generator,t))},i.prototype._next=function(t){this._continue(h(this._generator.next,this._generator,t))},i.addYieldHandler=function(t){if("function"!=typeof t)throw new s("fn must be a function");f.push(t)},i}},function(t,e,n){"use strict";t.exports=function(t,e){function r(t,e){for(var n=s.keys(t),r=new Array(n.length),i=0,o=r.length;o>i;++i)r[i]=t[n[i]];if(this.constructor$(r,e),!this._isResolved())for(var i=0,o=n.length;o>i;++i)r.push(n[i])}var i=n(107),o=i.inherits,s=n(142);return o(r,e),r.prototype._init=function(){this._init$(void 0,-3)},r.prototype._promiseFulfilled=function(t,e){if(!this._isResolved()){this._values[e]=t;var n=++this._totalResolved;if(n>=this._length){for(var r={},i=this.length(),o=0,s=this.length();s>o;++o)r[this._values[o+i]]=this._values[o];this._resolve(r)}}},r.prototype._promiseProgressed=function(t,e){this._isResolved()||this._promise._progress({key:this._values[e+this.length()],value:t})},e.PropertiesPromiseArray=r,r}},function(t,e,n){"use strict";t.exports=function(t,e){function r(t,e){this.constructor$(t,e)}var i=t.PromiseInspection,o=n(107),s=o.inherits;return s(r,e),r.prototype._promiseResolved=function(t,e){this._values[t]=e;var n=++this._totalResolved;n>=this._length&&this._resolve(this._values)},r.prototype._promiseFulfilled=function(t,e){if(!this._isResolved()){var n=new i;n._bitField=268435456,n._settledValue=t,this._promiseResolved(e,n)}},r.prototype._promiseRejected=function(t,e){if(!this._isResolved()){var n=new i;n._bitField=134217728,n._settledValue=t,this._promiseResolved(e,n)}},r}},function(t,e){"use strict";function n(t){return r(t)||"object"==typeof t&&null!==t}function r(t){return"function"==typeof t}function i(t){return"[object Array]"===Object.prototype.toString.call(t)}var o=Date.now||function(){return(new Date).getTime()};e.objectOrFunction=n,e.isFunction=r,e.isArray=i,e.now=o},function(t,e){"use strict";function n(t,e){return 2!==arguments.length?r[t]:void(r[t]=e)}var r={instrument:!1};e.config=r,e.configure=n},function(t,e,n){"use strict";function r(t){var e=this;if(!i(t))throw new TypeError("You must pass an array to all.");return new e(function(e,n){function r(t){return function(e){i(t,e)}}function i(t,n){a[t]=n,0===--c&&e(a)}var s,a=[],c=t.length;0===c&&e([]);for(var u=0;u<t.length;u++)s=t[u],s&&o(s.then)?s.then(r(u),n):i(u,s)})}var i=n(149).isArray,o=n(149).isFunction;e.all=r},function(t,e,n){"use strict";function r(t){var e=this;if(!i(t))throw new TypeError("You must pass an array to race.");return new e(function(e,n){for(var r,i=0;i<t.length;i++)r=t[i],r&&"function"==typeof r.then?r.then(e,n):e(r)})}var i=n(149).isArray;e.race=r},function(t,e){"use strict";function n(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=this;return new e(function(e){e(t)})}e.resolve=n},function(t,e,n){(function(t,n){"use strict";function r(){return function(){n.nextTick(s)}}function i(){var t=0,e=new h(s),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function o(){return function(){f.setTimeout(s,1)}}function s(){for(var t=0;t<l.length;t++){var e=l[t],n=e[0],r=e[1];n(r)}l=[]}function a(t,e){var n=l.push([t,e]);1===n&&c()}var c,u="undefined"!=typeof window?window:{},h=u.MutationObserver||u.WebKitMutationObserver,f="undefined"!=typeof t?t:void 0===this?window:this,l=[];c="undefined"!=typeof n&&"[object process]"==={}.toString.call(n)?r():h?i():o(),e.asap=a}).call(e,function(){return this}(),n(87))},function(t,e){"use strict";function n(t){var e=this;return new e(function(e,n){n(t)})}e.reject=n},function(){},function(t,e,n){(function(e){"use strict";function r(t){t=t||{},t.keepAlive=t.keepAlive!==!1,t.keepAliveMsecs=t.keepAliveMsecs||t.maxKeepAliveTime,u.call(this,t);var e=this;e.maxKeepAliveRequests=parseInt(t.maxKeepAliveRequests,10)||0,e.createSocketCount=0,e.timeoutSocketCount=0,e.requestFinishedCount=0,e.removeAllListeners("free"),e.on("free",function(t,n){e.requestFinishedCount++,t._requestCount++;var r=e.getName(n);if(o("agent.on(free)",r),!e.isDestroyed(t)&&e.requests[r]&&e.requests[r].length)e.requests[r].shift().onSocket(t),0===e.requests[r].length&&delete e.requests[r];else{var i=t._httpMessage;if(i&&i.shouldKeepAlive&&!e.isDestroyed(t)&&e.options.keepAlive){var s=e.freeSockets[r],a=s?s.length:0,c=a;e.sockets[r]&&(c+=e.sockets[r].length),c>=e.maxSockets||a>=e.maxFreeSockets?(e.removeSocket(t,n),t.destroy()):(s=s||[],e.freeSockets[r]=s,t.setKeepAlive(!0,e.keepAliveMsecs),t.unref&&t.unref(),t._httpMessage=null,e.removeSocket(t,n),s.push(t),e.keepAliveMsecs&&t._events&&Array.isArray(t._events.timeout)&&(t.removeAllListeners("timeout"),t.setTimeout(e.keepAliveMsecs,t._maxKeepAliveTimeout)))}else e.removeSocket(t,n),t.destroy()}})}function i(t){r.call(this,t),this.defaultPort=443,this.protocol="https:"}var o,s=n(31),a=n(49),c=n(81);o=e.env.NODE_DEBUG&&/agentkeepalive/.test(e.env.NODE_DEBUG)?function(){console.error.apply(console,arguments)}:function(){};var u=s.Agent;(0===e.version.indexOf("v0.8.")||0===e.version.indexOf("v0.10."))&&(u=n(161).Agent,o("%s use _http_agent",e.version)),c.inherits(r,u),t.exports=r,r.prototype.createSocket=function(t,e){var n=this,r=u.prototype.createSocket.call(this,t,e);return r._requestCount=0,n.keepAliveMsecs&&(r._maxKeepAliveTimeout=function(){o("maxKeepAliveTimeout, socket destroy()"),r.destroy(),n.timeoutSocketCount++},r.setTimeout(n.keepAliveMsecs,r._maxKeepAliveTimeout),r.setNoDelay(!0)),this.createSocketCount++,r},r.prototype.removeSocket=function(t,e){u.prototype.removeSocket.call(this,t,e);var n=this.getName(e);if(o("removeSocket",n,"destroyed:",this.isDestroyed(t)),this.isDestroyed(t)&&this.freeSockets[n]){var r=this.freeSockets[n].indexOf(t);-1!==r&&(this.freeSockets[n].splice(r,1),0===this.freeSockets[n].length&&delete this.freeSockets[n])}},c.inherits(i,r),i.prototype.createConnection=a.globalAgent.createConnection,i.prototype.getName=function(t){var e=r.prototype.getName.call(this,t);return e+=":",t.ca&&(e+=t.ca),e+=":",t.cert&&(e+=t.cert),e+=":",t.ciphers&&(e+=t.ciphers),e+=":",t.key&&(e+=t.key),e+=":",t.pfx&&(e+=t.pfx),e+=":",void 0!==t.rejectUnauthorized&&(e+=t.rejectUnauthorized),e},r.HttpsAgent=i}).call(e,n(87))},function(t){t.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)}},function(t,e,n){function r(t){if(t&&!c(t))throw new Error("Unknown encoding: "+t)}function i(t){return t.toString(this.encoding)}function o(t){this.charReceived=t.length%2,this.charLength=this.charReceived?2:0}function s(t){this.charReceived=t.length%3,this.charLength=this.charReceived?3:0}var a=n(50).Buffer,c=a.isEncoding||function(t){switch(t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},u=e.StringDecoder=function(t){switch(this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,""),r(t),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=o;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=s;break;default:return void(this.write=i)}this.charBuffer=new a(6),this.charReceived=0,this.charLength=0};u.prototype.write=function(t){for(var e="";this.charLength;){var n=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;if(t.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";t=t.slice(n,t.length),e=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var r=e.charCodeAt(e.length-1);if(!(r>=55296&&56319>=r)){if(this.charReceived=this.charLength=0,0===t.length)return e;break}this.charLength+=this.surrogateSize,e=""}this.detectIncompleteChar(t);var i=t.length;this.charLength&&(t.copy(this.charBuffer,0,t.length-this.charReceived,i),i-=this.charReceived),e+=t.toString(this.encoding,0,i);var i=e.length-1,r=e.charCodeAt(i);if(r>=55296&&56319>=r){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),t.copy(this.charBuffer,0,0,o),e.substring(0,i)}return e},u.prototype.detectIncompleteChar=function(t){for(var e=t.length>=3?3:t.length;e>0;e--){var n=t[t.length-e];if(1==e&&n>>5==6){this.charLength=2;break}if(2>=e&&n>>4==14){this.charLength=3;break}if(3>=e&&n>>3==30){this.charLength=4;
break}}this.charReceived=e},u.prototype.end=function(t){var e="";if(t&&t.length&&(e=this.write(t)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;e+=r.slice(0,n).toString(i)}return e}},function(t,e,n){(function(t){function n(t){return Array.isArray(t)}function r(t){return"boolean"==typeof t}function i(t){return null===t}function o(t){return null==t}function s(t){return"number"==typeof t}function a(t){return"string"==typeof t}function c(t){return"symbol"==typeof t}function u(t){return void 0===t}function h(t){return f(t)&&"[object RegExp]"===g(t)}function f(t){return"object"==typeof t&&null!==t}function l(t){return f(t)&&"[object Date]"===g(t)}function p(t){return f(t)&&("[object Error]"===g(t)||t instanceof Error)}function d(t){return"function"==typeof t}function v(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function y(e){return t.isBuffer(e)}function g(t){return Object.prototype.toString.call(t)}e.isArray=n,e.isBoolean=r,e.isNull=i,e.isNullOrUndefined=o,e.isNumber=s,e.isString=a,e.isSymbol=c,e.isUndefined=u,e.isRegExp=h,e.isObject=f,e.isDate=l,e.isError=p,e.isFunction=d,e.isPrimitive=v,e.isBuffer=y}).call(e,n(50).Buffer)},function(t,e,n){(function(t){function r(t){if(!(this instanceof r))return new r(t);c.call(this);var e=this;e.defaultPort=80,e.protocol="http:",e.options=a._extend({},t),e.options.path=null,e.requests={},e.sockets={},e.freeSockets={},e.keepAliveMsecs=e.options.keepAliveMsecs||1e3,e.keepAlive=e.options.keepAlive||!1,e.maxSockets=e.options.maxSockets||r.defaultMaxSockets,e.maxFreeSockets=e.options.maxFreeSockets||256,e.on("free",function(t,n){var r=e.getName(n);if(i("agent.on(free)",r),!e.isDestroyed(t)&&e.requests[r]&&e.requests[r].length)e.requests[r].shift().onSocket(t),0===e.requests[r].length&&delete e.requests[r];else{var o=t._httpMessage;if(o&&o.shouldKeepAlive&&!e.isDestroyed(t)&&e.options.keepAlive){var s=e.freeSockets[r],a=s?s.length:0,c=a;e.sockets[r]&&(c+=e.sockets[r].length),c>=e.maxSockets||a>=e.maxFreeSockets?(e.removeSocket(t,n),t.destroy()):(s=s||[],e.freeSockets[r]=s,t.setKeepAlive(!0,e.keepAliveMsecs),t.unref&&t.unref(),t._httpMessage=null,e.removeSocket(t,n),s.push(t))}else e.removeSocket(t,n),t.destroy()}})}var i,o=n(!function(){var t=new Error('Cannot find module "net"');throw t.code="MODULE_NOT_FOUND",t}()),s=n(28),a=n(81),c=n(44).EventEmitter,u=n(31).ClientRequest;i=t.env.NODE_DEBUG&&/agentkeepalive/.test(t.env.NODE_DEBUG)?function(){console.error.apply(console,arguments)}:function(){},a.inherits(r,c),e.Agent=r,r.defaultMaxSockets=1/0,r.prototype.createConnection=o.createConnection,r.prototype.getName=function(t){var e="";return e+=t.host?t.host:"localhost",e+=":",t.port&&(e+=t.port),e+=":",t.localAddress&&(e+=t.localAddress),e+=":"},r.prototype.addRequest=function(t,e){"string"==typeof e&&(e={host:e,port:arguments[2],path:arguments[3]});var n=this.getName(e);this.sockets[n]||(this.sockets[n]=[]);var r=this.freeSockets[n]?this.freeSockets[n].length:0,o=r+this.sockets[n].length;if(r){var s=this.freeSockets[n].shift();i("have free socket"),this.freeSockets[n].length||delete this.freeSockets[n],s.ref&&s.ref(),t.onSocket(s),this.sockets[n].push(s)}else o<this.maxSockets?(i("call onSocket",o,r),t.onSocket(this.createSocket(t,e))):(i("wait for socket"),this.requests[n]||(this.requests[n]=[]),this.requests[n].push(t))},r.prototype.createSocket=function(t,e){function n(){s.emit("free",h,e)}function r(){i("CLIENT socket onClose"),s.removeSocket(h,e)}function o(){i("CLIENT socket onRemove"),s.removeSocket(h,e,"agentRemove"),h.removeListener("close",r),h.removeListener("free",n),h.removeListener("agentRemove",o)}var s=this;if(e=a._extend({},e),e=a._extend(e,s.options),e.servername=e.host,t){var c=t.getHeader("host");c&&(e.servername=c.replace(/:.*$/,""))}var u=s.getName(e);i("createConnection",u,e);var h=s.createConnection(e);return s.sockets[u]||(s.sockets[u]=[]),this.sockets[u].push(h),i("sockets",u,this.sockets[u].length),h.on("free",n),h.on("close",r),h.on("agentRemove",o),h},r.prototype.removeSocket=function(t,e){var n=this.getName(e);i("removeSocket",n,"destroyed:",this.isDestroyed(t));var r=[this.sockets];if(this.isDestroyed(t)&&r.push(this.freeSockets),r.forEach(function(e){if(e[n]){var r=e[n].indexOf(t);-1!==r&&(e[n].splice(r,1),0===e[n].length&&delete e[n])}}),this.requests[n]&&this.requests[n].length){i("removeSocket, have a request, make a socket");var o=this.requests[n][0];this.createSocket(o,e).emit("free")}},r.prototype.destroy=function(){var t=[this.freeSockets,this.sockets];t.forEach(function(t){Object.keys(t).forEach(function(e){t[e].forEach(function(t){t.destroy()})})})},r.prototype.request=function(t,e){if("string"==typeof t&&(t=s.parse(t)),t.hostname&&(t.host=t.hostname),t&&t.path&&/ /.test(t.path))throw new TypeError("Request path contains unescaped characters.");if(t.protocol&&t.protocol!==this.protocol)throw new Error("Protocol:"+t.protocol+" not supported.");return t=a._extend({agent:this,keepAlive:this.keepAlive},t),t.agent===!1&&(t.agent=new this.constructor),i("agent.request",t),new u(t,e)},r.prototype.get=function(t,e){var n=this.request(t,e);return n.end(),n},r.prototype.isDestroyed=function(t){return t.destroyed||t._destroyed},e.globalAgent=new r}).call(e,n(87))}])});
//# sourceMappingURL=eve.map